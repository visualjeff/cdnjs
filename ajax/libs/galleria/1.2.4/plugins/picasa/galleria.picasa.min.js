!function(t){var i=function(t){var i=t.split("/");return 1==i.length?"":(i.pop(),i.join("/")+"/")}(t("script:last").attr("src"));Galleria.Picasa=function(){this.options={max:30,imageSize:"medium",thumbSize:"thumb",description:!1,complete:function(){}}},Galleria.Picasa.prototype={constructor:Galleria.Picasa,search:function(t,i){return this._call("search","all",{q:t},i)},user:function(t,i){return this._call("user","user/"+t,i)},useralbum:function(t,i,a){return this._call("useralbum","user/"+t+"/album/"+i,a)},setOptions:function(i){return t.extend(this.options,i),this},_call:function(i,a,e,s){a="https://picasaweb.google.com/data/feed/api/"+a+"?","function"==typeof e&&(s=e,e={});var r=this;e=t.extend({kind:"photo",access:"public","max-results":this.options.max,thumbsize:this._getSizes().join(","),alt:"json-in-script",callback:"?"},e),t.each(e,function(t,i){a+="&"+t+"="+i});var n=!1;return Galleria.utils.wait({until:function(){return n},success:function(){r._parse.call(r,n.feed.entry,s)},error:function(){var t="";"user"==i?t="user not found.":"useralbum"==i&&(t="album or user not found."),Galleria.raise("Picasa request failed"+(t?": "+t:"."))},timeout:5e3}),t.getJSON(a,function(t){n=t}),r},_getSizes:function(){var i,a=this,e={small:"72c",thumb:"104u",medium:"640u",big:"1024u",original:"1600u"},s=a.options,r={},n=[32,48,64,72,94,104,110,128,144,150,160,200,220,288,320,400,512,576,640,720,800,912,1024,1152,1280,1440,1600];return t(["thumbSize","imageSize"]).each(function(){s[this]in e?r[this]=e[s[this]]:(i=Galleria.utils.parseValue(s[this]),i>1600?i=1600:t.each(n,function(t){return this>i?(i=n[t-1],!1):void 0}),r[this]=i)}),[r.thumbSize,r.imageSize,"1280u"]},_parse:function(i,a){var e,s=this,r=[];t.each(i,function(){e=this.media$group.media$thumbnail,r.push({thumb:e[0].url,image:e[1].url,big:e[2].url,title:this.title.$t,description:s.options.description?this.summary.$t:""})}),a.call(this,r)}};var a=Galleria.prototype.load;Galleria.prototype.load=function(){if(arguments.length||"string"!=typeof this._options.picasa)return void a.apply(this,Galleria.utils.array(arguments));var e,s=this,r=Galleria.utils.array(arguments),n=this._options.picasa.split(":"),o=t.extend({},s._options.picasaOptions),u="undefined"!=typeof o.loader?o.loader:t("<div>").css({width:48,height:48,opacity:.7,background:"#000 url("+i+"loader.gif) no-repeat 50% 50%"});if(n.length){if("function"!=typeof Galleria.Picasa.prototype[n[0]])return Galleria.raise(n[0]+" method not found in Picasa plugin"),a.apply(this,r);if(!n[1])return Galleria.raise("No picasa argument found"),a.apply(this,r);window.setTimeout(function(){s.$("target").append(u)},100),e=new Galleria.Picasa,"object"==typeof s._options.picasaOptions&&e.setOptions(s._options.picasaOptions);var l=[];if("useralbum"==n[0]){if(l=n[1].split("/"),2!=l.length)return void Galleria.raise("Picasa useralbum not correctly formatted (should be [user]/[album])")}else l.push(n[1]);l.push(function(t){s._data=t,u.remove(),s.trigger(Galleria.DATA),e.options.complete.call(e,t)}),e[n[0]].apply(e,l)}else a.apply(this,r)}}(jQuery);