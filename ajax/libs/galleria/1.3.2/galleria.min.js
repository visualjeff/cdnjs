!function(t,e,i){var n=this,a=n.document,o=t(a),r=t(n),s=Array.prototype,c=1.32,l=!0,h=3e4,u=!1,d=navigator.userAgent.toLowerCase(),p=n.location.hash.replace(/#\//,""),g=n.location.protocol,f=Math,m=function(){},v=function(){return!1},y=function(){var t=3,e=a.createElement("div"),n=e.getElementsByTagName("i");do e.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->";while(n[0]);return t>4?t:i}(),b=function(){return{html:a.documentElement,body:a.body,head:a.getElementsByTagName("head")[0],title:a.title}},_=n.parent!==n.self,w="data ready thumbnail loadstart loadfinish image play pause progress fullscreen_enter fullscreen_exit idle_enter idle_exit rescale lightbox_open lightbox_close lightbox_image",x=function(){var e=[];return t.each(w.split(" "),function(t,i){e.push(i),/_/.test(i)&&e.push(i.replace(/_/g,""))}),e}(),T=function(e){var i;return"object"!=typeof e?e:(t.each(e,function(n,a){/^[a-z]+_/.test(n)&&(i="",t.each(n.split("_"),function(t,e){i+=t>0?e.substr(0,1).toUpperCase()+e.substr(1):e}),e[i]=a,delete e[n])}),e)},k=function(i){return t.inArray(i,x)>-1?e[i.toUpperCase()]:i},C={youtube:{reg:/https?:\/\/(?:[a-zA_Z]{2,3}.)?(?:youtube\.com\/watch\?)((?:[\w\d\-\_\=]+&amp;(?:amp;)?)*v(?:&lt;[A-Z]+&gt;)?=([0-9a-zA-Z\-\_]+))/i,embed:function(){return"http://www.youtube.com/embed/"+this.id},getUrl:function(){return g+"//gdata.youtube.com/feeds/api/videos/"+this.id+"?v=2&alt=json-in-script&callback=?"},get_thumb:function(t){return t.entry.media$group.media$thumbnail[2].url},get_image:function(t){return t.entry.yt$hd?g+"//img.youtube.com/vi/"+this.id+"/maxresdefault.jpg":t.entry.media$group.media$thumbnail[3].url}},vimeo:{reg:/https?:\/\/(?:www\.)?(vimeo\.com)\/(?:hd#)?([0-9]+)/i,embed:function(){return"http://player.vimeo.com/video/"+this.id},getUrl:function(){return g+"//vimeo.com/api/v2/video/"+this.id+".json?callback=?"},get_thumb:function(t){return t[0].thumbnail_medium},get_image:function(t){return t[0].thumbnail_large}},dailymotion:{reg:/https?:\/\/(?:www\.)?(dailymotion\.com)\/video\/([^_]+)/,embed:function(){return g+"//www.dailymotion.com/embed/video/"+this.id},getUrl:function(){return"https://api.dailymotion.com/video/"+this.id+"?fields=thumbnail_240_url,thumbnail_720_url&callback=?"},get_thumb:function(t){return t.thumbnail_240_url},get_image:function(t){return t.thumbnail_720_url}},_inst:[]},S=function(e,i){for(var n=0;n<C._inst.length;n++)if(C._inst[n].id===i&&C._inst[n].type==e)return C._inst[n];this.type=e,this.id=i,this.readys=[],C._inst.push(this);var a=this;t.extend(this,C[e]),t.getJSON(this.getUrl(),function(e){a.data=e,t.each(a.readys,function(t,e){e(a.data)}),a.readys=[]}),this.getMedia=function(t,e,i){i=i||m;var n=this,a=function(i){e(n["get_"+t](i))};try{n.data?a(n.data):n.readys.push(a)}catch(o){i()}}},I=function(t){var e;for(var i in C)if(e=t&&C[i].reg&&t.match(C[i].reg),e&&e.length)return{id:e[2],provider:i};return!1},E={support:function(){var t=b().html;return!_&&(t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen)}(),callback:m,enter:function(t,e,i){this.instance=t,this.callback=e||m,i=i||b().html,i.requestFullscreen?i.requestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullScreen&&i.webkitRequestFullScreen()},exit:function(t){this.callback=t||m,a.exitFullscreen?a.exitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitCancelFullScreen&&a.webkitCancelFullScreen()},instance:null,listen:function(){if(this.support){var t=function(){if(E.instance){var t=E.instance._fullscreen;a.fullscreen||a.mozFullScreen||a.webkitIsFullScreen?t._enter(E.callback):t._exit(E.callback)}};a.addEventListener("fullscreenchange",t,!1),a.addEventListener("mozfullscreenchange",t,!1),a.addEventListener("webkitfullscreenchange",t,!1)}}},A=[],D=[],L=!1,$=!1,P=[],z=function(i){e.theme=i,t.each(P,function(t,e){e._initialized||e._init.call(e)}),P=[]},H=function(){return{clearTimer:function(i){t.each(e.get(),function(){this.clearTimer(i)})},addTimer:function(i){t.each(e.get(),function(){this.addTimer(i)})},array:function(t){return s.slice.call(t,0)},create:function(t,e){e=e||"div";var i=a.createElement(e);return i.className=t,i},removeFromArray:function(e,i){return t.each(e,function(t,n){return n==i?(e.splice(t,1),!1):void 0}),e},getScriptPath:function(e){e=e||t("script:last").attr("src");var i=e.split("/");return 1==i.length?"":(i.pop(),i.join("/")+"/")},animate:function(){var i,o,r,s,c,l,h,u=function(t){var e,i="transition WebkitTransition MozTransition OTransition".split(" ");if(n.opera)return!1;for(e=0;i[e];e++)if("undefined"!=typeof t[i[e]])return i[e];return!1}((a.body||a.documentElement).style),d={MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[u],p={_default:[.25,.1,.25,1],galleria:[.645,.045,.355,1],galleriaIn:[.55,.085,.68,.53],galleriaOut:[.25,.46,.45,.94],ease:[.25,0,.25,1],linear:[.25,.25,.75,.75],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]},g=function(e,i,n){var a={};n=n||"transition",t.each("webkit moz ms o".split(" "),function(){a["-"+this+"-"+n]=i}),e.css(a)},f=function(t){g(t,"none","transition"),e.WEBKIT&&e.TOUCH&&(g(t,"translate3d(0,0,0)","transform"),t.data("revert")&&(t.css(t.data("revert")),t.data("revert",null)))};return function(a,v,y){return y=t.extend({duration:400,complete:m,stop:!1},y),a=t(a),y.duration?u?(y.stop&&(a.unbind(d),f(a)),i=!1,t.each(v,function(t,e){h=a.css(t),H.parseValue(h)!=H.parseValue(e)&&(i=!0),a.css(t,h)}),i?(o=[],r=y.easing in p?p[y.easing]:p._default,s=" "+y.duration+"ms cubic-bezier("+r.join(",")+")",void n.setTimeout(function(i,n,a,r){return function(){i.one(n,function(t){return function(){f(t),y.complete.call(t[0])}}(i)),e.WEBKIT&&e.TOUCH&&(c={},l=[0,0,0],t.each(["left","top"],function(t,e){e in a&&(l[t]=H.parseValue(a[e])-H.parseValue(i.css(e))+"px",c[e]=a[e],delete a[e])}),(l[0]||l[1])&&(i.data("revert",c),o.push("-webkit-transform"+r),g(i,"translate3d("+l.join(",")+")","transform"))),t.each(a,function(t){o.push(t+r)}),g(i,o.join(",")),i.css(a)}}(a,d,v,s),2)):void n.setTimeout(function(){y.complete.call(a[0])},y.duration)):void a.animate(v,y):(a.css(v),void y.complete.call(a[0]))}}(),removeAlpha:function(t){if(t instanceof jQuery&&(t=t[0]),9>y&&t){var e=t.style,i=t.currentStyle,n=i&&i.filter||e.filter||"";/alpha/.test(n)&&(e.filter=n.replace(/alpha\([^)]*\)/i,""))}},forceStyles:function(e,i){e=t(e),e.attr("style")&&e.data("styles",e.attr("style")).removeAttr("style"),e.css(i)},revertStyles:function(){t.each(H.array(arguments),function(e,i){i=t(i),i.removeAttr("style"),i.attr("style",""),i.data("styles")&&i.attr("style",i.data("styles")).data("styles",null)})},moveOut:function(t){H.forceStyles(t,{position:"absolute",left:-1e4})},moveIn:function(){H.revertStyles.apply(H,H.array(arguments))},hide:function(e,i,n){n=n||m;var a=t(e);e=a[0],a.data("opacity")||a.data("opacity",a.css("opacity"));var o={opacity:0};if(i){var r=9>y&&e?function(){H.removeAlpha(e),e.style.visibility="hidden",n.call(e)}:n;H.animate(e,o,{duration:i,complete:r,stop:!0})}else 9>y&&e?(H.removeAlpha(e),e.style.visibility="hidden"):a.css(o)},show:function(e,i,n){n=n||m;var a=t(e);e=a[0];var o=parseFloat(a.data("opacity"))||1,r={opacity:o};if(i){9>y&&(a.css("opacity",0),e.style.visibility="visible");var s=9>y&&e?function(){1==r.opacity&&H.removeAlpha(e),n.call(e)}:n;H.animate(e,r,{duration:i,complete:s,stop:!0})}else 9>y&&1==r.opacity&&e?(H.removeAlpha(e),e.style.visibility="visible"):a.css(r)},wait:function(i){e._waiters=e._waiters||[],i=t.extend({until:v,success:m,error:function(){e.raise("Could not complete wait function.")},timeout:3e3},i);var a,o,r,s=H.timestamp(),c=function(){return o=H.timestamp(),a=o-s,H.removeFromArray(e._waiters,r),i.until(a)?(i.success(),!1):"number"==typeof i.timeout&&o>=s+i.timeout?(i.error(),!1):void e._waiters.push(r=n.setTimeout(c,10))};e._waiters.push(r=n.setTimeout(c,10))},toggleQuality:function(t,e){7!==y&&8!==y||!t||"IMG"!=t.nodeName.toUpperCase()||("undefined"==typeof e&&(e="nearest-neighbor"===t.style.msInterpolationMode),t.style.msInterpolationMode=e?"bicubic":"nearest-neighbor")},insertStyleTag:function(e,i){if(!i||!t("#"+i).length){var n=a.createElement("style");if(i&&(n.id=i),b().head.appendChild(n),n.styleSheet)n.styleSheet.cssText=e;else{var o=a.createTextNode(e);n.appendChild(o)}}},loadScript:function(e,i){var n=!1,a=t("<script>").attr({src:e,async:!0}).get(0);a.onload=a.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,a.onload=a.onreadystatechange=null,"function"==typeof i&&i.call(this,this))},b().head.appendChild(a)},parseValue:function(t){if("number"==typeof t)return t;if("string"==typeof t){var e=t.match(/\-?\d|\./g);return e&&e.constructor===Array?1*e.join(""):0}return 0},timestamp:function(){return(new Date).getTime()},loadCSS:function(n,o,r){var s,c;if(t("link[rel=stylesheet]").each(function(){return new RegExp(n).test(this.href)?(s=this,!1):void 0}),"function"==typeof o&&(r=o,o=i),r=r||m,s)return r.call(s,s),s;if(c=a.styleSheets.length,t("#"+o).length)t("#"+o).attr("href",n),c--;else{s=t("<link>").attr({rel:"stylesheet",href:n,id:o}).get(0);var l=t('link[rel="stylesheet"], style');if(l.length?l.get(0).parentNode.insertBefore(s,l[0]):b().head.appendChild(s),y&&c>=31)return void e.raise("You have reached the browser stylesheet limit (31)",!0)}if("function"==typeof r){var h=t("<s>").attr("id","galleria-loader").hide().appendTo(b().body);H.wait({until:function(){return 1==h.height()},success:function(){h.remove(),r.call(s,s)},error:function(){h.remove(),e.raise("Theme CSS could not load after 20 sec. "+(e.QUIRK?"Your browser is in Quirks Mode, please add a correct doctype.":"Please download the latest theme at http://galleria.io/customer/."),!0)},timeout:5e3})}return s}}}(),O=function(e){var i=".galleria-videoicon{width:60px;height:60px;position:absolute;top:50%;left:50%;z-index:1;margin:-30px 0 0 -30px;cursor:pointer;background:#000;background:rgba(0,0,0,.8);border-radius:3px;-webkit-transition:all 150ms}.galleria-videoicon i{width:0px;height:0px;border-style:solid;border-width:10px 0 10px 16px;display:block;border-color:transparent transparent transparent #ffffff;margin:20px 0 0 22px}.galleria-image:hover .galleria-videoicon{background:#000}";return H.insertStyleTag(i,"galleria-videoicon"),t(H.create("galleria-videoicon")).html("<i></i>").appendTo(e).click(function(){t(this).siblings("img").mouseup()})},F=function(){var e=function(e,i,n,a){var o=this.getOptions("easing"),r=this.getStageWidth(),s={left:r*(e.rewind?-1:1)},c={left:0};n?(s.opacity=0,c.opacity=1):s.opacity=1,t(e.next).css(s),H.animate(e.next,c,{duration:e.speed,complete:function(t){return function(){i(),t.css({left:0})}}(t(e.next).add(e.prev)),queue:!1,easing:o}),a&&(e.rewind=!e.rewind),e.prev&&(s={left:0},c={left:r*(e.rewind?1:-1)},n&&(s.opacity=1,c.opacity=0),t(e.prev).css(s),H.animate(e.prev,c,{duration:e.speed,queue:!1,easing:o,complete:function(){t(this).css("opacity",0)}}))};return{active:!1,init:function(t,e,i){F.effects.hasOwnProperty(t)&&F.effects[t].call(this,e,i)},effects:{fade:function(e,i){t(e.next).css({opacity:0,left:0}),H.animate(e.next,{opacity:1},{duration:e.speed,complete:i}),e.prev&&(t(e.prev).css("opacity",1).show(),H.animate(e.prev,{opacity:0},{duration:e.speed}))},flash:function(e,i){t(e.next).css({opacity:0,left:0}),e.prev?H.animate(e.prev,{opacity:0},{duration:e.speed/2,complete:function(){H.animate(e.next,{opacity:1},{duration:e.speed,complete:i})}}):H.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},pulse:function(e,i){e.prev&&t(e.prev).hide(),t(e.next).css({opacity:0,left:0}).show(),H.animate(e.next,{opacity:1},{duration:e.speed,complete:i})},slide:function(){e.apply(this,H.array(arguments))},fadeslide:function(){e.apply(this,H.array(arguments).concat([!0]))},doorslide:function(){e.apply(this,H.array(arguments).concat([!1,!0]))}}}}();E.listen(),r.bind("orientationchange",function(){t(this).resize()}),e=n.Galleria=function(){var s=this;this._options={},this._playing=!1,this._playtime=5e3,this._active=null,this._queue={length:0},this._data=[],this._dom={},this._thumbnails=[],this._layers=[],this._initialized=!1,this._firstrun=!1,this._stageWidth=0,this._stageHeight=0,this._target=i,this._binds=[],this._id=parseInt(1e4*f.random(),10);var c="container stage images image-nav image-nav-left image-nav-right info info-text info-title info-description thumbnails thumbnails-list thumbnails-container thumb-nav-left thumb-nav-right loader counter tooltip",l="current total";t.each(c.split(" "),function(t,e){s._dom[e]=H.create("galleria-"+e)}),t.each(l.split(" "),function(t,e){s._dom[e]=H.create("galleria-"+e,"span")});var h=this._keyboard={keys:{UP:38,DOWN:40,LEFT:37,RIGHT:39,RETURN:13,ESCAPE:27,BACKSPACE:8,SPACE:32},map:{},bound:!1,press:function(t){var e=t.keyCode||t.which;e in h.map&&"function"==typeof h.map[e]&&h.map[e].call(s,t)},attach:function(t){var e,i;for(e in t)t.hasOwnProperty(e)&&(i=e.toUpperCase(),i in h.keys?h.map[h.keys[i]]=t[e]:h.map[i]=t[e]);h.bound||(h.bound=!0,o.bind("keydown",h.press))},detach:function(){h.bound=!1,h.map={},o.unbind("keydown",h.press)}},u=this._controls={0:i,1:i,active:0,swap:function(){u.active=u.active?0:1},getActive:function(){return s._options.swipe?u.slides[s._active]:u[u.active]},getNext:function(){return s._options.swipe?u.slides[s.getNext(s._active)]:u[1-u.active]},slides:[],frames:[],layers:[]},p=this._carousel={next:s.$("thumb-nav-right"),prev:s.$("thumb-nav-left"),width:0,current:0,max:0,hooks:[],update:function(){var e=0,i=0,n=[0];t.each(s._thumbnails,function(a,o){if(o.ready){e+=o.outerWidth||t(o.container).outerWidth(!0);var r=t(o.container).width();e+=r-f.floor(r),n[a+1]=e,i=f.max(i,o.outerHeight||t(o.container).outerHeight(!0))}}),s.$("thumbnails").css({width:e,height:i}),p.max=e,p.hooks=n,p.width=s.$("thumbnails-list").width(),p.setClasses(),s.$("thumbnails-container").toggleClass("galleria-carousel",e>p.width),p.width=s.$("thumbnails-list").width()},bindControls:function(){var t;p.next.bind("click",function(e){if(e.preventDefault(),"auto"===s._options.carouselSteps){for(t=p.current;t<p.hooks.length;t++)if(p.hooks[t]-p.hooks[p.current]>p.width){p.set(t-2);break}}else p.set(p.current+s._options.carouselSteps)}),p.prev.bind("click",function(e){if(e.preventDefault(),"auto"===s._options.carouselSteps)for(t=p.current;t>=0;t--){if(p.hooks[p.current]-p.hooks[t]>p.width){p.set(t+2);break}if(0===t){p.set(0);break}}else p.set(p.current-s._options.carouselSteps)})},set:function(t){for(t=f.max(t,0);p.hooks[t-1]+p.width>=p.max&&t>=0;)t--;p.current=t,p.animate()},getLast:function(t){return(t||p.current)-1},follow:function(t){if(0===t||t===p.hooks.length-2)return void p.set(t);for(var e=p.current;p.hooks[e]-p.hooks[p.current]<p.width&&e<=p.hooks.length;)e++;t-1<p.current?p.set(t-1):t+2>e&&p.set(t-e+p.current+2)},setClasses:function(){p.prev.toggleClass("disabled",!p.current),p.next.toggleClass("disabled",p.hooks[p.current]+p.width>=p.max)},animate:function(){p.setClasses();var e=-1*p.hooks[p.current];isNaN(e)||(s.$("thumbnails").css("left",function(){return t(this).css("left")}),H.animate(s.get("thumbnails"),{left:e},{duration:s._options.carouselSpeed,easing:s._options.easing,queue:!1}))}},g=this._tooltip={initialized:!1,open:!1,timer:"tooltip"+s._id,swapTimer:"swap"+s._id,init:function(){g.initialized=!0;var t=".galleria-tooltip{padding:3px 8px;max-width:50%;background:#ffe;color:#000;z-index:3;position:absolute;font-size:11px;line-height:1.3;opacity:0;box-shadow:0 0 2px rgba(0,0,0,.4);-moz-box-shadow:0 0 2px rgba(0,0,0,.4);-webkit-box-shadow:0 0 2px rgba(0,0,0,.4);}";H.insertStyleTag(t,"galleria-tooltip"),s.$("tooltip").css({opacity:.8,visibility:"visible",display:"none"})},move:function(t){var e=s.getMousePosition(t).x,i=s.getMousePosition(t).y,n=s.$("tooltip"),a=e,o=i,r=n.outerHeight(!0)+1,c=n.outerWidth(!0),l=r+15,h=s.$("container").width()-c-2,u=s.$("container").height()-r-2;isNaN(a)||isNaN(o)||(a+=10,o-=r+8,a=f.max(0,f.min(h,a)),o=f.max(0,f.min(u,o)),l>i&&(o=l),n.css({left:a,top:o}))},bind:function(i,n){if(!e.TOUCH){g.initialized||g.init();var a=function(){s.$("container").unbind("mousemove",g.move),s.clearTimer(g.timer),s.$("tooltip").stop().animate({opacity:0},200,function(){s.$("tooltip").hide(),s.addTimer(g.swapTimer,function(){g.open=!1},1e3)})},o=function(e,i){g.define(e,i),t(e).hover(function(){s.clearTimer(g.swapTimer),s.$("container").unbind("mousemove",g.move).bind("mousemove",g.move).trigger("mousemove"),g.show(e),s.addTimer(g.timer,function(){s.$("tooltip").stop().show().animate({opacity:1}),g.open=!0},g.open?0:500)},a).click(a)};"string"==typeof n?o(i in s._dom?s.get(i):i,n):t.each(i,function(t,e){o(s.get(t),e)})}},show:function(e){e=t(e in s._dom?s.get(e):e);var i=e.data("tt"),a=function(t){n.setTimeout(function(t){return function(){g.move(t)}}(t),10),e.unbind("mouseup",a)};i="function"==typeof i?i():i,i&&(s.$("tooltip").html(i.replace(/\s/,"&#160;")),e.bind("mouseup",a))},define:function(e,i){if("function"!=typeof i){var n=i;i=function(){return n}}e=t(e in s._dom?s.get(e):e).data("tt",i),g.show(e)}},m=this._fullscreen={scrolled:0,crop:i,active:!1,prev:t(),beforeEnter:function(t){t()},beforeExit:function(t){t()},keymap:s._keyboard.map,parseCallback:function(e,i){return F.active?function(){"function"==typeof e&&e.call(s);var n=s._controls.getActive(),a=s._controls.getNext();s._scaleImage(a),s._scaleImage(n),i&&s._options.trueFullscreen&&t(n.container).add(a.container).trigger("transitionend")}:e},enter:function(t){m.beforeEnter(function(){t=m.parseCallback(t,!0),s._options.trueFullscreen&&E.support?(m.active=!0,H.forceStyles(s.get("container"),{width:"100%",height:"100%"}),s.rescale(),e.MAC?e.SAFARI&&/version\/[1-5]/.test(d)?(s.$("stage").css("opacity",0),n.setTimeout(function(){m.scale(),s.$("stage").css("opacity",1)},4)):(s.$("container").css("opacity",0).addClass("fullscreen"),n.setTimeout(function(){m.scale(),s.$("container").css("opacity",1)},50)):s.$("container").addClass("fullscreen"),r.resize(m.scale),E.enter(s,t,s.get("container"))):(m.scrolled=r.scrollTop(),e.TOUCH||n.scrollTo(0,0),m._enter(t))})},_enter:function(o){m.active=!0,_&&(m.iframe=function(){var i,o=a.referrer,r=a.createElement("a"),s=n.location;return r.href=o,r.protocol!=s.protocol||r.hostname!=s.hostname||r.port!=s.port?(e.raise("Parent fullscreen not available. Iframe protocol, domains and ports must match."),!1):(m.pd=n.parent.document,t(m.pd).find("iframe").each(function(){var t=this.contentDocument||this.contentWindow.document;return t===a?(i=this,!1):void 0}),i)}()),H.hide(s.getActiveImage()),_&&m.iframe&&(m.iframe.scrolled=t(n.parent).scrollTop(),n.parent.scrollTo(0,0));var c=s.getData(),l=s._options,h=!s._options.trueFullscreen||!E.support,u={height:"100%",overflow:"hidden",margin:0,padding:0};if(h&&(s.$("container").addClass("fullscreen"),m.prev=s.$("container").prev(),m.prev.length||(m.parent=s.$("container").parent()),s.$("container").appendTo("body"),H.forceStyles(s.get("container"),{position:e.TOUCH?"absolute":"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e4}),H.forceStyles(b().html,u),H.forceStyles(b().body,u)),_&&m.iframe&&(H.forceStyles(m.pd.documentElement,u),H.forceStyles(m.pd.body,u),H.forceStyles(m.iframe,t.extend(u,{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:1e4,border:"none"}))),m.keymap=t.extend({},s._keyboard.map),s.attachKeyboard({escape:s.exitFullscreen,right:s.next,left:s.prev}),m.crop=l.imageCrop,l.fullscreenCrop!=i&&(l.imageCrop=l.fullscreenCrop),c&&c.big&&c.image!==c.big){var d=new e.Picture,p=d.isCached(c.big),g=s.getIndex(),f=s._thumbnails[g];s.trigger({type:e.LOADSTART,cached:p,rewind:!1,index:g,imageTarget:s.getActiveImage(),thumbTarget:f,galleriaData:c}),d.load(c.big,function(i){s._scaleImage(i,{complete:function(i){s.trigger({type:e.LOADFINISH,cached:p,index:g,rewind:!1,imageTarget:i.image,thumbTarget:f});var n=s._controls.getActive().image;n&&t(n).width(i.image.width).height(i.image.height).attr("style",t(i.image).attr("style")).attr("src",i.image.src)}})})}s.rescale(function(){s.addTimer(!1,function(){h&&H.show(s.getActiveImage()),"function"==typeof o&&o.call(s),s.rescale()},100),s.trigger(e.FULLSCREEN_ENTER)}),h?r.resize(m.scale):H.show(s.getActiveImage())},scale:function(){s.rescale()},exit:function(t){m.beforeExit(function(){t=m.parseCallback(t),s._options.trueFullscreen&&E.support?E.exit(t):m._exit(t)})},_exit:function(t){m.active=!1;var i=!s._options.trueFullscreen||!E.support,a=s.$("container").removeClass("fullscreen");if(m.parent?m.parent.prepend(a):a.insertAfter(m.prev),i){H.hide(s.getActiveImage()),H.revertStyles(s.get("container"),b().html,b().body),e.TOUCH||n.scrollTo(0,m.scrolled);var o=s._controls.frames[s._controls.active];o&&o.image&&(o.image.src=o.image.src)}_&&m.iframe&&(H.revertStyles(m.pd.documentElement,m.pd.body,m.iframe),m.iframe.scrolled&&n.parent.scrollTo(0,m.iframe.scrolled)),s.detachKeyboard(),s.attachKeyboard(m.keymap),s._options.imageCrop=m.crop;var c=s.getData().big,l=s._controls.getActive().image;!s.getData().iframe&&l&&c&&c==l.src&&n.setTimeout(function(t){return function(){l.src=t}}(s.getData().image),1),s.rescale(function(){s.addTimer(!1,function(){i&&H.show(s.getActiveImage()),"function"==typeof t&&t.call(s),r.trigger("resize")},50),s.trigger(e.FULLSCREEN_EXIT)}),r.unbind("resize",m.scale)}},v=this._idle={trunk:[],bound:!1,active:!1,add:function(e,i,n,a){if(e){v.bound||v.addEvent(),e=t(e),"boolean"==typeof n&&(a=n,n={}),n=n||{};var o,r={};for(o in i)i.hasOwnProperty(o)&&(r[o]=e.css(o));e.data("idle",{from:t.extend(r,n),to:i,complete:!0,busy:!1}),a?e.css(i):v.addTimer(),v.trunk.push(e)}},remove:function(e){e=t(e),t.each(v.trunk,function(t,i){i&&i.length&&!i.not(e).length&&(e.css(e.data("idle").from),v.trunk.splice(t,1))}),v.trunk.length||(v.removeEvent(),s.clearTimer(v.timer))},addEvent:function(){v.bound=!0,s.$("container").bind("mousemove click",v.showAll),"hover"==s._options.idleMode&&s.$("container").bind("mouseleave",v.hide)},removeEvent:function(){v.bound=!1,s.$("container").bind("mousemove click",v.showAll),"hover"==s._options.idleMode&&s.$("container").unbind("mouseleave",v.hide)},addTimer:function(){"hover"!=s._options.idleMode&&s.addTimer("idle",function(){v.hide()},s._options.idleTime)},hide:function(){if(s._options.idleMode&&s.getIndex()!==!1){s.trigger(e.IDLE_ENTER);var i=v.trunk.length;t.each(v.trunk,function(t,e){var n=e.data("idle");n&&(e.data("idle").complete=!1,H.animate(e,n.to,{duration:s._options.idleSpeed,complete:function(){t==i-1&&(v.active=!1)}}))})}},showAll:function(){s.clearTimer("idle"),t.each(v.trunk,function(t,e){v.show(e)})},show:function(i){var n=i.data("idle");v.active&&(n.busy||n.complete)||(n.busy=!0,s.trigger(e.IDLE_EXIT),s.clearTimer("idle"),H.animate(i,n.from,{duration:s._options.idleSpeed/2,complete:function(){v.active=!0,t(i).data("idle").busy=!1,t(i).data("idle").complete=!0}})),v.addTimer()}},w=this._lightbox={width:0,height:0,initialized:!1,active:null,image:null,elems:{},keymap:!1,init:function(){if(!w.initialized){w.initialized=!0;var i="overlay box content shadow title info close prevholder prev nextholder next counter image",n={},a=s._options,o="",r="position:absolute;",c="lightbox-",l={overlay:"position:fixed;display:none;opacity:"+a.overlayOpacity+";filter:alpha(opacity="+100*a.overlayOpacity+");top:0;left:0;width:100%;height:100%;background:"+a.overlayBackground+";z-index:99990",box:"position:fixed;display:none;width:400px;height:400px;top:50%;left:50%;margin-top:-200px;margin-left:-200px;z-index:99991",shadow:r+"background:#000;width:100%;height:100%;",content:r+"background-color:#fff;top:10px;left:10px;right:10px;bottom:10px;overflow:hidden",info:r+"bottom:10px;left:10px;right:10px;color:#444;font:11px/13px arial,sans-serif;height:13px",close:r+"top:10px;right:10px;height:20px;width:20px;background:#fff;text-align:center;cursor:pointer;color:#444;font:16px/22px arial,sans-serif;z-index:99999",image:r+"top:10px;left:10px;right:10px;bottom:30px;overflow:hidden;display:block;",prevholder:r+"width:50%;top:0;bottom:40px;cursor:pointer;",nextholder:r+"width:50%;top:0;bottom:40px;right:-1px;cursor:pointer;",prev:r+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;left:20px;display:none;text-align:center;color:#000;font:bold 16px/36px arial,sans-serif",next:r+"top:50%;margin-top:-20px;height:40px;width:30px;background:#fff;right:20px;left:auto;display:none;font:bold 16px/36px arial,sans-serif;text-align:center;color:#000",title:"float:left",counter:"float:right;margin-left:8px;"},h=function(e){return e.hover(function(){t(this).css("color","#bbb")},function(){t(this).css("color","#444")})},u={};y&&y>7&&(l.nextholder+="background:#000;filter:alpha(opacity=0);",l.prevholder+="background:#000;filter:alpha(opacity=0);"),t.each(l,function(t,e){o+=".galleria-"+c+t+"{"+e+"}"}),o+=".galleria-"+c+"box.iframe .galleria-"+c+"prevholder,.galleria-"+c+"box.iframe .galleria-"+c+"nextholder{width:100px;height:100px;top:50%;margin-top:-70px}",H.insertStyleTag(o,"galleria-lightbox"),t.each(i.split(" "),function(t,e){s.addElement("lightbox-"+e),n[e]=w.elems[e]=s.get("lightbox-"+e)}),w.image=new e.Picture,t.each({box:"shadow content close prevholder nextholder",info:"title counter",content:"info image",prevholder:"prev",nextholder:"next"},function(e,i){var n=[];t.each(i.split(" "),function(t,e){n.push(c+e)}),u[c+e]=n}),s.append(u),t(n.image).append(w.image.container),t(b().body).append(n.overlay,n.box),h(t(n.close).bind("click",w.hide).html("&#215;")),t.each(["Prev","Next"],function(i,a){var o=t(n[a.toLowerCase()]).html(/v/.test(a)?"&#8249;&#160;":"&#160;&#8250;"),r=t(n[a.toLowerCase()+"holder"]);return r.bind("click",function(){w["show"+a]()}),8>y||e.TOUCH?void o.show():void r.hover(function(){o.show()},function(){o.stop().fadeOut(200)})}),t(n.overlay).bind("click",w.hide),e.IPAD&&(s._options.lightboxTransitionSpeed=0)}},rescale:function(i){var n=f.min(r.width()-40,w.width),a=f.min(r.height()-60,w.height),o=f.min(n/w.width,a/w.height),c=f.round(w.width*o)+40,l=f.round(w.height*o)+60,h={width:c,height:l,"margin-top":-1*f.ceil(l/2),"margin-left":-1*f.ceil(c/2)};i?t(w.elems.box).css(h):t(w.elems.box).animate(h,{duration:s._options.lightboxTransitionSpeed,easing:s._options.easing,complete:function(){var i=w.image,n=s._options.lightboxFadeSpeed;s.trigger({type:e.LIGHTBOX_IMAGE,imageTarget:i.image}),t(i.container).show(),t(i.image).animate({opacity:1},n),H.show(w.elems.info,n)}})},hide:function(){w.image.image=null,r.unbind("resize",w.rescale),t(w.elems.box).hide().find("iframe").remove(),H.hide(w.elems.info),s.detachKeyboard(),s.attachKeyboard(w.keymap),w.keymap=!1,H.hide(w.elems.overlay,200,function(){t(this).hide().css("opacity",s._options.overlayOpacity),s.trigger(e.LIGHTBOX_CLOSE)})},showNext:function(){w.show(s.getNext(w.active))},showPrev:function(){w.show(s.getPrev(w.active))},show:function(i){w.active=i="number"==typeof i?i:s.getIndex()||0,w.initialized||w.init(),s.trigger(e.LIGHTBOX_OPEN),w.keymap||(w.keymap=t.extend({},s._keyboard.map),s.attachKeyboard({escape:w.hide,right:w.showNext,left:w.showPrev})),r.unbind("resize",w.rescale);var a,o,c,l=s.getData(i),h=s.getDataLength(),u=s.getNext(i);H.hide(w.elems.info);try{for(c=s._options.preload;c>0;c--)o=new e.Picture,a=s.getData(u),o.preload(a.big?a.big:a.image),u=s.getNext(u)}catch(d){}w.image.isIframe=l.iframe&&!l.image,t(w.elems.box).toggleClass("iframe",w.image.isIframe),t(w.image.container).find(".galleria-videoicon").remove(),w.image.load(l.big||l.image||l.iframe,function(e){if(e.isIframe){var a=t(n).width(),o=t(n).height();if(e.video&&s._options.maxVideoSize){var c=f.min(s._options.maxVideoSize/a,s._options.maxVideoSize/o);1>c&&(a*=c,o*=c)}w.width=a,w.height=o}else w.width=e.original.width,w.height=e.original.height;if(t(e.image).css({width:e.isIframe?"100%":"100.1%",height:e.isIframe?"100%":"100.1%",top:0,bottom:0,zIndex:99998,opacity:0,visibility:"visible"}).parent().height("100%"),w.elems.title.innerHTML=l.title||"",w.elems.counter.innerHTML=i+1+" / "+h,r.resize(w.rescale),w.rescale(),l.image&&l.iframe){if(t(w.elems.box).addClass("iframe"),l.video){var u=O(e.container).hide();n.setTimeout(function(){u.fadeIn(200)},200)}t(e.image).css("cursor","pointer").mouseup(function(e,i){return function(n){t(w.image.container).find(".galleria-videoicon").remove(),n.preventDefault(),i.isIframe=!0,i.load(e.iframe+(e.video?"&autoplay=1":""),{width:"100%",height:8>y?t(w.image.container).height():"100%"})}}(l,e))}}),t(w.elems.overlay).show().css("visibility","visible"),t(w.elems.box).show()}},x=this._timer={trunk:{},add:function(t,e,i,a){if(t=t||(new Date).getTime(),a=a||!1,this.clear(t),a){var o=e;e=function(){o(),x.add(t,e,i)}}this.trunk[t]=n.setTimeout(e,i)},clear:function(t){var e,i=function(t){n.clearTimeout(this.trunk[t]),delete this.trunk[t]};if(t&&t in this.trunk)i.call(this,t);else if("undefined"==typeof t)for(e in this.trunk)this.trunk.hasOwnProperty(e)&&i.call(this,e)}};return this},e.prototype={constructor:e,init:function(n,a){return a=T(a),this._original={target:n,options:a,data:null},this._target=this._dom.target=n.nodeName?n:t(n).get(0),this._original.html=this._target.innerHTML,D.push(this),this._target?(this._options={autoplay:!1,carousel:!0,carouselFollow:!0,carouselSpeed:400,carouselSteps:"auto",clicknext:!1,dailymotion:{foreground:"%23EEEEEE",highlight:"%235BCEC5",background:"%23222222",logo:0,hideInfos:1},dataConfig:function(){return{}},dataSelector:"img",dataSort:!1,dataSource:this._target,debug:i,dummy:i,easing:"galleria",extend:function(){},fullscreenCrop:i,fullscreenDoubleTap:!0,fullscreenTransition:i,height:0,idleMode:!0,idleTime:3e3,idleSpeed:200,imageCrop:!1,imageMargin:0,imagePan:!1,imagePanSmoothness:12,imagePosition:"50%",imageTimeout:i,initialTransition:i,keepSource:!1,layerFollow:!0,lightbox:!1,lightboxFadeSpeed:200,lightboxTransitionSpeed:200,linkSourceImages:!0,maxScaleRatio:i,maxVideoSize:i,minScaleRatio:i,overlayOpacity:.85,overlayBackground:"#0b0b0b",pauseOnInteraction:!0,popupLinks:!1,preload:2,queue:!0,responsive:!0,show:0,showInfo:!0,showCounter:!0,showImagenav:!0,swipe:!0,thumbCrop:!0,thumbEventType:"click",thumbMargin:0,thumbQuality:"auto",thumbDisplayOrder:!0,thumbPosition:"50%",thumbnails:!0,touchTransition:i,transition:"fade",transitionInitial:i,transitionSpeed:400,trueFullscreen:!0,useCanvas:!1,variation:"",videoPoster:!0,vimeo:{title:0,byline:0,portrait:0,color:"aaaaaa"},wait:5e3,width:"auto",youtube:{modestbranding:1,autohide:1,color:"white",hd:1,rel:0,showinfo:0}},this._options.initialTransition=this._options.initialTransition||this._options.transitionInitial,a&&a.debug===!1&&(l=!1),a&&"number"==typeof a.imageTimeout&&(h=a.imageTimeout),a&&"string"==typeof a.dummy&&(u=a.dummy),e.TOUCH||(this._options.swipe=!1),t(this._target).children().hide(),e.QUIRK&&e.raise("Your page is in Quirks mode, Galleria may not render correctly. Please validate your HTML and add a correct doctype."),"object"==typeof e.theme?this._init():P.push(this),this):void e.raise("Target not found",!0)},_init:function(){var o=this,s=this._options;if(this._initialized)return e.raise("Init failed: Gallery instance already initialized."),this;if(this._initialized=!0,!e.theme)return e.raise("Init failed: No theme found.",!0),this;if(t.extend(!0,s,e.theme.defaults,this._original.options,e.configure.options),s.swipe&&(s.clicknext=!1,s.imagePan=!1),function(t){return"getContext"in t?void($=$||{elem:t,context:t.getContext("2d"),cache:{},length:0}):void(t=null)}(a.createElement("canvas")),e.Fastclick.init(this.get("target")),this.bind(e.DATA,function(){n.screen&&n.screen.width&&Array.prototype.forEach&&this._data.forEach(function(t){var e="devicePixelRatio"in n?n.devicePixelRatio:1,i=f.max(n.screen.width,n.screen.height);1024>i*e&&(t.big=t.image)}),this._original.data=this._data,this.get("total").innerHTML=this.getDataLength();var t=this.$("container");o._options.height<2&&(o._userRatio=o._ratio=o._options.height);
var i={width:0,height:0},a=function(){return o.$("stage").height()};H.wait({until:function(){return i=o._getWH(),t.width(i.width).height(i.height),a()&&i.width&&i.height>50},success:function(){o._width=i.width,o._height=i.height,o._ratio=o._ratio||i.height/i.width,e.WEBKIT?n.setTimeout(function(){o._run()},1):o._run()},error:function(){a()?e.raise("Could not extract sufficient width/height of the gallery container. Traced measures: width:"+i.width+"px, height: "+i.height+"px.",!0):e.raise("Could not extract a stage height from the CSS. Traced height: "+a()+"px.",!0)},timeout:"number"==typeof this._options.wait?this._options.wait:!1})}),this.append({"info-text":["info-title","info-description"],info:["info-text"],"image-nav":["image-nav-right","image-nav-left"],stage:["images","loader","counter","image-nav"],"thumbnails-list":["thumbnails"],"thumbnails-container":["thumb-nav-left","thumbnails-list","thumb-nav-right"],container:["stage","thumbnails-container","info","tooltip"]}),H.hide(this.$("counter").append(this.get("current"),a.createTextNode(" / "),this.get("total"))),this.setCounter("&#8211;"),H.hide(o.get("tooltip")),this.$("container").addClass((e.TOUCH?"touch":"notouch")+" "+this._options.variation),this._options.swipe||t.each(new Array(2),function(i){var n=new e.Picture;t(n.container).css({position:"absolute",top:0,left:0}).prepend(o._layers[i]=t(H.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]),o.$("images").append(n.container),o._controls[i]=n;var a=new e.Picture;a.isIframe=!0,t(a.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(n.container),o._controls.frames[i]=a}),this.$("images").css({position:"relative",top:0,left:0,width:"100%",height:"100%"}),s.swipe&&(this.$("images").css({position:"absolute",top:0,left:0,width:0,height:"100%"}),this.finger=new e.Finger(this.get("stage"),{onchange:function(t){o.setCounter(t),o.pause(),o.show(t)},oncomplete:function(t){var i=f.max(0,f.min(parseInt(t,10),o.getDataLength()-1)),n=o.getData(i);if(n){o.$("images").find("iframe").remove(),o.$("images").find(".galleria-frame").css("opacity",0).hide();var a=o.isFullscreen()&&n.big?n.big:n.image||n.iframe,r=o._controls.slides[i],s=r.isCached(a),c=o._thumbnails[i];o.trigger({type:e.IMAGE,cached:s,index:i,imageTarget:r.image,thumbTarget:c.image,galleriaData:n}),o._options.carousel&&o._options.carouselFollow&&o._carousel.follow(i)}}}),this.bind(e.RESCALE,function(){this.finger.setup()}),this.$("stage").bind("click",function(){var e=o.getData();if(e){if(e.iframe){o.isPlaying()&&o.pause();var a=o._controls.frames[o._active],r=o._stageWidth,s=o._stageHeight;if(t(a.container).find("iframe").length)return;return t(a.container).css({width:r,height:s,opacity:0}).show().animate({opacity:1},200),void n.setTimeout(function(){a.load(e.iframe+(e.video?"&autoplay=1":""),{width:r,height:s},function(t){o.$("container").addClass("videoplay"),t.scale({width:o._stageWidth,height:o._stageHeight,iframelimit:e.video?o._options.maxVideoSize:i})})},100)}if(e.link)if(o._options.popupLinks){n.open(e.link,"_blank")}else n.location.href=e.link;else;}}),this.bind(e.IMAGE,function(e){o.setCounter(e.index),o.setInfo(e.index);var i=this.getNext(),n=this.getPrev(),a=[n,i];a.push(this.getNext(i),this.getPrev(n),o._controls.slides.length-1);var r=[];t.each(a,function(e,i){-1==t.inArray(i,r)&&r.push(i)}),t.each(r,function(e,i){var n=o.getData(i),a=o._controls.slides[i],r=o.isFullscreen()&&n.big?n.big:n.image||n.iframe;n.iframe&&!n.image&&(a.isIframe=!0),a.ready||o._controls.slides[i].load(r,function(e){e.isIframe||t(e.image).css("visibility","hidden"),o._scaleImage(e,{complete:function(e){e.isIframe||t(e.image).css({opacity:0,visibility:"visible"}).animate({opacity:1},200)}})})})})),this.$("thumbnails, thumbnails-list").css({overflow:"hidden",position:"relative"}),this.$("image-nav-right, image-nav-left").bind("click",function(t){s.clicknext&&t.stopPropagation(),s.pauseOnInteraction&&o.pause();var e=/right/.test(this.className)?"next":"prev";o[e]()}),t.each(["info","counter","image-nav"],function(t,e){s["show"+e.substr(0,1).toUpperCase()+e.substr(1).replace(/-/,"")]===!1&&H.moveOut(o.get(e.toLowerCase()))}),this.load(),s.keepSource||y||(this._target.innerHTML=""),this.get("errors")&&this.appendChild("target","errors"),this.appendChild("target","container"),s.carousel){var c=0,l=s.show;this.bind(e.THUMBNAIL,function(){this.updateCarousel(),++c==this.getDataLength()&&"number"==typeof l&&l>0&&this._carousel.follow(l)})}return s.responsive&&r.bind("resize",function(){o.isFullscreen()||o.resize()}),s.fullscreenDoubleTap&&this.$("stage").bind("touchstart",function(){var t,e,i,n,a,r,s=function(t){return t.originalEvent.touches?t.originalEvent.touches[0]:t};return o.$("stage").bind("touchmove",function(){t=0}),function(c){if(!/(-left|-right)/.test(c.target.className)){if(r=H.timestamp(),e=s(c).pageX,i=s(c).pageY,c.originalEvent.touches.length<2&&300>r-t&&20>e-n&&20>i-a)return o.toggleFullscreen(),void c.preventDefault();t=r,n=e,a=i}}}()),t.each(e.on.binds,function(e,i){-1==t.inArray(i.hash,o._binds)&&o.bind(i.type,i.callback)}),this},addTimer:function(){return this._timer.add.apply(this._timer,H.array(arguments)),this},clearTimer:function(){return this._timer.clear.apply(this._timer,H.array(arguments)),this},_getWH:function(){var e,i=this.$("container"),n=this.$("target"),a=this,o={};return t.each(["width","height"],function(t,r){a._options[r]&&"number"==typeof a._options[r]?o[r]=a._options[r]:(e=[H.parseValue(i.css(r)),H.parseValue(n.css(r)),i[r](),n[r]()],a["_"+r]||e.splice(e.length,H.parseValue(i.css("min-"+r)),H.parseValue(n.css("min-"+r))),o[r]=f.max.apply(f,e))}),a._userRatio&&(o.height=o.width*a._userRatio),o},_createThumbnails:function(i){this.get("total").innerHTML=this.getDataLength();var o,r,s,c,l=this,h=this._options,u=i?this._data.length-i.length:0,d=u,p=[],g=0,f=8>y?"http://upload.wikimedia.org/wikipedia/commons/c/c0/Blank.gif":"data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw%3D%3D",m=function(){var t=l.$("thumbnails").find(".active");return t.length?t.find("img").attr("src"):!1}(),v="string"==typeof h.thumbnails?h.thumbnails.toLowerCase():null,b=function(t){return a.defaultView&&a.defaultView.getComputedStyle?a.defaultView.getComputedStyle(r.container,null)[t]:c.css(t)},_=function(i,n,a){return function(){t(a).append(i),l.trigger({type:e.THUMBNAIL,thumbTarget:i,index:n,galleriaData:l.getData(n)})}},w=function(e){h.pauseOnInteraction&&l.pause();var i=t(e.currentTarget).data("index");l.getIndex()!==i&&l.show(i),e.preventDefault()},x=function(i,n){t(i.container).css("visibility","visible"),l.trigger({type:e.THUMBNAIL,thumbTarget:i.image,index:i.data.order,galleriaData:l.getData(i.data.order)}),"function"==typeof n&&n.call(l,i)},T=function(e,i){e.scale({width:e.data.width,height:e.data.height,crop:h.thumbCrop,margin:h.thumbMargin,canvas:h.useCanvas,position:h.thumbPosition,complete:function(e){{var n,a,o=["left","top"],r=["Width","Height"];l.getData(e.index)}t.each(r,function(i,r){n=r.toLowerCase(),(h.thumbCrop!==!0||h.thumbCrop===n)&&(a={},a[n]=e[n],t(e.container).css(a),a={},a[o[i]]=0,t(e.image).css(a)),e["outer"+r]=t(e.container)["outer"+r](!0)}),H.toggleQuality(e.image,h.thumbQuality===!0||"auto"===h.thumbQuality&&e.original.width<3*e.width),h.thumbDisplayOrder&&!e.lazy?t.each(p,function(t,e){return t===g&&e.ready&&!e.displayed?(g++,e.displayed=!0,void x(e,i)):void 0}):x(e,i)}})};for(i||(this._thumbnails=[],this.$("thumbnails").empty());this._data[u];u++)s=this._data[u],o=s.thumb||s.image,h.thumbnails!==!0&&"lazy"!=v||!s.thumb&&!s.image?s.iframe||"empty"===v||"numbers"===v?(r={container:H.create("galleria-image"),image:H.create("img","span"),ready:!0,data:{order:u}},"numbers"===v&&t(r.image).text(u+1),s.iframe&&t(r.image).addClass("iframe"),this.$("thumbnails").append(r.container),n.setTimeout(_(r.image,u,r.container),50+20*u)):r={container:null,image:null}:(r=new e.Picture(u),r.index=u,r.displayed=!1,r.lazy=!1,r.video=!1,this.$("thumbnails").append(r.container),c=t(r.container),c.css("visibility","hidden"),r.data={width:H.parseValue(b("width")),height:H.parseValue(b("height")),order:u,src:o},c.css(h.thumbCrop!==!0?{width:"auto",height:"auto"}:{width:r.data.width,height:r.data.height}),"lazy"==v?(c.addClass("lazy"),r.lazy=!0,r.load(f,{height:r.data.height,width:r.data.width})):r.load(o,T),"all"===h.preload&&r.preload(s.image)),t(r.container).add(h.keepSource&&h.linkSourceImages?s.original:null).data("index",u).bind(h.thumbEventType,w).data("thumbload",T),m===o&&t(r.container).addClass("active"),this._thumbnails.push(r);return p=this._thumbnails.slice(d),this},lazyLoad:function(e,i){var n=e.constructor==Array?e:[e],a=this,o=0;return t.each(n,function(e,r){if(!(r>a._thumbnails.length-1)){var s=a._thumbnails[r],c=s.data,l=function(){++o==n.length&&"function"==typeof i&&i.call(a)},h=t(s.container).data("thumbload");s.video?h.call(a,s,l):s.load(c.src,function(t){h.call(a,t,l)})}}),this},lazyLoadChunks:function(t,e){var i=this.getDataLength(),a=0,o=0,r=[],s=[],c=this;for(e=e||0;i>a;a++)s.push(a),(++o==t||a==i-1)&&(r.push(s),o=0,s=[]);var l=function(t){var i=r.shift();i&&n.setTimeout(function(){c.lazyLoad(i,function(){l(!0)})},e&&t?e:0)};return l(!1),this},_run:function(){var a=this;a._createThumbnails(),H.wait({timeout:1e4,until:function(){return e.OPERA&&a.$("stage").css("display","inline-block"),a._stageWidth=a.$("stage").width(),a._stageHeight=a.$("stage").height(),a._stageWidth&&a._stageHeight>50},success:function(){if(A.push(a),a._options.swipe){var o=a.$("images").width(a.getDataLength()*a._stageWidth);t.each(new Array(a.getDataLength()),function(i){var n=new e.Picture,r=a.getData(i);t(n.container).css({position:"absolute",top:0,left:a._stageWidth*i}).prepend(a._layers[i]=t(H.create("galleria-layer")).css({position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2})[0]).appendTo(o),r.video&&O(n.container),a._controls.slides.push(n);var s=new e.Picture;s.isIframe=!0,t(s.container).attr("class","galleria-frame").css({position:"absolute",top:0,left:0,zIndex:4,background:"#000",display:"none"}).appendTo(n.container),a._controls.frames.push(s)}),a.finger.setup()}return H.show(a.get("counter")),a._options.carousel&&a._carousel.bindControls(),a._options.autoplay&&(a.pause(),"number"==typeof a._options.autoplay&&(a._playtime=a._options.autoplay),a._playing=!0),a._firstrun?(a._options.autoplay&&a.trigger(e.PLAY),void("number"==typeof a._options.show&&a.show(a._options.show))):(a._firstrun=!0,e.History&&e.History.change(function(t){isNaN(t)?n.history.go(-1):a.show(t,i,!0)}),a.trigger(e.READY),e.theme.init.call(a,a._options),t.each(e.ready.callbacks,function(t,e){"function"==typeof e&&e.call(a,a._options)}),e.ready.callbacks=[],a._options.extend.call(a,a._options),/^[0-9]{1,4}$/.test(p)&&e.History?a.show(p,i,!0):a._data[a._options.show]&&a.show(a._options.show),void(a._options.autoplay&&a.trigger(e.PLAY)))},error:function(){e.raise("Stage width or height is too small to show the gallery. Traced measures: width:"+a._stageWidth+"px, height: "+a._stageHeight+"px.",!0)}})},load:function(i,n,a){var o=this,r=this._options;return this._data=[],this._thumbnails=[],this.$("thumbnails").empty(),"function"==typeof n&&(a=n,n=null),i=i||r.dataSource,n=n||r.dataSelector,a=a||r.dataConfig,t.isPlainObject(i)&&(i=[i]),t.isArray(i)?this.validate(i)?this._data=i:e.raise("Load failed: JSON Array not valid."):(n+=",.video,.iframe",t(i).find(n).each(function(e,i){i=t(i);var n={},r=i.parent(),s=r.attr("href"),c=r.attr("rel");s&&("IMG"==i[0].nodeName||i.hasClass("video"))&&I(s)?n.video=s:s&&i.hasClass("iframe")?n.iframe=s:n.image=n.big=s,c&&(n.big=c),t.each("big title description link layer image".split(" "),function(t,e){i.data(e)&&(n[e]=i.data(e).toString())}),n.big||(n.big=n.image),o._data.push(t.extend({title:i.attr("title")||"",thumb:i.attr("src"),image:i.attr("src"),big:i.attr("src"),description:i.attr("alt")||"",link:i.attr("longdesc"),original:i.get(0)},n,a(i)))})),"function"==typeof r.dataSort?s.sort.call(this._data,r.dataSort):"random"==r.dataSort&&this._data.sort(function(){return f.round(f.random())-.5}),this.getDataLength()&&this._parseData(function(){this.trigger(e.DATA)}),this},_parseData:function(e){var n,a=this,o=!1,r=function(){var i=!0;t.each(a._data,function(t,e){return e.loading?(i=!1,!1):void 0}),i&&!o&&(o=!0,e.call(a))};return t.each(this._data,function(e,o){if(n=a._data[e],"thumb"in o==!1&&(n.thumb=o.image),o.big||(n.big=o.image),"video"in o){var s=I(o.video);s&&(n.iframe=new S(s.provider,s.id).embed()+function(){if("object"==typeof a._options[s.provider]){var e="?",i=[];return t.each(a._options[s.provider],function(t,e){i.push(t+"="+e)}),"youtube"==s.provider&&(i=["wmode=opaque"].concat(i)),e+i.join("&")}return""}(),n.thumb&&n.image||t.each(["thumb","image"],function(t,e){if("image"==e&&!a._options.videoPoster)return void(n.image=i);var o=new S(s.provider,s.id);n[e]||(n.loading=!0,o.getMedia(e,function(t,e){return function(i){t[e]=i,"image"!=e||t.big||(t.big=t.image),delete t.loading,r()}}(n,e)))}))}}),r(),this},destroy:function(){return this.$("target").data("galleria",null),this.$("container").unbind("galleria"),this.get("target").innerHTML=this._original.html,this.clearTimer(),H.removeFromArray(D,this),H.removeFromArray(A,this),e._waiters.length&&t.each(e._waiters,function(t,e){e&&n.clearTimeout(e)}),this},splice:function(){var t=this,e=H.array(arguments);return n.setTimeout(function(){s.splice.apply(t._data,e),t._parseData(function(){t._createThumbnails()})},2),t},push:function(){var t=this,e=H.array(arguments);return 1==e.length&&e[0].constructor==Array&&(e=e[0]),n.setTimeout(function(){s.push.apply(t._data,e),t._parseData(function(){t._createThumbnails(e)})},2),t},_getActive:function(){return this._controls.getActive()},validate:function(){return!0},bind:function(t,e){return t=k(t),this.$("container").bind(t,this.proxy(e)),this},unbind:function(t){return t=k(t),this.$("container").unbind(t),this},trigger:function(e){return e="object"==typeof e?t.extend(e,{scope:this}):{type:k(e),scope:this},this.$("container").trigger(e),this},addIdleState:function(){return this._idle.add.apply(this._idle,H.array(arguments)),this},removeIdleState:function(){return this._idle.remove.apply(this._idle,H.array(arguments)),this},enterIdleMode:function(){return this._idle.hide(),this},exitIdleMode:function(){return this._idle.showAll(),this},enterFullscreen:function(){return this._fullscreen.enter.apply(this,H.array(arguments)),this},exitFullscreen:function(){return this._fullscreen.exit.apply(this,H.array(arguments)),this},toggleFullscreen:function(){return this._fullscreen[this.isFullscreen()?"exit":"enter"].apply(this,H.array(arguments)),this},bindTooltip:function(){return this._tooltip.bind.apply(this._tooltip,H.array(arguments)),this},defineTooltip:function(){return this._tooltip.define.apply(this._tooltip,H.array(arguments)),this},refreshTooltip:function(){return this._tooltip.show.apply(this._tooltip,H.array(arguments)),this},openLightbox:function(){return this._lightbox.show.apply(this._lightbox,H.array(arguments)),this},closeLightbox:function(){return this._lightbox.hide.apply(this._lightbox,H.array(arguments)),this},hasVariation:function(e){return t.inArray(e,this._options.variation.split(/\s+/))>-1},getActiveImage:function(){var t=this._getActive();return t?t.image:i},getActiveThumb:function(){return this._thumbnails[this._active].image||i},getMousePosition:function(t){return{x:t.pageX-this.$("container").offset().left,y:t.pageY-this.$("container").offset().top}},addPan:function(e){if(this._options.imageCrop!==!1){e=t(e||this.getActiveImage());var i=this,n=e.width()/2,a=e.height()/2,o=parseInt(e.css("left"),10),r=parseInt(e.css("top"),10),s=o||0,c=r||0,l=0,h=0,u=!1,d=H.timestamp(),p=0,g=0,m=function(t,i,n){if(t>0&&(g=f.round(f.max(-1*t,f.min(0,i))),p!==g))if(p=g,8===y)e.parent()["scroll"+n](-1*g);else{var a={};a[n.toLowerCase()]=g,e.css(a)}},v=function(t){H.timestamp()-d<50||(u=!0,n=i.getMousePosition(t).x,a=i.getMousePosition(t).y)},b=function(){u&&(l=e.width()-i._stageWidth,h=e.height()-i._stageHeight,o=n/i._stageWidth*l*-1,r=a/i._stageHeight*h*-1,s+=(o-s)/i._options.imagePanSmoothness,c+=(r-c)/i._options.imagePanSmoothness,m(h,c,"Top"),m(l,s,"Left"))};return 8===y&&(e.parent().scrollTop(-1*c).scrollLeft(-1*s),e.css({top:0,left:0})),this.$("stage").unbind("mousemove",v).bind("mousemove",v),this.addTimer("pan"+i._id,b,50,!0),this}},proxy:function(t,e){return"function"!=typeof t?m:(e=e||this,function(){return t.apply(e,H.array(arguments))})},removePan:function(){return this.$("stage").unbind("mousemove"),this.clearTimer("pan"+this._id),this},addElement:function(){var e=this._dom;return t.each(H.array(arguments),function(t,i){e[i]=H.create("galleria-"+i)}),this},attachKeyboard:function(){return this._keyboard.attach.apply(this._keyboard,H.array(arguments)),this},detachKeyboard:function(){return this._keyboard.detach.apply(this._keyboard,H.array(arguments)),this},appendChild:function(t,e){return this.$(t).append(this.get(e)||e),this},prependChild:function(t,e){return this.$(t).prepend(this.get(e)||e),this},remove:function(){return this.$(H.array(arguments).join(",")).remove(),this},append:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e))if(t[e].constructor===Array)for(i=0;t[e][i];i++)this.appendChild(e,t[e][i]);else this.appendChild(e,t[e]);return this},_scaleImage:function(e,i){if(e=e||this._controls.getActive()){var n,a=function(e){t(e.container).children(":first").css({top:f.max(0,H.parseValue(e.image.style.top)),left:f.max(0,H.parseValue(e.image.style.left)),width:H.parseValue(e.image.width),height:H.parseValue(e.image.height)})};return i=t.extend({width:this._stageWidth,height:this._stageHeight,crop:this._options.imageCrop,max:this._options.maxScaleRatio,min:this._options.minScaleRatio,margin:this._options.imageMargin,position:this._options.imagePosition,iframelimit:this._options.maxVideoSize},i),this._options.layerFollow&&this._options.imageCrop!==!0?"function"==typeof i.complete?(n=i.complete,i.complete=function(){n.call(e,e),a(e)}):i.complete=a:t(e.container).children(":first").css({top:0,left:0}),e.scale(i),this}},updateCarousel:function(){return this._carousel.update(),this},resize:function(e,n){"function"==typeof e&&(n=e,e=i),e=t.extend({width:0,height:0},e);var a=this,o=this.$("container");return t.each(e,function(t,i){i||(o[t]("auto"),e[t]=a._getWH()[t])}),t.each(e,function(t,e){o[t](e)}),this.rescale(n)},rescale:function(n,a,o){var r=this;"function"==typeof n&&(o=n,n=i);var s=function(){r._stageWidth=n||r.$("stage").width(),r._stageHeight=a||r.$("stage").height(),r._options.swipe?(t.each(r._controls.slides,function(e,i){r._scaleImage(i),t(i.container).css("left",r._stageWidth*e)}),r.$("images").css("width",r._stageWidth*r.getDataLength())):r._scaleImage(),r._options.carousel&&r.updateCarousel(),r._controls.frames[r._controls.active].scale({width:r._stageWidth,height:r._stageHeight,iframelimit:r._options.maxVideoSize}),r.trigger(e.RESCALE),"function"==typeof o&&o.call(r)};return s.call(r),this},refreshImage:function(){return this._scaleImage(),this._options.imagePan&&this.addPan(),this},show:function(i,a,o){var r=this._options.swipe;if(r||!(this._queue.length>3||i===!1||!this._options.queue&&this._queue.stalled)){if(i=f.max(0,f.min(parseInt(i,10),this.getDataLength()-1)),a="undefined"!=typeof a?!!a:i<this.getIndex(),o=o||!1,!o&&e.History)return void e.History.set(i.toString());if(this.finger&&i!==this._active&&(this.finger.to=-(i*this.finger.width),this.finger.index=i),this._active=i,r){var c=this.getData(i),l=this;if(!c)return;var h=this.isFullscreen()&&c.big?c.big:c.image||c.iframe,u=this._controls.slides[i],d=u.isCached(h),p=this._thumbnails[i],g={cached:d,index:i,rewind:a,imageTarget:u.image,thumbTarget:p.image,galleriaData:c};this.trigger(t.extend(g,{type:e.LOADSTART})),t(l._thumbnails[i].container).addClass("active").siblings(".active").removeClass("active"),l.$("container").removeClass("videoplay");var m=function(){l._layers[i].innerHTML=l.getData().layer||"",l.trigger(t.extend(g,{type:e.LOADFINISH})),l._playCheck()};n.setTimeout(function(){u.ready?(l.trigger(t.extend(g,{type:e.IMAGE})),m()):(c.iframe&&!c.image&&(u.isIframe=!0),u.load(h,function(i){l._scaleImage(i,m).trigger(t.extend(g,{type:e.IMAGE})),m()}))},800)}else s.push.call(this._queue,{index:i,rewind:a}),this._queue.stalled||this._show();return this}},_show:function(){var a=this,o=this._queue[0],r=this.getData(o.index);if(r){var c=this.isFullscreen()&&r.big?r.big:r.image||r.iframe,l=this._controls.getActive(),h=this._controls.getNext(),u=h.isCached(c),d=this._thumbnails[o.index],p=function(){t(h.image).trigger("mouseup")};a.$("container").toggleClass("iframe",!!r.isIframe).removeClass("videoplay");var g=function(o,r,c,l,h){return function(){var u;F.active=!1,H.toggleQuality(r.image,a._options.imageQuality),a._layers[a._controls.active].innerHTML="",t(c.container).css({zIndex:0,opacity:0}).show(),t(c.container).find("iframe, .galleria-videoicon").remove(),t(a._controls.frames[a._controls.active].container).hide(),t(r.container).css({zIndex:1,left:0,top:0}).show(),a._controls.swap(),a._options.imagePan&&a.addPan(r.image),(o.iframe&&o.image||o.link||a._options.lightbox||a._options.clicknext)&&t(r.image).css({cursor:"pointer"}).bind("mouseup",function(r){if(!("number"==typeof r.which&&r.which>1)){if(o.iframe){a.isPlaying()&&a.pause();var s=a._controls.frames[a._controls.active],c=a._stageWidth,l=a._stageHeight;return t(s.container).css({width:c,height:l,opacity:0}).show().animate({opacity:1},200),void n.setTimeout(function(){s.load(o.iframe+(o.video?"&autoplay=1":""),{width:c,height:l},function(t){a.$("container").addClass("videoplay"),t.scale({width:a._stageWidth,height:a._stageHeight,iframelimit:o.video?a._options.maxVideoSize:i})})},100)}return a._options.clicknext&&!e.TOUCH?(a._options.pauseOnInteraction&&a.pause(),void a.next()):o.link?void(a._options.popupLinks?u=n.open(o.link,"_blank"):n.location.href=o.link):void(a._options.lightbox&&a.openLightbox())}}),a._playCheck(),a.trigger({type:e.IMAGE,index:l.index,imageTarget:r.image,thumbTarget:h.image,galleriaData:o}),s.shift.call(a._queue),a._queue.stalled=!1,a._queue.length&&a._show()}}(r,h,l,o,d);if(this._options.carousel&&this._options.carouselFollow&&this._carousel.follow(o.index),this._options.preload){var f,m,v,y=this.getNext();try{for(m=this._options.preload;m>0;m--)f=new e.Picture,v=a.getData(y),f.preload(this.isFullscreen()&&v.big?v.big:v.image),y=a.getNext(y)}catch(b){}}H.show(h.container),h.isIframe=r.iframe&&!r.image,t(a._thumbnails[o.index].container).addClass("active").siblings(".active").removeClass("active"),a.trigger({type:e.LOADSTART,cached:u,index:o.index,rewind:o.rewind,imageTarget:h.image,thumbTarget:d.image,galleriaData:r}),a._queue.stalled=!0,h.load(c,function(n){var s=t(a._layers[1-a._controls.active]).html(r.layer||"").hide();a._scaleImage(n,{complete:function(n){"image"in l&&H.toggleQuality(l.image,!1),H.toggleQuality(n.image,!1),a.removePan(),a.setInfo(o.index),a.setCounter(o.index),r.layer&&(s.show(),(r.iframe&&r.image||r.link||a._options.lightbox||a._options.clicknext)&&s.css("cursor","pointer").unbind("mouseup").mouseup(p)),r.video&&r.image&&O(n.container);var c=a._options.transition;if(t.each({initial:null===l.image,touch:e.TOUCH,fullscreen:a.isFullscreen()},function(t,e){return e&&a._options[t+"Transition"]!==i?(c=a._options[t+"Transition"],!1):void 0}),c in F.effects==!1)g();else{var h={prev:l.container,next:n.container,rewind:o.rewind,speed:a._options.transitionSpeed||400};F.active=!0,F.init.call(a,c,h,g)}a.trigger({type:e.LOADFINISH,cached:u,index:o.index,rewind:o.rewind,imageTarget:n.image,thumbTarget:a._thumbnails[o.index].image,galleriaData:a.getData(o.index)})}})})}},getNext:function(t){return t="number"==typeof t?t:this.getIndex(),t===this.getDataLength()-1?0:t+1},getPrev:function(t){return t="number"==typeof t?t:this.getIndex(),0===t?this.getDataLength()-1:t-1},next:function(){return this.getDataLength()>1&&this.show(this.getNext(),!1),this},prev:function(){return this.getDataLength()>1&&this.show(this.getPrev(),!0),this},get:function(t){return t in this._dom?this._dom[t]:null},getData:function(t){return t in this._data?this._data[t]:this._data[this._active]},getDataLength:function(){return this._data.length},getIndex:function(){return"number"==typeof this._active?this._active:!1},getStageHeight:function(){return this._stageHeight},getStageWidth:function(){return this._stageWidth},getOptions:function(t){return"undefined"==typeof t?this._options:this._options[t]},setOptions:function(e,i){return"object"==typeof e?t.extend(this._options,e):this._options[e]=i,this},play:function(t){return this._playing=!0,this._playtime=t||this._playtime,this._playCheck(),this.trigger(e.PLAY),this},pause:function(){return this._playing=!1,this.trigger(e.PAUSE),this},playToggle:function(t){return this._playing?this.pause():this.play(t)},isPlaying:function(){return this._playing},isFullscreen:function(){return this._fullscreen.active},_playCheck:function(){var t=this,i=0,n=20,a=H.timestamp(),o="play"+this._id;if(this._playing){this.clearTimer(o);var r=function(){return i=H.timestamp()-a,i>=t._playtime&&t._playing?(t.clearTimer(o),void t.next()):void(t._playing&&(t.trigger({type:e.PROGRESS,percent:f.ceil(i/t._playtime*100),seconds:f.floor(i/1e3),milliseconds:i}),t.addTimer(o,r,n)))};t.addTimer(o,r,n)}},setPlaytime:function(t){return this._playtime=t,this},setIndex:function(t){return this._active=t,this},setCounter:function(t){if("number"==typeof t?t++:"undefined"==typeof t&&(t=this.getIndex()+1),this.get("current").innerHTML=t,y){var e=this.$("counter"),i=e.css("opacity");1===parseInt(i,10)?H.removeAlpha(e[0]):this.$("counter").css("opacity",i)}return this},setInfo:function(e){var i=this,n=this.getData(e);return t.each(["title","description"],function(t,e){var a=i.$("info-"+e);n[e]?a[n[e].length?"show":"hide"]().html(n[e]):a.empty().hide()}),this},hasInfo:function(t){var e,i="title description".split(" ");for(e=0;i[e];e++)if(this.getData(t)[i[e]])return!0;return!1},jQuery:function(e){var i=this,n=[];t.each(e.split(","),function(e,a){a=t.trim(a),i.get(a)&&n.push(a)});var a=t(i.get(n.shift()));return t.each(n,function(t,e){a=a.add(i.get(e))}),a},$:function(){return this.jQuery.apply(this,H.array(arguments))}},t.each(x,function(t,i){var n=/_/.test(i)?i.replace(/_/g,""):i;e[i.toUpperCase()]="galleria."+n}),t.extend(e,{IE9:9===y,IE8:8===y,IE7:7===y,IE6:6===y,IE:y,WEBKIT:/webkit/.test(d),CHROME:/chrome/.test(d),SAFARI:/safari/.test(d)&&!/chrome/.test(d),QUIRK:y&&a.compatMode&&"BackCompat"===a.compatMode,MAC:/mac/.test(navigator.platform.toLowerCase()),OPERA:!!n.opera,IPHONE:/iphone/.test(d),IPAD:/ipad/.test(d),ANDROID:/android/.test(d),TOUCH:"ontouchstart"in a}),e.addTheme=function(i){i.name||e.raise("No theme name specified"),i.defaults="object"!=typeof i.defaults?{}:T(i.defaults);var a,o=!1;return"string"==typeof i.css?(t("link").each(function(t,e){return a=new RegExp(i.css),a.test(e.href)?(o=!0,z(i),!1):void 0}),o||t(function(){t("script").each(function(t,e){a=new RegExp("galleria\\."+i.name.toLowerCase()+"\\."),a.test(e.src)&&(o=e.src.replace(/[^\/]*$/,"")+i.css,n.setTimeout(function(){H.loadCSS(o,"galleria-theme",function(){z(i)})},1))}),o||e.raise("No theme CSS loaded")})):z(i),i},e.loadTheme=function(i){if(!t("script").filter(function(){return t(this).attr("src")==i}).length){var a,o=!1;return t(n).load(function(){o||(a=n.setTimeout(function(){o||e.theme||e.raise("Galleria had problems loading theme at "+i+". Please check theme path or load manually.",!0)},2e4))}),e.unloadTheme(),H.loadScript(i,function(){o=!0,n.clearTimeout(a)}),e}},e.unloadTheme=function(){return"object"==typeof e.theme&&(t("script").each(function(i,n){new RegExp("galleria\\."+e.theme.name+"\\.").test(n.src)&&t(n).remove()}),e.theme=i),e},e.get=function(t){return D[t]?D[t]:"number"!=typeof t?D:void e.raise("Gallery index "+t+" not found")},e.configure=function(i,n){var a={};return"string"==typeof i&&n?(a[i]=n,i=a):t.extend(a,i),e.configure.options=a,t.each(e.get(),function(t,e){e.setOptions(a)}),e},e.configure.options={},e.on=function(i,n){if(i){n=n||m;var a=i+n.toString().replace(/\s/g,"")+H.timestamp();return t.each(e.get(),function(t,e){e._binds.push(a),e.bind(i,n)}),e.on.binds.push({type:i,callback:n,hash:a}),e}},e.on.binds=[],e.run=function(i,n){return t.isFunction(n)&&(n={extend:n}),t(i||"#galleria").galleria(n),e},e.addTransition=function(t,i){return F.effects[t]=i,e},e.utils=H,e.log=function(){var e=H.array(arguments);if(!("console"in n&&"log"in n.console))return n.alert(e.join("<br>"));try{return n.console.log.apply(n.console,e)}catch(i){t.each(e,function(){n.console.log(this)})}},e.ready=function(i){return"function"!=typeof i?e:(t.each(A,function(t,e){i.call(e,e._options)}),e.ready.callbacks.push(i),e)},e.ready.callbacks=[],e.raise=function(e,i){var n=i?"Fatal error":"Error",a={color:"#fff",position:"absolute",top:0,left:0,zIndex:1e5},o=function(e){var o='<div style="padding:4px;margin:0 0 2px;background:#'+(i?"811":"222")+';">'+(i?"<strong>"+n+": </strong>":"")+e+"</div>";t.each(D,function(){var t=this.$("errors"),e=this.$("target");t.length||(e.css("position","relative"),t=this.addElement("errors").appendChild("target","errors").$("errors").css(a)),t.append(o)}),D.length||t("<div>").css(t.extend(a,{position:"fixed"})).append(o).appendTo(b().body)};if(l){if(o(e),i)throw new Error(n+": "+e)}else if(i){if(L)return;L=!0,i=!1,o("Gallery could not load.")}},e.version=c,e.requires=function(t,i){return i=i||"You need to upgrade Galleria to version "+t+" to use one or more components.",e.version<t&&e.raise(i,!0),e},e.Picture=function(e){this.id=e||null,this.image=null,this.container=H.create("galleria-image"),t(this.container).css({overflow:"hidden",position:"relative"}),this.original={width:0,height:0},this.ready=!1,this.isIframe=!1},e.Picture.prototype={cache:{},show:function(){H.show(this.image)},hide:function(){H.moveOut(this.image)},clear:function(){this.image=null},isCached:function(t){return!!this.cache[t]},preload:function(e){t(new Image).load(function(t,e){return function(){e[t]=t}}(e,this.cache)).attr("src",e)},load:function(i,a,o){if("function"==typeof a&&(o=a,a=null),this.isIframe){var r="if"+(new Date).getTime(),s=this.image=t("<iframe>",{src:i,frameborder:0,id:r,allowfullscreen:!0,css:{visibility:"hidden"}})[0];return a&&t(s).css(a),t(this.container).find("iframe,img").remove(),this.container.appendChild(this.image),t("#"+r).load(function(e,i){return function(){n.setTimeout(function(){t(e.image).css("visibility","visible"),"function"==typeof i&&i.call(e,e)},10)}}(this,o)),this.container}this.image=new Image,e.IE8&&t(this.image).css("filter","inherit");var c=!1,l=!1,h=t(this.container),d=t(this.image),p=function(){c?u?t(this).attr("src",u):e.raise("Image not found: "+i):(c=!0,n.setTimeout(function(t,e){return function(){t.attr("src",e+"?"+H.timestamp())}}(t(this),i),50))},g=function(i,o,r){return function(){var s=function(){t(this).unbind("load"),i.original=a||{height:this.height,width:this.width},e.HAS3D&&(this.style.MozTransform=this.style.webkitTransform="translate3d(0,0,0)"),h.append(this),i.cache[r]=r,"function"==typeof o&&n.setTimeout(function(){o.call(i,i)},1)};this.width&&this.height?s.call(this):n.setTimeout(function(i){return function(){i.width&&i.height?s.call(i):l?e.raise("Could not extract width/height from image: "+i.src+". Traced measures: width:"+i.width+"px, height: "+i.height+"px."):(t(new Image).load(g).attr("src",i.src),l=!0)}}(this),2)}}(this,o,i);return h.find("iframe,img").remove(),d.css("display","block"),H.hide(this.image),t.each("minWidth minHeight maxWidth maxHeight".split(" "),function(t,e){d.css(e,/min/.test(e)?"0":"none")}),d.load(g).bind("error",p).attr("src",i),this.container},scale:function(n){var a=this;if(n=t.extend({width:0,height:0,min:i,max:i,margin:0,complete:m,position:"center",crop:!1,canvas:!1,iframelimit:i},n),this.isIframe){var o,r,s=n.width,c=n.height;
if(n.iframelimit){var l=f.min(n.iframelimit/s,n.iframelimit/c);1>l?(o=s*l,r=c*l,t(this.image).css({top:c/2-r/2,left:s/2-o/2,position:"absolute"})):t(this.image).css({top:0,left:0})}t(this.image).width(o||s).height(r||c).removeAttr("width").removeAttr("height"),t(this.container).width(s).height(c),n.complete.call(a,a);try{this.image.contentWindow&&t(this.image.contentWindow).trigger("resize")}catch(h){}return this.container}if(!this.image)return this.container;var u,d,p,g=t(a.container);return H.wait({until:function(){return u=n.width||g.width()||H.parseValue(g.css("width")),d=n.height||g.height()||H.parseValue(g.css("height")),u&&d},success:function(){var e=(u-2*n.margin)/a.original.width,i=(d-2*n.margin)/a.original.height,o=f.min(e,i),r=f.max(e,i),s={"true":r,width:e,height:i,"false":o,landscape:a.original.width>a.original.height?r:o,portrait:a.original.width<a.original.height?r:o},c=s[n.crop.toString()],l="";n.max&&(c=f.min(n.max,c)),n.min&&(c=f.max(n.min,c)),t.each(["width","height"],function(e,i){t(a.image)[i](a[i]=a.image[i]=f.round(a.original[i]*c))}),t(a.container).width(u).height(d),n.canvas&&$&&($.elem.width=a.width,$.elem.height=a.height,l=a.image.src+":"+a.width+"x"+a.height,a.image.src=$.cache[l]||function(t){$.context.drawImage(a.image,0,0,a.original.width*c,a.original.height*c);try{return p=$.elem.toDataURL(),$.length+=p.length,$.cache[t]=p,p}catch(e){return a.image.src}}(l));var h={},g={},m=function(e,i,n){var o=0;if(/\%/.test(e)){var r=parseInt(e,10)/100,s=a.image[i]||t(a.image)[i]();o=f.ceil(-1*s*r+n*r)}else o=H.parseValue(e);return o},v={top:{top:0},left:{left:0},right:{left:"100%"},bottom:{top:"100%"}};t.each(n.position.toLowerCase().split(" "),function(t,e){"center"===e&&(e="50%"),h[t?"top":"left"]=e}),t.each(h,function(e,i){v.hasOwnProperty(i)&&t.extend(g,v[i])}),h=h.top?t.extend(h,g):g,h=t.extend({top:"50%",left:"50%"},h),t(a.image).css({position:"absolute",top:m(h.top,"height",d),left:m(h.left,"width",u)}),a.show(),a.ready=!0,n.complete.call(a,a)},error:function(){e.raise("Could not scale image: "+a.image.src)},timeout:1e3}),this}},t.extend(t.easing,{galleria:function(t,e,i,n,a){return(e/=a/2)<1?n/2*e*e*e+i:n/2*((e-=2)*e*e+2)+i},galleriaIn:function(t,e,i,n,a){return n*(e/=a)*e+i},galleriaOut:function(t,e,i,n,a){return-n*(e/=a)*(e-2)+i}}),e.Fastclick=function(){var i=/iP(ad|hone|od)/.test(navigator.userAgent),o=i&&/OS 4_\d(_\d)?/.test(navigator.userAgent),r=i&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);return{init:function(i){var a,o=this;this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.layer=i,t.each(["Click","TouchStart","TouchMove","TouchEnd","TouchCancel"],function(t,e){o["on"+e]=function(t){return function(){t.apply(o,arguments)}}(o["on"+e])}),e.TOUCH&&(i.addEventListener("click",this.onClick,!0),i.addEventListener("touchstart",this.onTouchStart,!1),i.addEventListener("touchmove",this.onTouchMove,!1),i.addEventListener("touchend",this.onTouchEnd,!1),i.addEventListener("touchcancel",this.onTouchCancel,!1),n.Event.prototype.stopImmediatePropagation||(i.removeEventListener=function(t,e,a){var o=n.Node.prototype.removeEventListener;"click"===t?o.call(i,t,e.hijacked||e,a):o.call(i,t,e,a)},i.addEventListener=function(t,e,a){var o=n.Node.prototype.addEventListener;"click"===t?o.call(i,t,e.hijacked||(e.hijacked=function(t){t.propagationStopped||e(t)}),a):o.call(i,t,e,a)}),"function"==typeof i.onclick&&(a=i.onclick,i.addEventListener("click",function(t){a(t)},!1),i.onclick=null))},sendClick:function(t,e){var i,o;a.activeElement&&a.activeElement!==t&&a.activeElement.blur(),o=e.changedTouches[0],i=a.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,n,1,o.screenX,o.screenY,o.clientX,o.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,t.dispatchEvent(i)},onTouchStart:function(t){var e,a,r;if(e=t.target,a=t.targetTouches[0],i){if(r=n.getSelection(),r.rangeCount&&!r.isCollapsed)return!0;if(!o){if(a.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=a.identifier}}return this.trackingClick=!0,this.trackingClickStart=t.timeStamp,this.targetElement=e,this.touchStartX=a.pageX,this.touchStartY=a.pageY,t.timeStamp-this.lastClickTime<200&&t.preventDefault(),!0},touchHasMoved:function(t){var e=t.targetTouches[0];return f.abs(e.pageX-this.touchStartX)>10||f.abs(e.pageY-this.touchStartY)>10?!0:!1},onTouchMove:function(t){return this.trackingClick?((this.targetElement!==t.target||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},onTouchEnd:function(t){var e,i,o,s=this.targetElement;return this.trackingClick?t.timeStamp-this.lastClickTime<200?(this.cancelNextClick=!0,!0):(this.lastClickTime=t.timeStamp,e=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,r&&(o=t.changedTouches[0],s=t.target,s=a.elementFromPoint(o.pageX-n.pageXOffset,o.pageY-n.pageYOffset)),i=s.tagName.toLowerCase(),t.preventDefault(),this.sendClick(s,t),!1):!0},onTouchCancel:function(){this.trackingClick=!1,this.targetElement=null},onClick:function(t){var e;return this.targetElement?t.forwardedTouchEvent?!0:(e=this.targetElement,this.targetElement=null,this.trackingClick?(this.trackingClick=!1,!0):t.cancelable&&this.cancelNextClick?(this.cancelNextClick=!1,t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),!1):!0):!0}}}(),e.Finger=function(){var i=f.abs,r=e.HAS3D=function(){var e,i,n=a.createElement("p"),o=["webkit","O","ms","Moz",""],r=0,s="transform";for(b().html.insertBefore(n,null);o[r];r++)i=o[r]?o[r]+"Transform":s,void 0!==n.style[i]&&(n.style[i]="translate3d(1px,1px,1px)",e=t(n).css(o[r]?"-"+o[r].toLowerCase()+"-"+s:s));return b().html.removeChild(n),void 0!==e&&e.length>0&&"none"!==e}(),s=function(){var t="RequestAnimationFrame";return n.requestAnimationFrame||n["webkit"+t]||n["moz"+t]||n["o"+t]||n["ms"+t]||function(t){n.setTimeout(t,1e3/60)}}(),c=function(e,i){if(this.config={start:0,duration:500,onchange:function(){},oncomplete:function(){},easing:function(t,e,i,n,a){return-n*((e=e/a-1)*e*e*e-1)+i}},e.children.length){var a=this;t.extend(this.config,i),this.elem=e,this.child=e.children[0],this.to=this.pos=0,this.touching=!1,this.start={},this.index=this.config.start,this.anim=0,r||(this.child.style.position="absolute",this.elem.style.position="relative"),t.each(["ontouchstart","ontouchmove","ontouchend","setup"],function(t,e){a[e]=function(t){return function(){t.apply(a,arguments)}}(a[e])}),this.setX=function(){var t=a.child.style;return r?void(t.MozTransform=t.webkitTransform="translate3d("+a.pos+"px,0,0)"):void(t.left=a.pos+"px")},t(e).bind("touchstart",this.ontouchstart),t(n).bind("resize",this.setup),t(n).bind("orientationchange",this.setup),this.setup(),function o(){s(o),a.loop.call(a)}()}};return c.prototype={constructor:c,setup:function(){this.width=t(this.elem).width(),this.length=f.ceil(t(this.child).width()/this.width),0!==this.index&&(this.index=f.max(0,f.min(this.index,this.length-1)),this.pos=this.to=-this.width*this.index)},setPosition:function(t){this.pos=t,this.to=t},ontouchstart:function(t){var e=t.originalEvent.touches;this.start={pageX:e[0].pageX,pageY:e[0].pageY,time:+new Date},this.isScrolling=null,this.touching=!0,this.deltaX=0,o.bind("touchmove",this.ontouchmove),o.bind("touchend",this.ontouchend)},ontouchmove:function(t){var e=t.originalEvent.touches;e&&e.length>1||t.scale&&1!==t.scale||(this.deltaX=e[0].pageX-this.start.pageX,null===this.isScrolling&&(this.isScrolling=!!(this.isScrolling||i(this.deltaX)<i(e[0].pageY-this.start.pageY))),this.isScrolling||(t.preventDefault(),this.deltaX/=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0?i(this.deltaX)/this.width+1.8:1,this.to=this.deltaX-this.index*this.width),t.stopPropagation())},ontouchend:function(){this.touching=!1;var t=+new Date-this.start.time<250&&i(this.deltaX)>40||i(this.deltaX)>this.width/2,e=!this.index&&this.deltaX>0||this.index==this.length-1&&this.deltaX<0;this.isScrolling||this.show(this.index+(t&&!e?this.deltaX<0?1:-1:0)),o.unbind("touchmove",this.ontouchmove),o.unbind("touchend",this.ontouchend)},show:function(t){t!=this.index?this.config.onchange.call(this,t):this.to=-(t*this.width)},moveTo:function(t){t!=this.index&&(this.pos=this.to=-(t*this.width),this.index=t)},loop:function(){var t=this.to-this.pos,e=1;this.width&&t&&(e=f.max(.5,f.min(2,f.abs(t/this.width)))),this.touching||i(t)<=1?(this.pos=this.to,this.anim&&this.config.oncomplete(this.index),this.anim=0):(this.anim||(this.anim={v:this.pos,c:t,t:+new Date,f:e}),this.pos=this.config.easing(null,+new Date-this.anim.t,this.anim.v,this.anim.c,this.config.duration*this.anim.f)),this.setX()}},c}(),t.fn.galleria=function(i){var n=this.selector;return t(this).length?this.each(function(){t.data(this,"galleria")&&(t.data(this,"galleria").destroy(),t(this).find("*").hide()),t.data(this,"galleria",(new e).init(this,i))}):(t(function(){t(n).length?t(n).galleria(i):e.utils.wait({until:function(){return t(n).length},success:function(){t(n).galleria(i)},error:function(){e.raise('Init failed: Galleria could not find the element "'+n+'".')},timeout:5e3})}),this)}}(jQuery);