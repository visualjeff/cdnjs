Galleria.requires(1.25,"The Picasa Plugin requires Galleria version 1.2.5 or later."),function(i){var t=Galleria.utils.getScriptPath();Galleria.Picasa=function(){this.options={max:30,imageSize:"medium",thumbSize:"thumb",description:!1,complete:function(){}}},Galleria.Picasa.prototype={constructor:Galleria.Picasa,search:function(i,t){return this._call("search","all",{q:i},t)},user:function(i,t){return this._call("user","user/"+i,t)},useralbum:function(i,t,e){return this._call("useralbum","user/"+i+"/album/"+t,e)},setOptions:function(t){return i.extend(this.options,t),this},_call:function(t,e,a,r){e="https://picasaweb.google.com/data/feed/api/"+e+"?","function"==typeof a&&(r=a,a={});var s=this;a=i.extend({kind:"photo",access:"public","max-results":this.options.max,thumbsize:this._getSizes().join(","),alt:"json-in-script",callback:"?"},a),i.each(a,function(i,t){e+="&"+i+"="+t});var n=!1;return Galleria.utils.wait({until:function(){return n},success:function(){s._parse.call(s,n.feed.entry,r)},error:function(){var i="";"user"==t?i="user not found.":"useralbum"==t&&(i="album or user not found."),Galleria.raise("Picasa request failed"+(i?": "+i:"."))},timeout:5e3}),i.getJSON(e,function(i){n=i}),s},_getSizes:function(){var t,e=this,a={small:"72c",thumb:"104u",medium:"640u",big:"1024u",original:"1600u"},r=e.options,s={},n=[32,48,64,72,94,104,110,128,144,150,160,200,220,288,320,400,512,576,640,720,800,912,1024,1152,1280,1440,1600];return i(["thumbSize","imageSize"]).each(function(){r[this]in a?s[this]=a[r[this]]:(t=Galleria.utils.parseValue(r[this]),t>1600?t=1600:i.each(n,function(i){return this>t?(t=n[i-1],!1):void 0}),s[this]=t)}),[s.thumbSize,s.imageSize,"1280u"]},_parse:function(t,e){var a,r=this,s=[];i.each(t,function(){a=this.media$group.media$thumbnail,s.push({thumb:a[0].url,image:a[1].url,big:a[2].url,title:this.title.$t,description:r.options.description?this.summary.$t:""})}),e.call(this,s)}};var e=Galleria.prototype.load;Galleria.prototype.load=function(){if(arguments.length||"string"!=typeof this._options.picasa)return void e.apply(this,Galleria.utils.array(arguments));var a,r=this,s=Galleria.utils.array(arguments),n=this._options.picasa.split(":"),o=i.extend({},r._options.picasaOptions),l="undefined"!=typeof o.loader?o.loader:i("<div>").css({width:48,height:48,opacity:.7,background:"#000 url("+t+"loader.gif) no-repeat 50% 50%"});if(n.length){if("function"!=typeof Galleria.Picasa.prototype[n[0]])return Galleria.raise(n[0]+" method not found in Picasa plugin"),e.apply(this,s);if(!n[1])return Galleria.raise("No picasa argument found"),e.apply(this,s);window.setTimeout(function(){r.$("target").append(l)},100),a=new Galleria.Picasa,"object"==typeof r._options.picasaOptions&&a.setOptions(r._options.picasaOptions);var u=[];if("useralbum"==n[0]){if(u=n[1].split("/"),2!=u.length)return void Galleria.raise("Picasa useralbum not correctly formatted (should be [user]/[album])")}else u.push(n[1]);u.push(function(i){r._data=i,l.remove(),r.trigger(Galleria.DATA),a.options.complete.call(a,i)}),a[n[0]].apply(a,u)}else e.apply(this,s)}}(jQuery);