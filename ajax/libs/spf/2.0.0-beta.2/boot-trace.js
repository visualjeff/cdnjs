/*
SPF 2.0.0-beta.2
(c) 2012-2014 Google, Inc.
License: MIT
*/
/**
 * https://github.com/google/tracing-framework
 * Copyright 2013 Google, Inc. All Rights Reserved.
 * Use of this source code is governed by a BSD-style license that can be
 * found at https://github.com/google/tracing-framework/blob/master/LICENSE.
 */
(function(){function aa(a){return a};function f(a,b,c){var d=Array.prototype.slice.call(arguments,2);return function(){var c=d.slice();c.push.apply(c,arguments);return a.apply(b,c)}}function ba(a,b){if(document.createEvent){var c=document.createEvent("CustomEvent");c.initCustomEvent(a,!0,!0,b);document.dispatchEvent(c)}}function ca(){};function k(a,b){return m[a]=b}var m=window._spf_state||{};window._spf_state=m;var n={};"config"in m||k("config",n);n=m.config;function p(a,b){if(a.forEach)a.forEach(b,void 0);else for(var c=0,d=a.length;c<d;c++)c in a&&b.call(void 0,a[c],c,a)}function r(a,b){if(a.every)return a.every(b,void 0);for(var c=0,d=a.length;c<d;c++)if(c in a&&!b.call(void 0,a[c],c,a))return!1;return!0}function s(a){return t(a)?a:[a]}function t(a){return"[object Array]"==Object.prototype.toString.call(a)};function da(a,b){var c=b||document;return c.querySelectorAll?c.querySelectorAll(a):[]}function ea(a,b){var c=a||"",d=document,e=d.createElement("iframe");e.id=c;e.src='javascript:""';e.style.display="none";b&&(e.onload=f(b,null,e));d.body.appendChild(e);return e};function u(a,b){a&&b&&(a in v||(v[a]=[]),v[a].push(b))}function fa(a,b){a in v&&b&&r(v[a],function(a,d,e){return a==b?(e[d]=null,!1):!0})}function ga(a){a in v&&p(v[a],function(a,c,d){d[c]=null;a&&a()})}function ha(a,b){a&&b&&a in v&&(v[b]=(v[b]||[]).concat(v[a]),delete v[a])}var v={};"ps-s"in m||k("ps-s",v);v=m["ps-s"];var ia=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s+|\s+$/g,"")};function ja(a){var b=document.createElement("a");b.href=a;b.href=b.href;return b.href.split("#")[0]};var ka=!!this.wtf&&2==this.wtf.trace.API_VERSION,la=ka?this.wtf.trace.instrument:aa;function ma(a){return a}var w=!window._spf_tracing_runtime_disabled&&ka?la:ma;function x(a,b,c){var d=y[a];return a&&b?(d||(d=y[a]=z()),a=A(b,c||0),d.items.push(a)):d&&d.items.length||0}function B(a,b){var c=y[a];if(c){var d=!!c.b||!!c.a;0<c.c&&(b||!d)&&C(a,b)}}function na(a){(a=y[a])&&a.c--}function oa(a,b){var c=y[a];c&&(c.c++,B(a,b))}function pa(a){var b=y[a];b&&(qa(b),delete y[a])}function ra(a,b){var c=a||"",d;for(d in y)b!=d&&0==d.lastIndexOf(c,0)&&pa(d)}function sa(a){var b=parseInt(m.uid,10)||0;b++;return a["spf-key"]||(a["spf-key"]=""+k("uid",b))}
function C(a,b){var c=y[a];if(c&&(qa(c),0<c.c&&c.items.length)){var d=c.items[0];if(d){var e=f(function(a,b){b();a()},null,f(C,null,a,b));b?(c.items.shift(),e(d.e)):ta(c,d,e)}}}function ta(a,b,c){b.d?(c=f(c,null,ca),a.a=setTimeout(c,b.d),b.d=0):(a.items.shift(),c=f(c,null,b.e),(b=n["advanced-task-scheduler"])?a.b=b.f(c):a.a=setTimeout(c,0))}function qa(a){if(a.b){var b=n["advanced-task-scheduler"];b&&b.g(a.b);a.b=0}a.a&&(clearTimeout(a.a),a.a=0)}function z(){return{items:[],b:0,a:0,c:1}}
function A(a,b){return{e:a,d:b}}var y={},x=w(x,"spf.tasks.add"),B=w(B,"spf.tasks.run"),na=w(na,"spf.tasks.suspend"),oa=w(oa,"spf.tasks.resume"),pa=w(pa,"spf.tasks.cancel"),ra=w(ra,"spf.tasks.cancelAllExcept"),sa=w(sa,"spf.tasks.key"),C=w(C,"spf.tasks.do_"),z=w(z,"spf.tasks.createQueue_"),A=w(A,"spf.tasks.createTask_");var ua;function va(a,b,c,d){var e=a==D;if(t(b)){var g=b;setTimeout(function(){throw Error(a+' load for "'+c+'" called with too many urls '+g+"; pass only one string");},0);b=b[0]}b=E(a,b);var l=c||"^"+b,q=F(a,l);if(c){var h=G(a,c);h&&b!=h&&(ba(e?"spfjsbeforeunload":"spfcssbeforeunload",{name:c,urls:[h],url:h}),wa(a,c,h),u(q,f(xa,null,a,c,h)))}(e=ya(a,b))&&l!=e&&(H(a,e),za(a,b),e=F(a,e),ha(e,q));Aa(a,b,l);I(a,l,b);u(q,d);d=f(J,null,a);K(a,b)?d():(b=L(a,b,d))&&c&&b.setAttribute("name",c)}
function Ba(a,b){var c=G(a,b);wa(a,b,c);xa(a,b,c)}function wa(a,b,c){H(a,b);c&&za(a,c);a=F(a,b);delete v[a]}function xa(a,b,c){var d=a==D;c&&(ba(d?"spfjsunload":"spfcssunload",{name:b,urls:[c],url:c}),M(a,c))}function J(a){var b=F(a,""),c;for(c in v)0==c.indexOf(b)&&r(c.substring(b.length).split("|"),f(N,null,a))&&ga(c)}
function L(a,b,c,d,e){function g(){K(a,b,e)&&O(P,a,b,e);l&&h&&h.parentNode&&q==document&&h.parentNode.removeChild(h);c&&setTimeout(c,0);return null}var l=a==D;b=E(a,b);O(Ca,a,b,e);var q=d||document,h=q.createElement(l?"script":"link");if(!b)return g();d=Q(b);h.className=F(a,d);"onload"in h?h.onerror=h.onload=g:h.onreadystatechange=function(){/^c|loade/.test(h.readyState)&&g()};d=q.getElementsByTagName("head")[0];l?(h.async=!0,h.src=b,d.insertBefore(h,d.firstChild)):(h.rel="stylesheet",h.href=b,d.appendChild(h));
return h}function M(a,b,c){b=E(a,b);var d=Q(b),d=F(a,d);c=da("."+d,c);p(c,function(a){a&&a.parentNode&&a.parentNode.removeChild(a)});Da(a,b)}
function Ea(a){var b=a==D,c=[];p(da(b?"script[src]":'link[rel~="stylesheet"]'),function(d){var e=b?d.src:d.href,e=E(a,e);if(!K(a,e)){O(P,a,e);var g=Q(e),g=F(a,g);if(d.classList)d.classList.add(g);else{var l;a:if(d.classList)l=d.classList.contains(g);else{l=d.classList?d.classList:d.className&&d.className.match(/\S+/g)||[];for(var q=0,h=l.length;q<h;q++)if(l[q]==g){l=!0;break a}l=!1}l||(d.className+=" "+g)}if(g=d.getAttribute("name"))Aa(a,e,g),I(a,g,e);c.push(d)}});return c}
function Fa(a,b){if(b&&(b=E(a,b),!K(a,b))){var c=Q(b),d=F(a,c),e=F(a,"prefetch"),c=document.getElementById(e);if(!c)c=ea(e,function(a){a.title=e;B(e,!0)});else if(c.contentWindow.document.getElementById(d))return;d=f(Ga,null,c,a,b,d,e);c.title?d():x(e,d)}}
function Ga(a,b,c,d,e){var g=b==Ha;a=a.contentWindow.document;b==D?(b=a.createElement("object"),Ia?a.createElement("script").src=c:b.data=c,b.id=d,a.body.appendChild(b)):g?(b=L(b,c,null,a,e),b.id=d):(b=a.createElement("img"),b.src=c,b.id=d,a.body.appendChild(b))}
function Ja(a,b,c){for(var d=a==D,e=G(a,c),g=b.replace(/\s/g,""),g=g||"",l=0,q=0,h=g.length;q<h;++q)l=31*l+g.charCodeAt(q),l%=4294967296;g="hash-"+l;I(a,c,g);!R(a,g)&&(b=Ka(a,b))&&(O(P,a,g),b&&!d&&(d=Q(g),d=F(a,d),b.className=d,b.setAttribute("name",c)),(e=e&&e[0])&&M(a,e))}
function Ka(a,b){b=ia(b);if(!b)return null;var c=document.getElementsByTagName("head")[0]||document.body,d;a==D?(d=document.createElement("script"),d.text=b,c.appendChild(d),c.removeChild(d)):(d=document.createElement("style"),c.appendChild(d),"styleSheet"in d?d.styleSheet.cssText=b:d.appendChild(document.createTextNode(b)));return d}function La(a,b){k("rsrc-p-"+a,b)}
function E(a,b){var c="rsrc-p-"+a;if(b){var d=b.indexOf("//");if(0>d){if(0==b.lastIndexOf("hash-",0))return b;c=m[c]||"";if("[object String]"==Object.prototype.toString.call(c))b=c+b;else for(var e in c)b=b.replace(e,c[e]);b=0>b.indexOf("."+a)?b+"."+a:b;b=ja(b)}else 0==d&&(b=ja(b))}return b}function F(a,b,c){return a+"-"+b+(c?"-"+c:"")}function Q(a){return a?String(a).replace(/[^\w]/g,""):""}function O(a,b,c,d){b=F(b,c,d);S[b]=a}function K(a,b,c){a=F(a,b,c);return S[a]}
function Da(a,b){var c=F(a,b);delete S[c]}function R(a,b){var c=K(a,b);return""==b||c==P}function Aa(a,b,c){a=F(a,b);T[a]=c}function ya(a,b){var c=F(a,b);return T[c]}function za(a,b){var c=F(a,b);delete T[c]}function I(a,b,c){a=F(a,b);U[a]=c}function G(a,b){var c=F(a,b),c=U[c];t(c)&&(c=c[0]);return c}function H(a,b){var c=F(a,b);delete U[c]}function N(a,b){var c=G(a,b);return""==b||void 0!=c&&R(a,c)}var S={},T={},U={},Ia=-1!=navigator.userAgent.indexOf(" Trident/"),Ca=1,P=2,Ha="css",D="js";
"rsrc-s"in m||k("rsrc-s",S);S=m["rsrc-s"];"rsrc-n"in m||k("rsrc-n",T);T=m["rsrc-n"];"rsrc-u"in m||k("rsrc-u",U);U=m["rsrc-u"];va=w(va,"spf.net.resource.load");Ba=w(Ba,"spf.net.resource.unload");ua=w(ua,"spf.net.resource.unload_");J=w(J,"spf.net.resource.check");L=w(L,"spf.net.resource.create");M=w(M,"spf.net.resource.destroy");Ea=w(Ea,"spf.net.resource.discover");Fa=w(Fa,"spf.net.resource.prefetch");Ga=w(Ga,"spf.net.resource.prefetch_");Ja=w(Ja,"spf.net.resource.eval");Ka=w(Ka,"spf.net.resource.exec");
La=w(La,"spf.net.resource.path");E=w(E,"spf.net.resource.canonicalize");F=w(F,"spf.net.resource.key");Q=w(Q,"spf.net.resource.label");O=w(O,"spf.net.resource.status.set");K=w(K,"spf.net.resource.status.get");Da=w(Da,"spf.net.resource.status.clear");R=w(R,"spf.net.resource.status.loaded");I=w(I,"spf.net.resource.url.set");G=w(G,"spf.net.resource.url.get");H=w(H,"spf.net.resource.url.clear");N=w(N,"spf.net.resource.url.loaded");function V(a,b,c){va(D,a,b,c)}function Ma(a){Ba(D,a)}function Na(){Ea(D)}function Oa(a,b){L(D,a,b)}function Pa(a){a=s(a);p(a,function(a){Fa(D,a)})}function W(a,b,c){a=s(a);var d=[];p(a,function(a){a&&void 0==G(D,a)&&d.push(a)});var e=!d.length;if(b){var g=r(a,f(N,null,D));e&&g?b():(a=F(D,a.sort().join("|")),u(a,b))}c&&!e&&c(d)}function Qa(a){I(D,a,"");J(D)}function Ra(a,b){a=s(a);var c=F(D,a.sort().join("|"));fa(c,b)}
function X(a,b){a=s(a);p(a,function(a){if(a){var b=Y[a]||a;t(b)&&(b=b[0]);var b=E(D,b),e=G(D,a);e&&b!=e&&Z(a)}});W(a,b,Sa)}function Sa(a){p(a,function(a){function c(){V(e,a)}var d=$[a],e=Y[a]||a;t(e)&&(e=e[0]);d?X(d,c):c()})}function Z(a){a=s(a);p(a,function(a){var c=[],d;for(d in $){var e=$[d],e=s(e);p(e,function(e){e==a&&c.push(d)})}p(c,function(a){Z(a)});Ma(a)})}function Ta(a,b){Ja(D,a,b)}function Ua(a,b){if(a){for(var c in a)$[c]=a[c];if(b)for(c in b)Y[c]=b[c]}}function Va(a){La(D,a)}var $={};
"js-d"in m||k("js-d",$);var $=m["js-d"],Y={};"js-u"in m||k("js-u",Y);Y=m["js-u"];V=w(V,"spf.net.script.load");Ma=w(Ma,"spf.net.script.unload");Na=w(Na,"spf.net.script.discover");Oa=w(Oa,"spf.net.script.get");Pa=w(Pa,"spf.net.script.prefetch");W=w(W,"spf.net.script.ready");Qa=w(Qa,"spf.net.script.done");Ra=w(Ra,"spf.net.script.ignore");X=w(X,"spf.net.script.require");Sa=w(Sa,"spf.net.script.require_");Z=w(Z,"spf.net.script.unrequire");Ta=w(Ta,"spf.net.script.eval");Ua=w(Ua,"spf.net.script.declare");
Va=w(Va,"spf.net.script.path");var Wa={script:{load:V,get:Oa,ready:W,done:Qa,require:X,declare:Ua,path:Va}},Xa=this.spf=this.spf||{},Ya;for(Ya in Wa)Xa[Ya]=Wa[Ya];})();
