!function(){var e="object"==typeof module&&module.exports,n=!e&&window,t=function(n){function t(e){for(var n=[],t=Object.keys(e).sort(),r=0;r<t.length;++r){var a=t[r],i=e[a];_(i)||(i=[i]);for(var o=0;o<i.length;++o){var l=i[o];if(!J(l))throw new bn("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{languageMap:e});n.push({"@value":l,"@language":a.toLowerCase()})}}return n}function r(e,n){if(_(n))for(var t=0;t<n.length;++t)n[t]=r(e,n[t]);else if(X(n))n["@list"]=r(e,n["@list"]);else if(R(n)){H(n)&&(n["@id"]=e.getName(n["@id"]));for(var a=Object.keys(n).sort(),i=0;i<a.length;++i){var o=a[i];"@id"!==o&&(n[o]=r(e,n[o]))}}return n}function a(e,t,r){if(null===r)return null;var a=E(e,t,{vocab:!0});if("@id"===a)return E(e,r,{base:!0});if("@type"===a)return E(e,r,{vocab:!0,base:!0});var i=n.getContextValue(e,t,"@type");if("@id"===i||"@graph"===a&&J(r))return{"@id":E(e,r,{base:!0})};if("@vocab"===i)return{"@id":E(e,r,{vocab:!0,base:!0})};if(L(a))return r;if(rval={},null!==i)e.namer&&0===i.indexOf("_:")&&(i=e.namer.getName(i)),rval["@type"]=i;else if(J(r)){var o=n.getContextValue(e,t,"@language");null!==o&&(rval["@language"]=o)}return rval["@value"]=r,rval}function i(e,n,t,r,a,o){if(_(e))for(var l in e)i(e[l],n,t,r,a,o);else{if(J(e)){var u={subject:$(t),property:$(r),object:{nominalValue:e,interfaceName:"IRI"}};return null!==a&&(u.name=a),o(null,u)}if(X(e)){var f=s(e);return i(f,n,t,r,a,o)}if(G(e)){var c=e["@value"],p=e["@type"]||null;z(c)?(c=c.toString(),p=p||ln):F(c)?(c=c.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),p=p||sn):U(c)&&(c=c.toFixed(0),p=p||un),p=p||fn;var d={nominalValue:c,interfaceName:"LiteralNode",datatype:{nominalValue:p,interfaceName:"IRI"}};"@language"in e&&p===fn&&(d.language=e["@language"]);var u={subject:$(t),property:$(r),object:d};return null!==a&&(u.name=a),o(null,u)}var v=H(e),h=v?n.getName(e["@id"]):e["@id"],d={nominalValue:h,interfaceName:v?"BlankNode":"IRI"};if(null!==t){var u={subject:$(t),property:$(r),object:$(d)};null!==a&&(u.name=a),o(null,u)}t=d;var g=Object.keys(e).sort();for(var m in g){var y=g[m],x=e[y];"@type"===y&&(y=hn),"@graph"!==y?L(y)||(r={nominalValue:y,interfaceName:"IRI"},i(x,n,t,r,a,o)):i(x,n,null,null,t,o)}}}function o(e,n){if("IRI"===e.interfaceName&&e.nominalValue===vn)return{"@list":[]};if("IRI"===e.interfaceName||"BlankNode"===e.interfaceName)return{"@id":e.nominalValue};var t={"@value":e.nominalValue};if("datatype"in e){var r=e.datatype.nominalValue;if(n){if(r===ln)"true"===t["@value"]?t["@value"]=!0:"false"===t["@value"]&&(t["@value"]=!1);else if(B(t["@value"]))if(r===un){var a=parseInt(t["@value"]);a.toFixed(0)===t["@value"]&&(t["@value"]=a)}else r===sn&&(t["@value"]=parseFloat(t["@value"]));-1===[ln,un,sn,fn].indexOf(r)&&(t["@type"]=r)}else t["@type"]=r}return"language"in e&&(t["@language"]=e.language),t}function l(e,n){if(J(e)||J(n))return e===n;var t=["subject","property","object"];for(var r in t){var a=t[r];if(e[a].interfaceName!==n[a].interfaceName||e[a].nominalValue!==n[a].nominalValue)return!1}return e.object.language!==n.object.language?!1:"datatype"in e.object!="datatype"in n.object?!1:"datatype"in e.object&&(e.object.datatype.interfaceName!==n.object.datatype.interfaceName||e.object.datatype.nominalValue!==n.object.datatype.nominalValue)?!1:e.name!==n.name?!1:!0}function s(e){for(var n=e["@list"],t=n.length,r={"@id":vn},a=t-1;a>=0;--a){var i={};i[pn]=[n[a]],i[dn]=[r],r=i}return r}function u(e,n){if("hash"in n[e])return n[e].hash;var t=n[e].statements,r=[];for(var a in t)r.push(W(t[a],e));r.sort();var i=n[e].hash=jn.hash(r);return i}function f(e,n,t,r,a){function i(a){if(a===d.length)return l=Object.keys(p).sort(),o(0);var s=d[a],f=c(s.subject,e),v=null;if(null!==f?v="p":(f=c(s.object,e),null!==f&&(v="r")),null!==f){var h;h=t.isNamed(f)?t.getName(f):r.isNamed(f)?r.getName(f):u(f,n,t);var g=jn.create();g.update(v),g.update(s.property.nominalValue),g.update(h);var m=g.digest();m in p?p[m].push(f):p[m]=[f]}setTimeout(function(){i(a+1)},0)}function o(e){function i(){function l(e){if(e===m.length)return u(!1);var r=m[e];f(r,n,t,h,function(n,t){return n?a(n):(g+=h.getName(r)+"<"+t.hash+">",h=t.pathNamer,null!==c&&g.length>=c.length&&g>c?u(!0):void l(e+1))})}function u(n){!n&&(null===c||c>g)&&(c=g,d=h),v.hasNext()?setTimeout(function(){i()},0):(s.update(c),r=d,o(e+1))}var p=v.next(),h=r.clone(),g="",m=[];for(var y in p){var x=p[y];if(t.isNamed(x)?g+=t.getName(x):(h.isNamed(x)||m.push(x),g+=h.getName(x)),null!==c&&g.length>=c.length&&g>c)return u(!0)}l(0)}if(e===l.length)return a(null,{hash:s.digest(),pathNamer:r});var u=l[e];s.update(u);var c=null,d=null,v=new Permutator(p[u]);setTimeout(function(){i()},0)}var l,s=jn.create(),p={},d=n[e].statements;setTimeout(function(){i(0)},0)}function c(e,n){return"BlankNode"===e.interfaceName&&e.nominalValue!==n?e.nominalValue:null}function p(e,t,r,a,i,o){if(_(e))for(var l in e)p(e[l],t,r,a,void 0,o);else{if(!R(e))return void(o&&o.push(e));if("@type"in e){var s=e["@type"];_(s)||(s=[s]);for(var u=0;u<s.length;++u){var f=s[u],c=0===f.indexOf("_:")?a.getName(f):f;c in t[r]||(t[r][c]={"@id":c})}}if(G(e))return void(o&&o.push(e));M(i)&&(i=H(e)?a.getName(e["@id"]):e["@id"]),o&&o.push({"@id":i});var d=t[r],v=d[i]=d[i]||{};v["@id"]=i;for(var h=Object.keys(e).sort(),g=0;g<h.length;++g){var m=h[g];if("@id"!==m)if("@graph"!==m)if("@type"!==m&&L(m))v[m]=e[m];else{var y=e[m];if(0!==y.length)for(var x=0;x<y.length;++x){var b=y[x];if(q(b)||P(b)){var c=H(b)?a.getName(b["@id"]):b["@id"];n.addValue(v,m,{"@id":c},{propertyIsArray:!0,allowDuplicate:!1}),p(b,t,r,a,c)}else if(X(b)){var w=[];p(b["@list"],t,r,a,i,w),b={"@list":w},n.addValue(v,m,b,{propertyIsArray:!0,allowDuplicate:!1})}else p(b,t,r,a,i),n.addValue(v,m,b,{propertyIsArray:!0,allowDuplicate:!1})}else n.addValue(v,m,[],{propertyIsArray:!0})}else{i in t||(t[i]={});var j="@merged"===r?r:i;p(e[m],t,j,a)}}}}function d(e,t,r,a,i){h(e,r),r=r[0];var o=g(e,t,r),l=e.options,s=v(r,l,"embed"),u=v(r,l,"explicit"),f=Object.keys(o).sort();for(var c in f){var p=f[c];null===i&&(e.embeds={});var m={};m["@id"]=p;var w={parent:a,property:i};if(s&&p in e.embeds){s=!1;var j=e.embeds[p];if(_(j.parent)){for(var N in j.parent)if(n.compareValues(m,j.parent[N])){s=!0;break}}else n.hasValue(j.parent,j.property,m)&&(s=!0);s&&x(e,p)}if(s){e.embeds[p]=w;var O=o[p],C=Object.keys(O).sort();for(var N in C){var I=C[N];if(L(I))m[I]=$(O[I]);else if(I in r){var S=O[I];for(var N in S){var E=S[N];if(X(E)){var V={"@list":[]};b(e,m,I,V);var k=E["@list"];for(var D in k)E=k[D],P(E)?d(e,[E["@id"]],r[I],V,"@list"):b(e,V,"@list",$(E))}else P(E)?d(e,[E["@id"]],r[I],m,I):b(e,m,I,$(E))}}else u||y(e,O,I,m)}var C=Object.keys(r).sort();for(var N in C){var I=C[N];if(!L(I)){var R=r[I][0],T=v(R,l,"omitDefault");if(!(T||I in m)){var A="@null";"@default"in R&&(A=$(R["@default"])),_(A)||(A=[A]),m[I]=[{"@preserve":A}]}}}b(e,a,i,m)}else b(e,a,i,m)}}function v(e,n,t){var r="@"+t;return r in e?e[r][0]:n[t]}function h(e,n){if(!_(n)||1!==n.length||!R(n[0]))throw new bn("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:n})}function g(e,n,t){var r={};for(var a in n){var i=n[a],o=e.subjects[i];m(o,t)&&(r[i]=o)}return r}function m(e,t){if("@type"in t&&(1!==t["@type"].length||!R(t["@type"][0]))){var r=t["@type"];for(var a in r)if(n.hasValue(e,"@type",r[a]))return!0;return!1}for(var i in t)if(!("@id"!==i&&L(i)||i in e))return!1;return!0}function y(e,n,t,r){var a=n[t];for(var i in a){var o=a[i];if(X(o)){var l={"@list":[]};return b(e,r,t,l),y(e,o,"@list",l["@list"])}if(P(o)){var s=o["@id"];if(!(s in e.embeds)){var u={parent:r,property:t};e.embeds[s]=u,o={};var f=e.subjects[s];for(var c in f)L(c)?o[c]=$(f[c]):y(e,f,c,o)}b(e,r,t,o)}else b(e,r,t,$(o))}}function x(e,t){var r=e.embeds,a=r[t],i=a.parent,o=a.property,l={"@id":t};if(_(i)){for(var s in i)if(n.compareValues(i[s],l)){i[s]=l;break}}else{var u=_(i[o]);n.removeValue(i,o,l,{propertyIsArray:u}),n.addValue(i,o,l,{propertyIsArray:u})}var f=function(e){var n=Object.keys(r);for(var t in n){var a=n[t];a in r&&R(r[a].parent)&&r[a].parent["@id"]===e&&(delete r[a],f(a))}};f(t)}function b(e,t,r,a){R(t)?n.addValue(t,r,a,{propertyIsArray:!0}):t.push(a)}function w(e,t){if(_(t)){var r=[];for(var a in t){var i=w(e,t[a]);null!==i&&r.push(i)}t=r}else if(R(t)){if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(G(t))return t;if(X(t))return t["@list"]=w(e,t["@list"]),t;for(var o in t){var i=w(e,t[o]),l=n.getContextValue(e,o,"@container");_(i)&&1===i.length&&null===l&&(i=i[0]),t[o]=i}}return t}function j(e,n){return e.length<n.length?-1:n.length<e.length?1:e===n?0:n>e?-1:1}function N(e,n,t,r,a,i,o){a.push("@none"),null===o&&(o="@null");var l;if("@id"===o&&P(t)){var s=O(e,t["@id"],null,{vocab:!0});l=s in e.mappings&&e.mappings[s]&&e.mappings[s]["@id"]===t["@id"]?["@vocab","@id","@none"]:["@id","@vocab","@none"]}else l=[o,"@none"];for(var s=null,u=e.inverse[n],f=0;null===s&&f<a.length;++f){var c=a[f];if(c in u)for(var p=u[c][i],d=0;null===s&&d<l.length;++d){var v=l[d];if(v in p){var h=p[v];if(R(r))for(var g=0;g<h.propertyGenerators.length;++g){var m=h.propertyGenerators[g],y=I(e,r,n,t,m,!1);if(y){s=m;break}}null===s&&(s=h.term)}}}return s}function O(e,n,t,r,a){if(null===n)return n;if(L(n)){var i=e.keywords[n];return i.length>0?i[0]:n}if(M(t)&&(t=null),M(a)&&(a=null),r=r||{},r.vocab&&n in e.getInverse()){var o=e["@language"]||"@none",l=[];R(t)&&"@index"in t&&l.push("@index");var s="@language",u="@null";if(X(t)){"@index"in t||l.push("@list");for(var f=t["@list"],c=0===f.length?o:null,p=null,d=0;d<f.length;++d){var v=f[d],h="@none",g="@none";if(G(v)?"@language"in v?h=v["@language"]:"@type"in v?g=v["@type"]:h="@null":g="@id",null===c?c=h:h!==c&&G(v)&&(c="@none"),null===p?p=g:g!==p&&(p="@none"),"@none"===c&&"@none"===p)break}c=c||"@none",p=p||"@none","@none"!==p?(s="@type",u=p):u=c}else G(t)?"@language"in t&&!("@index"in t)?(l.push("@language"),u=t["@language"]):"@type"in t&&(s="@type",u=t["@type"]):(s="@type",u="@id"),l.push("@set");var m=N(e,n,t,a,l,s,u);if(null!==m)return m}var y=null;for(var m in e.mappings)if(-1===m.indexOf(":")){var x=e.mappings[m];if(x&&!x.propertyGenerator&&x["@id"]!==n&&0===n.indexOf(x["@id"])){var b=m+":"+n.substr(x["@id"].length),w=!(b in e.mappings)||null===t&&e.mappings[b]&&e.mappings[b]["@id"]===n;w&&(null===y||j(b,y)<0)&&(y=b)}}if(null!==y)return y;if(!r.vocab)return k(e["@base"],n);if("@vocab"in e){var O=e["@vocab"];if(0===n.indexOf(O)&&n!==O){var C=n.substr(O.length);if(!(C in e.mappings))return C}}return n}function C(e,t,r){if(G(r)){var a=n.getContextValue(e,t,"@type"),i=n.getContextValue(e,t,"@language"),o=n.getContextValue(e,t,"@container"),l="@index"in r&&"@index"!==o;if(!l&&(r["@type"]===a||r["@language"]===i))return r["@value"];var s=Object.keys(r).length,u=1===s||2===s&&"@index"in r&&!l,f="@language"in e,c=J(r["@value"]),p=e.mappings[t]&&null===e.mappings[t]["@language"];if(u&&(!f||!c||p))return r["@value"];var d={};return l&&(d[O(e,"@index")]=r["@index"]),"@type"in r?d[O(e,"@type")]=O(e,r["@type"],null,{vocab:!0}):"@language"in r&&(d[O(e,"@language")]=r["@language"]),d[O(e,"@value")]=r["@value"],d}var v=E(e,t,{vocab:!0}),a=n.getContextValue(e,t,"@type"),h=O(e,r["@id"],null,{vocab:"@vocab"===a});if("@id"===a||"@vocab"===a||"@graph"===v)return h;var d={};return d[O(e,"@id")]=h,d}function I(e,t,r,a,i,o){for(var l=!0,s=e.mappings[i]["@id"],u=0;l&&u<s.length;++u){var f=s[u];if(f!==r){if(l=!1,!(f in t))break;var c=t[f];if(_(a)&&0===a.length)l=!0,o&&delete t[f];else for(var p=0;p<c.length;++p){var d=c[p];if(n.compareValues(d,a)){l=!0,o&&(c.splice(p,1),0===c.length&&delete t[f]);break}}}}return l}function S(e,n,t,r){if(t in r){if(r[t])return;throw new bn("Cyclical context definition detected.","jsonld.CyclicalContext",{context:n,term:t})}if(r[t]=!1,L(t))throw new bn("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{context:n});if(e.mappings[t]){var a=e.mappings[t]["@id"];if(L(a)){var i=e.keywords[a];i.splice(i.indexOf(t),1)}}var o=n[t];if(null===o||R(o)&&null===o["@id"])return e.mappings[t]=null,void(r[t]=!0);if(J(o)){var l=E(e,o,{vocab:!0,base:!0},n,r);if(L(l)){if("@context"===l||"@preserve"===l)throw new bn("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError");var i=e.keywords[l];-1===i.indexOf(t)&&(i.push(t),i.sort(j))}return e.mappings[t]={"@id":l},void(r[t]=!0)}if(!R(o))throw new bn("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{context:n});var s={};if(s.propertyGenerator=!1,"@id"in o){var l=o["@id"];if(_(l)){if(null===e.namer)throw new bn("Incompatible JSON-LD options; a property generator was found in the @context, but blank node renaming has been disabled; it must be enabled to use property generators.","jsonld.OptionsError",{context:n});for(var u=[],f=l,c=0;c<f.length;++c){if(l=f[c],J(l)&&(l=E(e,l,{vocab:!0,base:!0},n,r)),!J(l)||L(l))throw new bn('Invalid JSON-LD syntax; property generators must consist of an @id array containing only strings and no string can be "@type".',"jsonld.SyntaxError",{context:n});u.push(l)}s["@id"]=u.sort(),s.propertyGenerator=!0}else{if(!J(l))throw new bn("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{context:n});s["@id"]=E(e,l,{vocab:!0,base:!0},n,r)}}else{var p=t.indexOf(":");if(-1!==p){var d=t.substr(0,p);if(d in n&&S(e,n,d,r),e.mappings[d]){var v=t.substr(p+1);s["@id"]=e.mappings[d]["@id"]+v}else s["@id"]=t}else{if(!("@vocab"in e))throw new bn("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{context:n,term:t});s["@id"]=e["@vocab"]+t}}if("@type"in o){var h=o["@type"];if(!J(h))throw new bn("Invalid JSON-LD syntax; @context @type values must be strings.","jsonld.SyntaxError",{context:n});"@id"!==h&&(h=E(e,h,{vocab:!0,base:!0},n,r)),s["@type"]=h}if("@container"in o){var g=o["@container"];if("@list"!==g&&"@set"!==g&&"@index"!==g&&"@language"!==g)throw new bn("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{context:n});s["@container"]=g}if("@language"in o&&!("@type"in o)){var m=o["@language"];if(null!==m&&!J(m))throw new bn("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{context:n});null!==m&&(m=m.toLowerCase()),s["@language"]=m}e.mappings[t]=s,r[t]=!0}function E(e,n,t,r,a){if(null===n)return null;r&&n in r&&a[n]!==!0&&S(e,r,n,a),t=t||{};var i=null;if(t.vocab){var o=e.mappings[n];if(r&&o&&o.propertyGenerator)throw new bn("Invalid JSON-LD syntax; a term definition cannot have a property generator as a dependency.","jsonld.SyntaxError",{context:r,value:n});if(null===o)return null;o&&!o.propertyGenerator&&(i=o["@id"])}if(null===i){var l=n.indexOf(":");if(-1!==l){var s=n.substr(0,l),u=n.substr(l+1);if("_"!==s&&0!==u.indexOf("//")){r&&s in r&&S(e,r,s,a);var o=e.mappings[s];o&&!o.propertyGenerator&&(i=e.mappings[s]["@id"]+u)}}}if(null===i&&(i=n),L(i))return i;if(Y(i)?!r&&0===i.indexOf("_:")&&e.namer&&(i=e.namer.getName(i)):t.vocab&&"@vocab"in e?i=e["@vocab"]+i:t.base&&(i=V(e["@base"],i)),r&&!Y(i))throw new bn("Invalid JSON-LD syntax; a @context value does not expand to an absolute IRI.","jsonld.SyntaxError",{context:r,value:n});return i}function V(e,t){if(-1!==t.indexOf(":"))return t;J(e)&&(e=n.url.parse(e||""),e.pathname=e.pathname||"");var r=e.host||"",a=n.url.parse(t);a.pathname=a.pathname||"";var i;0===a.href.indexOf("//")?(i=a.href.substr(2),r=i.substr(0,i.lastIndexOf("/")),i=i.substr(r.length)):0===a.pathname.indexOf("/")?i=a.pathname:(i=e.pathname,""!==a.pathname&&(i=i.substr(0,i.lastIndexOf("/")+1)+a.pathname));var o=i.split("/");o=o.filter(function(e,n){return"."!==e&&(""!==e||n===o.length-1)});for(var l=0;l<o.length;){var s=o[l];if(".."===s){if(0===l){var u=o[o.length-1];o=".."!==u?[u]:[];break}o.splice(l-1,2),l-=1}else l+=1}i="/"+o.join("/"),a.query&&(i+="?"+a.query),a.hash&&(i+=a.hash);var f=(e.protocol||"")+"//";return e.auth&&(f+=e.auth+"@"),f+=r+i}function k(e,t){J(e)&&(e=n.url.parse(e||""),e.pathname=e.pathname||"");var r=(e.protocol||"")+"//";if(e.auth&&(r+=e.auth+"@"),r+=e.host||"",0!==t.indexOf(r))return t;for(var a=e.pathname.split("/"),i=t.substr(r.length).split("/");a.length>0&&i.length>0&&a[0]===i[0];)a.shift(),i.shift();var o="";if(a.length>0){-1===e.pathname.indexOf("/",e.pathname.length-1)&&a.pop();for(var l=0;l<a.length;++l)o+="../"}return o+=i.join("/")}function D(e){function t(){var e=this;if(e.inverse)return e.inverse;for(var n=e.inverse={},t=e["@language"]||"@none",a=e.mappings,i=Object.keys(a).sort(j),o=0;o<i.length;++o){var l=i[o],s=a[l];if(null!==s){var u=s["@container"]||"@none",f=s["@id"];_(f)||(f=[f]);for(var c=0;c<f.length;++c){var p=f[c],d=n[p];if(d||(n[p]=d={}),d[u]||(d[u]={"@language":{},"@type":{}}),d=d[u],!("@type"in s))if("@language"in s){var v=s["@language"]||"@null";r(s,l,d["@language"],v)}else r(s,l,d["@language"],t),r(s,l,d["@language"],"@none");if(!("@language"in s)){var h=s["@type"]||"@none";r(s,l,d["@type"],h)}}}}return n}function r(e,n,t,r){r in t||(t[r]={term:null,propertyGenerators:[]});var a=t[r];e.propertyGenerator?a.propertyGenerators.push(n):null===a.term&&(a.term=n)}function a(){var e={};return e["@base"]=this["@base"],e.keywords=$(this.keywords),e.mappings=$(this.mappings),e.namer=this.namer,e.clone=this.clone,e.share=this.share,e.inverse=null,e.getInverse=this.getInverse,e}function i(){var e={};return e["@base"]=this["@base"],e.keywords=this.keywords,e.mappings=this.mappings,e.namer=null,this.namer&&(e.namer=new nn("_:b")),e.clone=this.clone,e.share=this.share,e.inverse=this.inverse,e.getInverse=this.getInverse,e}var o=null;e.renameBlankNodes&&(o=new nn("_:b"));var l=n.url.parse(e.base||"");return l.pathname=l.pathname||"",{"@base":l,mappings:{},keywords:{"@context":[],"@container":[],"@default":[],"@embed":[],"@explicit":[],"@graph":[],"@id":[],"@index":[],"@language":[],"@list":[],"@omitDefault":[],"@preserve":[],"@set":[],"@type":[],"@value":[],"@vocab":[]},namer:o,inverse:null,getInverse:t,clone:a,share:i}}function L(e){if(!J(e))return!1;switch(e){case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function R(e){return"[object Object]"===Object.prototype.toString.call(e)}function T(e){return R(e)&&0===Object.keys(e).length}function _(e){return Array.isArray(e)}function A(e){if(!J(e)&&!T(e)){var n=!1;if(_(e)){n=!0;for(var t in e)if(!J(e[t])){n=!1;break}}if(!n)throw new bn('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{value:e})}}function J(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function U(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function F(e){return U(e)&&-1!==String(e).indexOf(".")}function B(e){return!isNaN(parseFloat(e))&&isFinite(e)}function z(e){return"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e)}function M(e){return"undefined"==typeof e}function q(e){var n=!1;if(R(e)&&!("@value"in e||"@set"in e||"@list"in e)){var t=Object.keys(e).length;n=t>1||!("@id"in e)}return n}function P(e){return R(e)&&1===Object.keys(e).length&&"@id"in e}function G(e){return R(e)&&"@value"in e}function X(e){return R(e)&&"@list"in e}function H(e){var n=!1;return R(e)&&(n="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),n}function Y(e){return J(e)&&-1!==e.indexOf(":")}function $(e){if(e&&"object"==typeof e){var n=_(e)?[]:{};for(var t in e)n[t]=$(e[t]);return n}return e}function Z(e,n,t,r){var a=Object.keys(n).length;if(_(e)){for(var i in e)Z(e[i],n,t,r);return a<Object.keys(n).length}if(R(e)){for(var o in e)if("@context"===o){var l=e[o];if(_(l))for(var s=l.length,i=0;s>i;++i){var u=l[i];J(u)&&(u=V(r,u),t?(u=n[u],_(u)?(Array.prototype.splice.apply(l,[i,1].concat(u)),i+=u.length,s+=u.length):l[i]=u):u in n||(n[u]=!1))}else J(l)&&(l=V(r,l),t?e[o]=n[l]:l in n||(n[l]=!1))}else Z(e[o],n,t,r);return a<Object.keys(n).length}return!1}function Q(e,n,t){var r=null,a=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,i=n.loadContext,o=function(e,n,t,i,l){if(Object.keys(n).length>xn)return r=new bn("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{max:xn}),l(r);var s={},u=function(){Z(e,s,!0,i),l(null,e)};Z(e,s,!1,i)||u();var f=[];for(var c in s)if(s[c]===!1){if(!a.test(c))return r=new bn("Malformed URL.","jsonld.InvalidUrl",{url:c}),l(r);f.push(c)}var p=f.length;for(var d in f)!function(e){if(e in n)return r=new bn("Cyclical @context URLs detected.","jsonld.ContextUrlError",{url:e}),l(r);var a=$(n);a[e]=!0,t(e,function(n,i,f){if(!r){if(!n&&J(f))try{f=JSON.parse(f)}catch(c){n=c}if(n?n=new bn("Derefencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, or a non-JSON response.","jsonld.InvalidUrl",{url:e,cause:n}):R(f)||(n=new bn("Derefencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{url:e,cause:n})),n)return r=n,l(r);"@context"in f||(f={"@context":{}}),o(f,a,t,e,function(n,t){return n?l(n):(s[e]=t["@context"],p-=1,void(0===p&&u()))})}})}(f[d])};o(e,{},i,n.base,t)}function K(e){var n="(?:<([^:]+:[^>]*)>)",t="(_:(?:[A-Za-z][A-Za-z0-9]*))",r='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',a="(?:\\^\\^"+n+")",i="(?:@([a-z]+(?:-[a-z0-9]+)*))",o="(?:"+r+"(?:"+a+"|"+i+")?)",s="[ \\t]+",u="[ \\t]*",f=/(?:\r\n)|(?:\n)|(?:\r)/g,c=new RegExp("^"+u+"$"),p="(?:"+n+"|"+t+")"+s,d=n+s,v="(?:"+n+"|"+t+"|"+o+")"+u,h="(?:\\.|(?:(?:"+n+"|"+t+")"+u+"\\.))",g=new RegExp("^"+u+p+d+v+h+u+"$"),m=[],y=e.split(f),x=0;for(var b in y){var w=y[b];if(x++,!c.test(w)){var j=w.match(g);if(null===j)throw new bn("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:x});var N={};if(N.subject=M(j[1])?{nominalValue:j[2],interfaceName:"BlankNode"}:{nominalValue:j[1],interfaceName:"IRI"},N.property={nominalValue:j[3],interfaceName:"IRI"},M(j[4]))if(M(j[5])){var O=j[6].replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");N.object={nominalValue:O,interfaceName:"LiteralNode"},M(j[7])?M(j[8])||(N.object.language=j[8]):N.object.datatype={nominalValue:j[7],interfaceName:"IRI"}}else N.object={nominalValue:j[5],interfaceName:"BlankNode"};else N.object={nominalValue:j[4],interfaceName:"IRI"};M(j[9])?M(j[10])||(N.name={nominalValue:j[10],interfaceName:"BlankNode"}):N.name={nominalValue:j[9],interfaceName:"IRI"};for(var C in m)!l(m[C],N);m.push(N)}}return m}function W(e,n){var t=e.subject,r=e.property,a=e.object,i=e.name||null,o="";if(o+="IRI"===t.interfaceName?"<"+t.nominalValue+">":n?t.nominalValue===n?"_:a":"_:z":t.nominalValue,o+=" <"+r.nominalValue+"> ","IRI"===a.interfaceName)o+="<"+a.nominalValue+">";else if("BlankNode"===a.interfaceName)o+=n?a.nominalValue===n?"_:a":"_:z":a.nominalValue;else{var l=a.nominalValue.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');o+='"'+l+'"',"datatype"in a&&a.datatype.nominalValue!==fn?o+="^^<"+a.datatype.nominalValue+">":"language"in a&&(o+="@"+a.language)}return null!==i&&(o+="IRI"===i.interfaceName?" <"+i.nominalValue+">":n?" _:g":" "+i.nominalValue),o+=" .\n"}function en(e){var n=[],t=e.getSubjects();for(var r in t){var a=t[r];if(null!==a){var i=e.getSubjectTriples(a);if(null!==i){var o=i.predicates;for(var l in o){var s=o[l].objects;for(var u in s){var f=s[u],c={};c.subject=0===a.indexOf("_:")?{nominalValue:a,interfaceName:"BlankNode"}:{nominalValue:a,interfaceName:"IRI"},c.property={nominalValue:l,interfaceName:"IRI"};var p=f.value;if(f.type===mn){an||tn();var d=new an;p="";for(var v=0;v<f.value.length;v++)f.value[v].nodeType===on.ELEMENT_NODE?p+=d.serializeToString(f.value[v]):f.value[v].nodeType===on.TEXT_NODE&&(p+=f.value[v].nodeValue)}c.object={nominalValue:p},f.type===yn?c.object.interfaceName=0===f.value.indexOf("_:")?"BlankNode":"IRI":(c.object.interfaceName="LiteralNode",f.type===gn?f.language&&(c.object.language=f.language):c.object.datatype={nominalValue:f.type,interfaceName:"IRI"}),n.push(c)}}}}}return n}function nn(e){this.prefix=e,this.counter=0,this.existing={}}function tn(){an=require("xmldom").XMLSerializer}n.compact=function(e,t){function r(e,n,r,a){if(e)return o(e);!a.graph&&_(n)?1===n.length?n=n[0]:0===n.length&&(n={}):a.graph&&R(n)&&(n=[n]),R(t)&&"@context"in t&&(t=t["@context"]),t=$(t),_(t)||(t=[t]),a.optimizeCtx&&t.push(a.optimizeCtx);var i=t;t=[];for(var l in i)(!R(i[l])||Object.keys(i[l]).length>0)&&t.push(i[l]);var s=t.length>0;if(1===t.length&&(t=t[0]),s||a.graph)if(_(n)){var u=O(r,"@graph"),f=n;n={},s&&(n["@context"]=t),n[u]=f}else if(R(n)){var f=n;n={"@context":t};for(var c in f)n[c]=f[c]}o(null,n,r)}var a={},i=2;arguments.length>3&&(a=arguments[2]||{},i+=1);var o=arguments[i];if(null===e)return o(null,null);"base"in a||(a.base=""),"strict"in a||(a.strict=!0),"optimize"in a||(a.optimize=!1),"graph"in a||(a.graph=!1),"skipExpansion"in a||(a.skipExpansion=!1),"loadContext"in a||(a.loadContext=n.loadContext);var l=function(e,t,r){return t.skipExpansion?r(null,e):void n.expand(e,t,r)};l(e,a,function(e,i){if(e)return o(new bn("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var l=D(a);n.processContext(l,t,a,function(e,n){if(e)return o(new bn("Could not process context before compaction.","jsonld.CompactError",{cause:e}));try{a.optimize&&(a.optimizeCtx={});var t=(new wn).compact(n,null,i,a);r(null,t,n,a)}catch(l){o(l)}})})},n.expand=function(e){var t,r={},a=1;arguments.length>2&&(r=arguments[1]||{},a+=1),t=arguments[a],"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),"renameBlankNodes"in r||(r.renameBlankNodes=!0),"keepFreeFloatingNodes"in r||(r.keepFreeFloatingNodes=!1),e=$(e),Q(e,r,function(e,n){if(e)return t(e);try{var a=D(r),i=(new wn).expand(a,null,n,r,!1);R(i)&&"@graph"in i&&1===Object.keys(i).length?i=i["@graph"]:null===i&&(i=[]),_(i)||(i=[i]),t(null,i)}catch(o){t(o)}})},n.flatten=function(e,t,r,a){"function"==typeof r&&(a=r,r={}),"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),n.expand(e,r,function(e,i){if(e)return a(new bn("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));try{var o=(new wn).flatten(i)}catch(l){return a(l)}return null===t?a(null,o):(r.graph=!0,r.skipExpansion=!0,void n.compact(o,t,r,function(e,n){return e?a(new bn("Could not compact flattened output.","jsonld.FlattenError",{cause:e})):void a(null,n)}))})},n.frame=function(e,t){var r={},a=2;arguments.length>3&&(r=arguments[2]||{},a+=1);var i=arguments[a];"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),"embed"in r||(r.embed=!0),r.explicit=r.explicit||!1,r.omitDefault=r.omitDefault||!1,r.optimize=r.optimize||!1;var o=t["@context"]||{};n.expand(e,r,function(e,a){if(e)return i(new bn("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var l=$(r);l.keepFreeFloatingNodes=!0,n.expand(t,l,function(e,t){if(e)return i(new bn("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));try{var s=(new wn).frame(a,t,r)}catch(u){return i(u)}l.graph=!0,l.skipExpansion=!0,n.compact(s,o,l,function(e,n,t){if(e)return i(new bn("Could not compact framed output.","jsonld.FrameError",{cause:e}));var r=O(t,"@graph");n[r]=w(t,n[r]),i(null,n)})})})},n.objectify=function(e,t){var r={},a=2;arguments.length>3&&(r=arguments[2]||{},a+=1);var i=arguments[a];"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),n.expand(e,r,function(e,a){if(e)return i(new bn("Could not expand input before framing.","jsonld.FrameError",{cause:e}));try{var o=(new wn).flatten(a)}catch(l){return i(l)}r.graph=!0,r.skipExpansion=!0,n.compact(o,t,r,function(e,t,r){if(e)return i(new bn("Could not compact flattened output.","jsonld.FrameError",{cause:e}));var a=O(r,"@graph");t[a]=w(r,t[a]);var o=t[a][0],l=function(e){if(R(e)||_(e)){if(R(e)){if(l.visited[e["@id"]])return;l.visited[e["@id"]]=!0}for(var t in e){var a=e[t],i="@id"===n.getContextValue(r,t,"@type");if(_(a)||R(a)||i)if(J(a)&&i)e[t]=a=o[a],l(a);else if(_(a))for(var s=0;s<a.length;s++)J(a[s])&&i?a[s]=o[a[s]]:R(a[s])&&"@id"in a[s]&&(a[s]=o[a[s]["@id"]]),l(a[s]);else if(R(a)){var u=a["@id"];e[t]=a=o[u],l(a)}}}};l.visited={},l(o),t.of_type={};for(var s in o)if("@type"in o[s]){var u=o[s]["@type"];_(u)||(u=[u]);for(var f in u)u[f]in t.of_type||(t.of_type[u[f]]=[]),t.of_type[u[f]].push(o[s])}i(null,t)})})},n.normalize=function(e,t){var t,r={},a=1;arguments.length>2&&(r=arguments[1]||{},a+=1),t=arguments[a],"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),n.expand(e,r,function(e,n){return e?t(new bn("Could not expand input before normalization.","jsonld.NormalizeError",{cause:e})):void(new wn).normalize(n,r,t)})},n.fromRDF=function(e){var n,t={},r=1;if(arguments.length>2&&(t=arguments[1]||{},r+=1),n=arguments[r],"useRdfType"in t||(t.useRdfType=!1),"useNativeTypes"in t||(t.useNativeTypes=!0),"format"in t||_(e)||"format"in t||(t.format="application/nquads"),"format"in t){if(!(t.format in rn))throw new bn("Unknown input format.","jsonld.UnknownFormat",{format:t.format});e=rn[t.format](e)}(new wn).fromRDF(e,t,n)},n.toRDF=function(e){var t,r={},a=1;if(arguments.length>2&&(r=arguments[1]||{},a+=1),t=arguments[a],"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),"collate"in r||(r.collate=!1),r.collate){var i=[],o=t;t=function(e,n){if(e)return o(e);if(null!==n){for(var t in i)if(l(i[t],n))return;i.push(n)}else"format"in r&&(i=i.sort().join("")),o(null,i)}}if("format"in r){if("application/nquads"!==r.format)throw new bn("Unknown output format.","jsonld.UnknownFormat",{format:r.format});var s=t;t=function(e,n){return e?s(e):(null!==n&&(n=W(n)),void s(null,n))}}n.expand(e,r,function(e,n){if(e)return t(new bn("Could not expand input before conversion to RDF.","jsonld.RdfError",{cause:e}));try{var r=new nn("_:b");(new wn).toRDF(n,r,null,null,null,t)}catch(a){t(a)}})},n.relabelBlankNodes=function(e){r(new nn("_:b",e))},n.loadContext=function(e,n){return n(new bn("Could not retrieve @context URL. URL derefencing not implemented.","jsonld.ContextUrlError"),e)},n.ContextCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=18e5},n.ContextCache.prototype.get=function(e){if(e in this.cache){var n=this.cache[e];if(n.expires>=+new Date)return n.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},n.ContextCache.prototype.set=function(e,n){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:n,expires:+new Date+this.expires}},n.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},n.ActiveContextCache.prototype.get=function(e,n){var t=JSON.stringify(e),r=JSON.stringify(n),a=this.cache[t];return a&&r in a?a[r].share():null},n.ActiveContextCache.prototype.set=function(e,n,t){if(this.order.length===this.size){var r=this.order.shift();delete this.cache[r.activeCtx][r.localCtx]}var a=JSON.stringify(e),i=JSON.stringify(n);this.order.push({activeCtx:a,localCtx:i}),a in this.cache||(this.cache[a]={}),this.cache[a][i]=t},n.cache={activeCtx:new n.ActiveContextCache},n.contextLoaders={},n.contextLoaders.jquery=function(e,t){t=t||{};var r=new n.ContextCache;return function(n,a){if(t.secure&&0!==n.indexOf("https"))return a(new bn('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{url:n}),n);var i=r.get(n);return null!==i?a(null,n,i):void e.ajax({url:n,dataType:"json",crossDomain:!0,success:function(e){r.set(n,e),a(null,n,e)
},error:function(e,t,r){a(new bn("URL could not be dereferenced, an error occurred.","jsonld.LoadContextError",{url:n,cause:r}),n)}})}},n.contextLoaders.node=function(e){function t(n,l,s){if(e.secure&&0!==n.indexOf("https"))return s(new bn('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{url:n}),n);var u=o.get(n);return null!==u?s(null,n,u):void a({url:n,strictSSL:!0,followRedirect:!1},function(e,a,u){if(e)return s(new bn("URL could not be dereferenced, an error occurred.","jsonld.LoadContextError",{url:n,cause:e}),n);var f=i.STATUS_CODES[a.statusCode];if(a.statusCode>=400)return s(new bn("URL could not be dereferenced: "+f,"jsonld.InvalidUrl",{url:n,httpStatusCode:a.statusCode}),n);if(a.statusCode>=300&&a.statusCode<400&&a.headers.location)return l.length===r?s(new bn("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{url:n,httpStatusCode:a.statusCode,redirects:l}),n):-1!==l.indexOf(n)?s(new bn("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{url:n,httpStatusCode:a.statusCode,redirects:l}),n):(l.push(n),t(a.headers.location,l,s));l.push(n);for(var c=0;c<l.length;++c)o.set(l[c],u);s(e,n,u)})}e=e||{};var r="maxRedirects"in e?e.maxRedirects:-1,a=require("request"),i=require("http"),o=new n.ContextCache;return function(e,n){t(e,[],n)}},n.useContextLoader=function(e){if(!(e in n.contextLoaders))throw new bn('Unknown @context loader type: "'+e+'"',"jsonld.UnknownContextLoader",{type:e});n.loadContext=n.contextLoaders[e].apply(n,Array.prototype.slice.call(arguments,1))},n.processContext=function(e,t){var r={},a=2;arguments.length>3&&(r=arguments[2]||{},a+=1);var i=arguments[a];return"base"in r||(r.base=""),"loadContext"in r||(r.loadContext=n.loadContext),null===t?i(null,D(r)):(t=$(t),!R(t)||"@context"in t||(t={"@context":t}),void Q(t,r,function(n,t){if(n)return i(n);try{t=(new wn).processContext(e,t,r),i(null,t)}catch(a){i(a)}}))},n.hasProperty=function(e,n){var t=!1;if(n in e){var r=e[n];t=!_(r)||r.length>0}return t},n.hasValue=function(e,t,r){var a=!1;if(n.hasProperty(e,t)){var i=e[t],o=X(i);if(_(i)||o){o&&(i=i["@list"]);for(var l in i)if(n.compareValues(r,i[l])){a=!0;break}}else _(r)||(a=n.compareValues(r,i))}return a},n.addValue=function(e,t,r,a){if(a=a||{},"propertyIsArray"in a||(a.propertyIsArray=!1),"allowDuplicate"in a||(a.allowDuplicate=!0),_(r)){0!==r.length||!a.propertyIsArray||t in e||(e[t]=[]);for(var i in r)n.addValue(e,t,r[i],a)}else if(t in e){var o=!a.allowDuplicate&&n.hasValue(e,t,r);_(e[t])||o&&!a.propertyIsArray||(e[t]=[e[t]]),o||e[t].push(r)}else e[t]=a.propertyIsArray?[r]:r},n.getValues=function(e,n){var t=e[n]||[];return _(t)||(t=[t]),t},n.removeProperty=function(e,n){delete e[n]},n.removeValue=function(e,t,r,a){a=a||{},"propertyIsArray"in a||(a.propertyIsArray=!1);var i=n.getValues(e,t).filter(function(e){return!n.compareValues(e,r)});0===i.length?n.removeProperty(e,t):e[t]=1!==i.length||a.propertyIsArray?i:i[0]},n.compareValues=function(e,t){if(e===t)return!0;if(G(e)&&G(t)&&e["@value"]===t["@value"]&&e["@type"]===t["@type"]&&e["@language"]===t["@language"]&&e["@index"]===t["@index"])return!0;if(X(e)&&X(t)){if(e["@index"]!==t["@index"])return!1;var r=e["@list"],a=t["@list"];if(r.length!==a.length)return!1;for(var i=0;i<r.length;++i)if(!n.compareValues(r[i],a[i]))return!1;return!0}return R(e)&&"@id"in e&&R(t)&&"@id"in t?e["@id"]===t["@id"]:!1},n.getContextValue=function(e,n,t){var r=null;if(null===n)return r;if("@language"===t&&t in e&&(r=e[t]),e.mappings[n]){var a=e.mappings[n];M(t)?r=a:t in a&&(r=a[t])}return r};var rn={};if(n.registerRDFParser=function(e,n){rn[e]=n},n.unregisterRDFParser=function(e){delete rn[e]},e){if("undefined"==typeof an)var an=null;if("undefined"==typeof on)var on={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var ln="http://www.w3.org/2001/XMLSchema#boolean",sn="http://www.w3.org/2001/XMLSchema#double",un="http://www.w3.org/2001/XMLSchema#integer",fn="http://www.w3.org/2001/XMLSchema#string",cn="http://www.w3.org/1999/02/22-rdf-syntax-ns#",pn=cn+"first",dn=cn+"rest",vn=cn+"nil",hn=cn+"type",gn=cn+"PlainLiteral",mn=cn+"XMLLiteral",yn=cn+"object",xn=10,bn=function(n,t,r){e&&(Error.call(this),Error.captureStackTrace(this,this.constructor)),this.name=t||"jsonld.Error",this.message=n||"An unspecified JSON-LD error occurred.",this.details=r||{}};e&&require("util").inherits(bn,Error);var wn=function(){};wn.prototype.compact=function(e,t,r,a){if(_(r)){var i=[];for(var o in r){var l=this.compact(e,t,r[o],a);null!==l&&i.push(l)}if(1===i.length){var s=n.getContextValue(e,t,"@container");null===s&&(i=i[0])}return i}if(R(r)){if(G(r)||P(r))return C(e,t,r);var u={};for(var f in r)u[f]=_(r[f])?r[f].slice():r[f];r=u;for(var c=Object.keys(r).sort(),i={},p=0;p<c.length;++p){var f=c[p];if(f in r){var d=r[f];if("@id"!==f&&"@type"!==f)if("@index"!==f){if(0===d.length){var v=O(e,f,d,{vocab:!0},r);n.addValue(i,v,d,{propertyIsArray:!0})}for(var h=0;h<d.length;++h){var g=d[h],v=O(e,f,g,{vocab:!0},r),s=n.getContextValue(e,v,"@container"),m=e.mappings[v];m&&m.propertyGenerator&&I(e,r,f,g,v,!0);var y=X(g),x=null;y&&(x=g["@list"]);var b=this.compact(e,v,y?x:g,a);if(y)if(_(b)||(b=[b]),"@list"!==s){var w={};w[O(e,"@list")]=b,b=w,"@index"in g&&(b[O(e,"@index")]=g["@index"])}else if(v in i)throw new bn('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError");if("@language"===s||"@index"===s){var j;v in i?j=i[v]:i[v]=j={},"@language"===s&&G(b)&&(b=b["@value"]),n.addValue(j,g[s],b)}else{var N="@set"===s||"@list"===s||_(b)&&0===b.length||"@list"===f||"@graph"===f;n.addValue(i,v,b,{propertyIsArray:N})}}}else{var s=n.getContextValue(e,t,"@container");if("@index"===s)continue;var S=O(e,f);n.addValue(i,S,d)}else{var E;if(J(d))E=O(e,d,null,{vocab:"@type"===f});else{E=[];for(var h=0;h<d.length;++h)E.push(O(e,d[h],null,{vocab:!0}))}var S=O(e,f),N=_(E)&&0===d.length;n.addValue(i,S,E,{propertyIsArray:N})}}}return i}return r},wn.prototype.expand=function(e,i,o,l,s){var u=this;if("undefined"==typeof o)throw new bn("Invalid JSON-LD syntax; undefined element.","jsonld.SyntaxError");if(null===o)return null;if(_(o)){var f=[];for(var c in o){var p=u.expand(e,i,o[c],l,s);if(s&&(_(p)||X(p)))throw new bn("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError");null!==p&&(_(p)?f=f.concat(p):f.push(p))}return f}if(R(o)){"@context"in o&&(e=u.processContext(e,o["@context"],l));for(var d=E(e,i,{vocab:!0}),f={},v=Object.keys(o).sort(),h=0;h<v.length;++h){var g,m,y=v[h],x=o[y];if("@context"!==y){var b=e.mappings[y];if(g=b&&b.propertyGenerator?b["@id"]:E(e,y,{vocab:!0}),null!==g&&(_(g)||Y(g)||L(g))){if("@id"===g&&!J(x))throw new bn('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{value:x});if("@type"===g&&A(x),"@graph"===g&&!R(x)&&!_(x))throw new bn('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{value:x});if("@value"===g&&(R(x)||_(x)))throw new bn('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{value:x});if("@language"===g){if(!J(x))throw new bn('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{value:x});x=x.toLowerCase()}if("@index"===g&&!J(x))throw new bn('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{value:x});var w=n.getContextValue(e,y,"@container");if("@language"===w&&R(x))m=t(x);else if("@index"===w&&R(x))m=function(n){for(var t=[],r=Object.keys(x).sort(),a=0;a<r.length;++a){var i=r[a],o=x[i];_(o)||(o=[o]),o=u.expand(e,n,o,l,!1);for(var s=0;s<o.length;++s){var f=o[s];"@index"in f||(f["@index"]=i),t.push(f)}}return t}(y);else{var j="@list"===g;if(j||"@set"===g){var N=i;if(j&&"@graph"===d&&(N=null),m=u.expand(e,N,x,l,j),j&&X(m))throw new bn("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError")}else m=u.expand(e,y,x,l,!1)}if(null!==m||"@value"===g)if("@list"===g||X(m)||"@list"!==w||(m=_(m)?m:[m],m={"@list":m}),_(g)){m=r(e.namer,m);for(var c=0;c<g.length;++c)n.addValue(f,g[c],$(m),{propertyIsArray:!0})}else{var O=-1===["@index","@id","@type","@value","@language"].indexOf(g);n.addValue(f,g,m,{propertyIsArray:O})}}}}v=Object.keys(f);var C=v.length;if("@value"in f){if("@type"in f&&"@language"in f)throw new bn('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{element:f});var I=C-1;if("@type"in f&&(I-=1),"@index"in f&&(I-=1),"@language"in f&&(I-=1),0!==I)throw new bn('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{element:f});null===f["@value"]?f=null:"@language"in f&&!J(f["@value"])&&delete f["@language"]}else if("@type"in f&&!_(f["@type"]))f["@type"]=[f["@type"]];else if("@set"in f||"@list"in f){if(C>1&&2!==C&&"@index"in f)throw new bn('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{element:f});"@set"in f&&(f=f["@set"],v=Object.keys(f),C=v.length)}else 1===C&&"@language"in f&&(f=null);if(R(f)&&!l.keepFreeFloatingNodes&&!s&&(null===i||"@graph"===d))if(0===C||"@value"in f)f=null;else{for(var S=!1,V=["@graph","@type"],h=0;!S&&h<v.length;++h)L(v[h])&&-1===V.indexOf(v[h])||(S=!0);S||(f=null)}return f}return s||null!==i&&"@graph"!==E(e,i,{vocab:!0})?a(e,i,o):null},wn.prototype.flatten=function(e){var n=new nn("_:b"),t={"@default":{}};p(e,t,"@default",n);for(var r=t["@default"],a=Object.keys(t).sort(),i=0;i<a.length;++i){var o=a[i];if("@default"!==o){var l=t[o],s=r[o];s?"@graph"in s||(s["@graph"]=[]):r[o]=s={"@id":o,"@graph":[]};for(var u=s["@graph"],f=Object.keys(l).sort(),c=0;c<f.length;++c){var d=f[c];u.push(l[d])}}}for(var v=[],h=Object.keys(r).sort(),g=0;g<h.length;++g){var m=h[g];v.push(r[m])}return v},wn.prototype.frame=function(e,n,t){var r={options:t,graphs:{"@default":{},"@merged":{}}};namer=new nn("_:b"),p(e,r.graphs,"@merged",namer),r.subjects=r.graphs["@merged"];var a=[];return d(r,Object.keys(r.subjects).sort(),n,a,null),a},wn.prototype.normalize=function(e,n,t){function r(e,n){if(e)return t(e);if(null===n)return d=new nn("_:c14n"),a(Object.keys(p));for(var r in c)if(l(c[r],n))return;c.push(n);var i=["subject","object","name"];for(var o in i){var s=i[o];if(n[s]&&"BlankNode"===n[s].interfaceName){var u=n[s].nominalValue;u in p?p[u].statements.push(n):p[u]={statements:[n]}}}}function a(e){function n(o){if(o===e.length)return i(a,r,t);var l=e[o],s=u(l,p,d);s in r?(r[s].push(l),t.push(l)):s in a?(r[s]=[a[s],l],t.push(a[s]),t.push(l),delete a[s]):a[s]=l,setTimeout(function(){n(o+1)},0)}var t=[],r={},a={};setTimeout(function(){n(0)},0)}function i(e,n,t){var r=!1,i=Object.keys(e).sort();for(var l in i){var s=e[i[l]];d.getName(s),r=!0}r?a(t):o(n)}function o(e){function n(a){function i(e,r){if(r===e.length){l.sort(function(e,n){return e=e.hash,n=n.hash,n>e?-1:e>n?1:0});for(var o in l)for(var s in l[o].pathNamer.existing)d.getName(s);return n(a+1)}var u=e[r];if(d.isNamed(u))return i(e,r+1);var c=new nn("_:b");c.getName(u),f(u,p,d,c,function(n,a){return n?t(n):(l.push(a),void i(e,r+1))})}if(a===r.length)return s();var o=e[r[a]],l=[];i(o,0)}var r=Object.keys(e).sort();n(0)}function s(){var e=[];for(var r in c){var a=c[r],i=["subject","object","name"];for(var o in i){var l=i[o];a[l]&&"BlankNode"===a[l].interfaceName&&0!==a[l].nominalValue.indexOf("_:c14n")&&(a[l].nominalValue=d.getName(a[l].nominalValue))}e.push(W(a))}return e.sort(),"format"in n?"application/nquads"===n.format?t(null,e.join("")):t(new bn("Unknown output format.","jsonld.UnknownFormat",{format:n.format})):void t(null,K(e.join("")))}var c=[],p={},d=new nn("_:b");(new wn).toRDF(e,d,null,null,null,r)},wn.prototype.fromRDF=function(e,t,r){var a={subjects:{},listMap:{}},i={"":a};for(var l in e){var s,u=e[l],f=u.subject.nominalValue,c=u.property.nominalValue,p=u.object,d="name"in u?u.name.nominalValue:"";if(s=d in i?i[d]:i[d]={subjects:{},listMap:{}},c!==pn){if(c!==dn){""===d||d in a.subjects||(a.subjects[d]={"@id":d});var v,h=s.subjects;if(v=f in h?h[f]:h[f]={"@id":f},c!==hn||t.useRdfType){var g=o(p,t.useNativeTypes);if(n.addValue(v,c,g,{propertyIsArray:!0}),"BlankNode"===p.interfaceName){var m,y=g["@id"],x=s.listMap;m=y in x?x[y]:x[y]={},m.head=g}}else n.addValue(v,"@type",p.nominalValue,{propertyIsArray:!0})}else if("BlankNode"===p.interfaceName){var m,x=s.listMap;m=f in x?x[f]:x[f]={},m.rest=p.nominalValue}}else{var m,x=s.listMap;m=f in x?x[f]:x[f]={},m.first=o(p,t.useNativeTypes)}}for(var d in i){var s=i[d],x=s.listMap;for(var b in x){var m=x[b];if("head"in m&&"first"in m){delete m.head["@id"];for(var w=m.head["@list"]=[m.first];"rest"in m;){var j=m.rest;if(m=x[j],!("first"in m))throw new bn("Invalid RDF list entry.","jsonld.RdfError",{bnode:j});w.push(m.first)}}}}var N=[],h=a.subjects,O=Object.keys(h).sort();for(var l in O){var y=O[l],b=h[y];if(N.push(b),y in i){var s=b["@graph"]=[],C=i[y].subjects,I=Object.keys(C).sort();for(var S in I)s.push(C[I[S]])}}r(null,N)},wn.prototype.toRDF=function(e,n,t,r,a,o){i(e,n,t,r,a,o),o(null,null)},wn.prototype.processContext=function(e,t,r){var a=null;if(n.cache.activeCtx&&(a=n.cache.activeCtx.get(e,t)))return a.namer=e.namer,a;a=e.clone(),R(t)&&"@context"in t&&_(t["@context"])&&(t=t["@context"]);var i=_(t)?t:[t];for(var o in i){var l=i[o];if(null!==l){if(R(l)&&"@context"in l&&(l=l["@context"]),!R(l))throw new bn("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{context:l});var s={};if("@vocab"in l){var u=l["@vocab"];if(null===u)delete a["@vocab"];else{if(!J(u))throw new bn('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{context:l});if(!Y(u))throw new bn('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{context:l});a["@vocab"]=u}s["@vocab"]=!0}if("@language"in l){var u=l["@language"];if(null===u)delete a["@language"];else{if(!J(u))throw new bn('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{context:l});a["@language"]=u.toLowerCase()}s["@language"]=!0}for(var f in l)S(a,l,f,s)}else a=D(r),a.namer=e.namer}return n.cache.activeCtx&&n.cache.activeCtx.set(e,t,a),a},Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var n=[];for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);return n}),n.registerRDFParser("application/nquads",K),n.registerRDFParser("rdfa-api",en),nn.prototype.clone=function(){var e=new nn(this.prefix);return e.counter=this.counter,e.existing=$(this.existing),e},nn.prototype.getName=function(e){if(e&&e in this.existing)return this.existing[e];var n=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=n),n},nn.prototype.isNamed=function(e){return e in this.existing},Permutator=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var n in e)this.left[e[n]]=!0},Permutator.prototype.hasNext=function(){return!this.done},Permutator.prototype.next=function(){for(var e=this.list.slice(),n=null,t=0,r=this.list.length,a=0;r>a;++a){var i=this.list[a],o=this.left[i];(null===n||i>n)&&(o&&a>0&&i>this.list[a-1]||!o&&r-1>a&&i>this.list[a+1])&&(n=i,t=a)}if(null===n)this.done=!0;else{var l=this.left[n]?t-1:t+1;this.list[t]=this.list[l],this.list[l]=n;for(var a=0;r>a;++a)this.list[a]>n&&(this.left[this.list[a]]=!this.left[this.list[a]])}return e};var jn=n.sha1={};if(e){var Nn=require("crypto");jn.create=function(){var e=Nn.createHash("sha1");return{update:function(n){e.update(n,"utf8")},digest:function(){return e.digest("hex")}}}}else jn.create=function(){return new jn.MessageDigest};if(jn.hash=function(e){var n=jn.create();for(var t in e)n.update(e[t]);return n.digest()},!e){jn.Buffer=function(){this.data="",this.read=0},jn.Buffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},jn.Buffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},jn.Buffer.prototype.bytes=function(){return this.data.slice(this.read)},jn.Buffer.prototype.length=function(){return this.data.length-this.read},jn.Buffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},jn.Buffer.prototype.toHex=function(){for(var e="",n=this.read;n<this.data.length;++n){var t=this.data.charCodeAt(n);16>t&&(e+="0"),e+=t.toString(16)}return e},jn.MessageDigest=function(){On.initialized||On.init(),this.blockLength=64,this.digestLength=20,this.messageLength=0,this.input=new jn.Buffer,this.words=new Array(80),this.state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}},jn.MessageDigest.prototype.update=function(e){e=unescape(encodeURIComponent(e)),this.messageLength+=e.length,this.input.data+=e,On.update(this.state,this.words,this.input),(this.input.read>2048||0===this.input.length())&&this.input.compact()},jn.MessageDigest.prototype.digest=function(){var e=this.messageLength,n=new jn.Buffer;n.data+=this.input.bytes(),n.data+=On.padding.substr(0,64-(e+8)%64),n.putInt32(e>>>29&255),n.putInt32(e<<3&4294967295),On.update(this.state,this.words,n);var t=new jn.Buffer;return t.putInt32(this.state.h0),t.putInt32(this.state.h1),t.putInt32(this.state.h2),t.putInt32(this.state.h3),t.putInt32(this.state.h4),t.toHex()};var On={padding:null,initialized:!1};On.init=function(){On.padding=String.fromCharCode(128);for(var e=String.fromCharCode(0),n=64;n>0;)1&n&&(On.padding+=e),n>>>=1,n>0&&(e+=e);On.initialized=!0},On.update=function(e,n,t){for(var r,a,i,o,l,s,u,f,c=t.length();c>=64;){for(a=e.h0,i=e.h1,o=e.h2,l=e.h3,s=e.h4,f=0;16>f;++f)r=t.getInt32(),n[f]=r,u=l^i&(o^l),r=(a<<5|a>>>27)+u+s+1518500249+r,s=l,l=o,o=i<<30|i>>>2,i=a,a=r;for(;20>f;++f)r=n[f-3]^n[f-8]^n[f-14]^n[f-16],r=r<<1|r>>>31,n[f]=r,u=l^i&(o^l),r=(a<<5|a>>>27)+u+s+1518500249+r,s=l,l=o,o=i<<30|i>>>2,i=a,a=r;for(;32>f;++f)r=n[f-3]^n[f-8]^n[f-14]^n[f-16],r=r<<1|r>>>31,n[f]=r,u=i^o^l,r=(a<<5|a>>>27)+u+s+1859775393+r,s=l,l=o,o=i<<30|i>>>2,i=a,a=r;for(;40>f;++f)r=n[f-6]^n[f-16]^n[f-28]^n[f-32],r=r<<2|r>>>30,n[f]=r,u=i^o^l,r=(a<<5|a>>>27)+u+s+1859775393+r,s=l,l=o,o=i<<30|i>>>2,i=a,a=r;for(;60>f;++f)r=n[f-6]^n[f-16]^n[f-28]^n[f-32],r=r<<2|r>>>30,n[f]=r,u=i&o|l&(i^o),r=(a<<5|a>>>27)+u+s+2400959708+r,s=l,l=o,o=i<<30|i>>>2,i=a,a=r;for(;80>f;++f)r=n[f-6]^n[f-16]^n[f-28]^n[f-32],r=r<<2|r>>>30,n[f]=r,u=i^o^l,r=(a<<5|a>>>27)+u+s+3395469782+r,s=l,l=o,o=i<<30|i>>>2,i=a,a=r;e.h0+=a,e.h1+=i,e.h2+=o,e.h3+=l,e.h4+=s,c-=64}}}if(n.url={},e)n.url.parse=require("url").parse;else{var Cn={};Cn.options={key:["href","protocol","host","userInfo","user","password","hostname","port","relative","path","directory","file","query","hash"],parser:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/},n.url.parse=function(e){for(var n=Cn.options,t=n.parser.exec(e),r={},a=14;a--;)r[n.key[a]]=t[a]||"";return r.host&&""===r.path&&(r.path="/"),r.pathname=r.path,r.query&&(r.path=r.path+"?"+r.query),r.protocol+=":",r.hash&&(r.hash="#"+r.hash),r}}return e&&n.useContextLoader("node"),n},r=function(){return t(function(){return r()})};t(r),e?module.exports=r:"function"==typeof define&&define.amd?define("jsonld",[],function(){return r}):n&&(window.jsonld=window.jsonld||r)}();