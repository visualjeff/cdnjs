!function(){var e="undefined"!=typeof process&&process.versions&&process.versions.node,t=!e&&("undefined"!=typeof window||"undefined"!=typeof self);t&&"undefined"==typeof global&&("undefined"!=typeof window?global=window:"undefined"!=typeof self?global=self:"undefined"!=typeof $&&(global=$));var n=function(n){function r(){}function a(e){for(var t=[],n=Object.keys(e).sort(),r=0;r<n.length;++r){var a=n[r],o=e[a];V(o)||(o=[o]);for(var i=0;i<o.length;++i){var l=o[i];if(!q(l))throw new Ct("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});t.push({"@value":l,"@language":a.toLowerCase()})}}return t}function o(e,t){if(V(t))for(var n=0;n<t.length;++n)t[n]=o(e,t[n]);else if(Q(t))t["@list"]=o(e,t["@list"]);else if(_(t)){Z(t)&&(t["@id"]=e.getName(t["@id"]));for(var r=Object.keys(t).sort(),a=0;a<r.length;++a){var i=r[a];"@id"!==i&&(t[i]=o(e,t[i]))}}return t}function i(e,t,r){if(null===r||void 0===r)return null;var a=R(e,t,{vocab:!0});if("@id"===a)return R(e,r,{base:!0});if("@type"===a)return R(e,r,{vocab:!0,base:!0});var o=n.getContextValue(e,t,"@type");if("@id"===o||"@graph"===a&&q(r))return{"@id":R(e,r,{base:!0})};if("@vocab"===o)return{"@id":R(e,r,{vocab:!0,base:!0})};if(A(a))return r;var i={};if(null!==o)i["@type"]=o;else if(q(r)){var l=n.getContextValue(e,t,"@language");null!==l&&(i["@language"]=l)}return-1===["boolean","number","string"].indexOf(typeof r)&&(r=r.toString()),i["@value"]=r,i}function l(e,t,n){for(var r=[],a=Object.keys(e).sort(),o=0;o<a.length;++o)for(var i=a[o],l=e[i],c=Object.keys(l).sort(),d=0;d<c.length;++d){var f=c[d],p=l[f];if("@type"===f)f=Ot;else if(A(f))continue;for(var v=0;v<p.length;++v){var h=p[v],g={};if(g.type=0===i.indexOf("_:")?"blank node":"IRI",g.value=i,K(i)){var m={};if(m.type=0===f.indexOf("_:")?"blank node":"IRI",m.value=f,K(f)&&("blank node"!==m.type||n.produceGeneralizedRdf))if(Q(h))u(h["@list"],t,g,m,r);else{var y=s(h);y&&r.push({subject:g,predicate:m,object:y})}}}}return r}function u(e,t,n,r,a){for(var o={type:"IRI",value:bt},i={type:"IRI",value:wt},l={type:"IRI",value:jt},u=0;u<e.length;++u){var c=e[u],d={type:"blank node",value:t.getName()};a.push({subject:n,predicate:r,object:d}),n=d,r=o;var f=s(c);f&&a.push({subject:n,predicate:r,object:f}),r=i}a.push({subject:n,predicate:r,object:l})}function s(e){var t={};if(Y(e)){t.type="literal";var n=e["@value"],r=e["@type"]||null;B(n)?(t.value=n.toString(),t.datatype=r||vt):z(n)||r===ht?(t.value=n.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),t.datatype=r||ht):M(n)?(t.value=n.toFixed(0),t.datatype=r||gt):"@language"in e?(t.value=n,t.datatype=r||Et,t.language=e["@language"]):(t.value=n,t.datatype=r||mt)}else{var a=_(e)?e["@id"]:e;t.type=0===a.indexOf("_:")?"blank node":"IRI",t.value=a}return"IRI"!==t.type||K(t.value)?t:null}function c(e,t){if("IRI"===e.type||"blank node"===e.type)return{"@id":e.value};var n={"@value":e.value};if(e.language)n["@language"]=e.language;else{var r=e.datatype;if(r||(r=mt),t){if(r===vt)"true"===n["@value"]?n["@value"]=!0:"false"===n["@value"]&&(n["@value"]=!1);else if(H(n["@value"]))if(r===gt){var a=parseInt(n["@value"],10);a.toFixed(0)===n["@value"]&&(n["@value"]=a)}else r===ht&&(n["@value"]=parseFloat(n["@value"]));-1===[vt,gt,ht,mt].indexOf(r)&&(n["@type"]=r)}else r!==mt&&(n["@type"]=r)}return n}function d(e,t){for(var n=["subject","predicate","object"],r=0;r<n.length;++r){var a=n[r];if(e[a].type!==t[a].type||e[a].value!==t[a].value)return!1}return e.object.language!==t.object.language?!1:e.object.datatype!==t.object.datatype?!1:!0}function f(e,t){if("hash"in t[e])return t[e].hash;for(var n=t[e].quads,r=[],a=0;a<n.length;++a)r.push(at(n[a],n[a].name?n[a].name.value:null,e));r.sort();var o=t[e].hash=Ut.hash(r);return o}function p(e,t,r,a,o){function i(o){if(o===d.length)return u=Object.keys(c).sort(),l(0);var s=d[o],p=v(s.subject,e),h=null;if(null!==p?h="p":(p=v(s.object,e),null!==p&&(h="r")),null!==p){var g;g=r.isNamed(p)?r.getName(p):a.isNamed(p)?a.getName(p):f(p,t);var m=Ut.create();m.update(h),m.update(s.predicate.value),m.update(g);var y=m.digest();y in c?c[y].push(p):c[y]=[p]}n.setImmediate(function(){i(o+1)})}function l(e){function i(){function u(e){if(e===y.length)return c(!1);var n=y[e];p(n,t,r,g,function(t,r){return t?o(t):(m+=g.getName(n)+"<"+r.hash+">",g=r.pathNamer,null!==f&&m.length>=f.length&&m>f?c(!0):void u(e+1))})}function c(t){!t&&(null===f||f>m)&&(f=m,v=g),h.hasNext()?n.setImmediate(function(){i()}):(s.update(f),a=v,l(e+1))}var d=h.next(),g=a.clone(),m="",y=[];for(var x in d){var b=d[x];if(r.isNamed(b)?m+=r.getName(b):(g.isNamed(b)||y.push(b),m+=g.getName(b)),null!==f&&m.length>=f.length&&m>f)return c(!0)}u(0)}if(e===u.length)return o(null,{hash:s.digest(),pathNamer:a});var d=u[e];s.update(d);var f=null,v=null,h=new Rt(c[d]);n.setImmediate(function(){i()})}var u,s=Ut.create(),c={},d=t[e].quads;n.setImmediate(function(){i(0)})}function v(e,t){return"blank node"===e.type&&e.value!==t?e.value:null}function h(e,t,r,a,o,i){if(V(e))for(var l=0;l<e.length;++l)h(e[l],t,r,a,void 0,i);else{if(!_(e))return void(i&&i.push(e));if(Y(e)){if("@type"in e){var u=e["@type"];0===u.indexOf("_:")&&(e["@type"]=u=a.getName(u))}return void(i&&i.push(e))}if("@type"in e)for(var s=e["@type"],l=0;l<s.length;++l){var u=s[l];0===u.indexOf("_:")&&a.getName(u)}X(o)&&(o=Z(e)?a.getName(e["@id"]):e["@id"]),i&&i.push({"@id":o});var c=t[r],d=c[o]=c[o]||{};d["@id"]=o;for(var f=Object.keys(e).sort(),p=0;p<f.length;++p){var v=f[p];if("@id"!==v)if("@reverse"!==v)if("@graph"!==v)if("@type"!==v&&A(v)){if("@index"===v&&"@index"in d)throw new Ct("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:d});d[v]=e[v]}else{var g=e[v];if(0===v.indexOf("_:")&&(v=a.getName(v)),0!==g.length)for(var m=0;m<g.length;++m){var y=g[m];if("@type"===v&&(y=0===y.indexOf("_:")?a.getName(y):y),$(y)||G(y)){var x=Z(y)?a.getName(y["@id"]):y["@id"];n.addValue(d,v,{"@id":x},{propertyIsArray:!0,allowDuplicate:!1}),h(y,t,r,a,x)}else if(Q(y)){var b=[];h(y["@list"],t,r,a,o,b),y={"@list":b},n.addValue(d,v,y,{propertyIsArray:!0,allowDuplicate:!1})}else h(y,t,r,a,o),n.addValue(d,v,y,{propertyIsArray:!0,allowDuplicate:!1})}else n.addValue(d,v,[],{propertyIsArray:!0})}else{o in t||(t[o]={});var w="@merged"===r?r:o;h(e[v],t,w,a)}else{var j={"@id":o},O=e["@reverse"];for(var I in O)for(var L=O[I],S=0;S<L.length;++S){var E=L[S],N=E["@id"];Z(E)&&(N=a.getName(N)),h(E,t,r,a,N),n.addValue(c[N],I,j,{propertyIsArray:!0,allowDuplicate:!1})}}}}}function g(e){for(var t=e["@default"],n=Object.keys(e).sort(),r=0;r<n.length;++r){var a=n[r];if("@default"!==a){var o=e[a],i=t[a];i?"@graph"in i||(i["@graph"]=[]):t[a]=i={"@id":a,"@graph":[]};for(var l=i["@graph"],u=Object.keys(o).sort(),s=0;s<u.length;++s){var c=o[u[s]];G(c)||l.push(c)}}}return t}function m(e,t,n,r,a){w(n),n=n[0];var o=e.options,i={embed:b(n,o,"embed"),explicit:b(n,o,"explicit"),requireAll:b(n,o,"requireAll")},l=j(e,t,n,i),u=Object.keys(l).sort();for(var s in u){var c=u[s],d=l[c];null===a&&(e.uniqueEmbeds={});var f={};if(f["@id"]=c,"@never"===i.embed||x(d,e.subjectStack))L(r,a,f);else{"@last"===i.embed&&(c in e.uniqueEmbeds&&I(e,c),e.uniqueEmbeds[c]={parent:r,property:a}),e.subjectStack.push(d);for(var p=Object.keys(d).sort(),v=0;v<p.length;v++){var h=p[v];if(A(h))f[h]=W(d[h]);else if(!i.explicit||h in n)for(var g=d[h],O=0;O<g.length;++O){var S=g[O];if(Q(S)){var E={"@list":[]};L(f,h,E);var N=S["@list"];for(var k in N)if(S=N[k],G(S)){var C=h in n?n[h][0]["@list"]:y(i);m(e,[S["@id"]],C,E,"@list")}else L(E,"@list",W(S))}else if(G(S)){var C=h in n?n[h]:y(i);m(e,[S["@id"]],C,f,h)}else L(f,h,W(S))}}for(var p=Object.keys(n).sort(),v=0;v<p.length;++v){var h=p[v];if(!A(h)){var D=n[h][0],R=b(D,o,"omitDefault");if(!(R||h in f)){var U="@null";"@default"in D&&(U=W(D["@default"])),V(U)||(U=[U]),f[h]=[{"@preserve":U}]}}}L(r,a,f),e.subjectStack.pop()}}}function y(e){var t={};for(var n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function x(e,t){for(var n=t.length-1;n>=0;--n)if(t[n]["@id"]===e["@id"])return!0;return!1}function b(e,t,n){var r="@"+n,a=r in e?e[r][0]:t[n];return"embed"===n&&(a===!0?a="@last":a===!1?a="@never":"@always"!==a&&"@never"!==a&&(a="@last")),a}function w(e){if(!V(e)||1!==e.length||!_(e[0]))throw new Ct("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function j(e,t,n,r){for(var a={},o=0;o<t.length;++o){var i=t[o],l=e.subjects[i];O(l,n,r)&&(a[i]=l)}return a}function O(e,t,r){if("@type"in t&&(1!==t["@type"].length||!_(t["@type"][0]))){for(var a=t["@type"],o=0;o<a.length;++o)if(n.hasValue(e,"@type",a[o]))return!0;return!1}var i=!0,l=!1;for(var u in t){if(A(u)){if("@id"!==u&&"@type"!==u)continue;if(i=!1,"@id"===u&&q(t[u])){if(e[u]!==t[u])return!1;l=!0;continue}}if(i=!1,u in e){if(V(t[u])&&0===t[u].length&&void 0!==e[u])return!1;l=!0}else{var s=V(t[u])&&_(t[u][0])&&"@default"in t[u][0];if(r.requireAll&&!s)return!1}}return i||l}function I(e,t){var r=e.uniqueEmbeds,a=r[t],o=a.parent,i=a.property,l={"@id":t};if(V(o)){for(var u=0;u<o.length;++u)if(n.compareValues(o[u],l)){o[u]=l;break}}else{var s=V(o[i]);n.removeValue(o,i,l,{propertyIsArray:s}),n.addValue(o,i,l,{propertyIsArray:s})}var c=function(e){for(var t=Object.keys(r),n=0;n<t.length;++n){var a=t[n];a in r&&_(r[a].parent)&&r[a].parent["@id"]===e&&(delete r[a],c(a))}};c(t)}function L(e,t,r){_(e)?n.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function S(e,t,r){if(V(t)){for(var a=[],o=0;o<t.length;++o){var i=S(e,t[o],r);null!==i&&a.push(i)}t=a}else if(_(t)){if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(Y(t))return t;if(Q(t))return t["@list"]=S(e,t["@list"],r),t;for(var l in t){var i=S(e,t[l],r),u=n.getContextValue(e,l,"@container");r.compactArrays&&V(i)&&1===i.length&&null===u&&(i=i[0]),t[l]=i}}return t}function E(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:t>e?-1:1}function N(e,t,n,r,a,o){null===o&&(o="@null");var i=[];if("@id"!==o&&"@reverse"!==o||!G(n))i.push(o);else{"@reverse"===o&&i.push("@reverse");var l=k(e,n["@id"],null,{vocab:!0});l in e.mappings&&e.mappings[l]&&e.mappings[l]["@id"]===n["@id"]?i.push.apply(i,["@vocab","@id"]):i.push.apply(i,["@id","@vocab"])}i.push("@none");for(var u=e.inverse[t],s=0;s<r.length;++s){var c=r[s];if(c in u)for(var d=u[c][a],f=0;f<i.length;++f){var p=i[f];if(p in d)return d[p]}}return null}function k(e,t,n,r,a){if(null===t)return t;if(X(n)&&(n=null),X(a)&&(a=!1),r=r||{},A(t)&&(r.vocab=!0),r.vocab&&t in e.getInverse()){var o=e["@language"]||"@none",i=[];_(n)&&"@index"in n&&i.push("@index");var l="@language",u="@null";if(a)l="@type",u="@reverse",i.push("@set");else if(Q(n)){"@index"in n||i.push("@list");for(var s=n["@list"],c=0===s.length?o:null,d=null,f=0;f<s.length;++f){var p=s[f],v="@none",h="@none";if(Y(p)?"@language"in p?v=p["@language"]:"@type"in p?h=p["@type"]:v="@null":h="@id",null===c?c=v:v!==c&&Y(p)&&(c="@none"),null===d?d=h:h!==d&&(d="@none"),"@none"===c&&"@none"===d)break}c=c||"@none",d=d||"@none","@none"!==d?(l="@type",u=d):u=c}else Y(n)?"@language"in n&&!("@index"in n)?(i.push("@language"),u=n["@language"]):"@type"in n&&(l="@type",u=n["@type"]):(l="@type",u="@id"),i.push("@set");i.push("@none");var g=N(e,t,n,i,l,u);if(null!==g)return g}if(r.vocab&&"@vocab"in e){var m=e["@vocab"];if(0===t.indexOf(m)&&t!==m){var y=t.substr(m.length);if(!(y in e.mappings))return y}}var x=null;for(var g in e.mappings)if(-1===g.indexOf(":")){var b=e.mappings[g];if(b&&b["@id"]!==t&&0===t.indexOf(b["@id"])){var w=g+":"+t.substr(b["@id"].length),j=!(w in e.mappings)||null===n&&e.mappings[w]&&e.mappings[w]["@id"]===t;j&&(null===x||E(w,x)<0)&&(x=w)}}return null!==x?x:r.vocab?t:T(e["@base"],t)}function C(e,t,r){if(Y(r)){var a=n.getContextValue(e,t,"@type"),o=n.getContextValue(e,t,"@language"),i=n.getContextValue(e,t,"@container"),l="@index"in r&&"@index"!==i;if(!l&&(r["@type"]===a||r["@language"]===o))return r["@value"];var u=Object.keys(r).length,s=1===u||2===u&&"@index"in r&&!l,c="@language"in e,d=q(r["@value"]),f=e.mappings[t]&&null===e.mappings[t]["@language"];if(s&&(!c||!d||f))return r["@value"];var p={};return l&&(p[k(e,"@index")]=r["@index"]),"@type"in r?p[k(e,"@type")]=k(e,r["@type"],null,{vocab:!0}):"@language"in r&&(p[k(e,"@language")]=r["@language"]),p[k(e,"@value")]=r["@value"],p}var v=R(e,t,{vocab:!0}),a=n.getContextValue(e,t,"@type"),h=k(e,r["@id"],null,{vocab:"@vocab"===a});if("@id"===a||"@vocab"===a||"@graph"===v)return h;var p={};return p[k(e,"@id")]=h,p}function D(e,t,n,r){if(n in r){if(r[n])return;throw new Ct("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}if(r[n]=!1,A(n))throw new Ct("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(""===n)throw new Ct("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});e.mappings[n]&&delete e.mappings[n];var a=t[n];if(null===a||_(a)&&null===a["@id"])return e.mappings[n]=null,void(r[n]=!0);if(q(a)&&(a={"@id":a}),!_(a))throw new Ct("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var o=e.mappings[n]={};if(o.reverse=!1,"@reverse"in a){if("@id"in a)throw new Ct("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var i=a["@reverse"];if(!q(i))throw new Ct("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});var l=R(e,i,{vocab:!0,base:!1},t,r);if(!K(l))throw new Ct("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=l,o.reverse=!0}else if("@id"in a){var l=a["@id"];if(!q(l))throw new Ct("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(l!==n){if(l=R(e,l,{vocab:!0,base:!1},t,r),!K(l)&&!A(l))throw new Ct("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=l}}if(!("@id"in o)){var u=n.indexOf(":");if(-1!==u){var s=n.substr(0,u);if(s in t&&D(e,t,s,r),e.mappings[s]){var c=n.substr(u+1);o["@id"]=e.mappings[s]["@id"]+c}else o["@id"]=n}else{if(!("@vocab"in e))throw new Ct("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});o["@id"]=e["@vocab"]+n}}if(r[n]=!0,"@type"in a){var d=a["@type"];if(!q(d))throw new Ct("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==d&&"@vocab"!==d){if(d=R(e,d,{vocab:!0,base:!1},t,r),!K(d))throw new Ct("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===d.indexOf("_:"))throw new Ct("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}o["@type"]=d}if("@container"in a){var f=a["@container"];if("@list"!==f&&"@set"!==f&&"@index"!==f&&"@language"!==f)throw new Ct("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(o.reverse&&"@index"!==f&&"@set"!==f&&null!==f)throw new Ct("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});o["@container"]=f}if("@language"in a&&!("@type"in a)){var p=a["@language"];if(null!==p&&!q(p))throw new Ct("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==p&&(p=p.toLowerCase()),o["@language"]=p}var l=o["@id"];if("@context"===l||"@preserve"===l)throw new Ct("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t})}function R(e,t,n,r,a){if(null===t||A(t))return t;if(r&&t in r&&a[t]!==!0&&D(e,r,t,a),n=n||{},n.vocab){var o=e.mappings[t];if(null===o)return null;if(o)return o["@id"]}var i=t.indexOf(":");if(-1!==i){var l=t.substr(0,i),u=t.substr(i+1);if("_"===l||0===u.indexOf("//"))return t;r&&l in r&&D(e,r,l,a);var o=e.mappings[l];return o?o["@id"]+u:t}if(n.vocab&&"@vocab"in e)return e["@vocab"]+t;var s=t;return n.base&&(s=U(e["@base"],s)),s}function U(e,t){if(null===e)return t;if(-1!==t.indexOf(":"))return t;q(e)&&(e=n.url.parse(e||""));var r=n.url.parse(t),a=e.protocol||"";r.authority?a+="//"+r.authority:""!==e.href&&(a+="//"+e.authority);var o;0===r.pathname.indexOf("/")?o=r.pathname:(o=e.pathname,""!==r.pathname&&(o=o.substr(0,o.lastIndexOf("/")+1),o.length>0&&"/"!==o.substr(-1)&&(o+="/"),o+=r.pathname)),o=ut(o,""!==a),r.query&&(o+="?"+r.query),r.hash&&(o+=r.hash);var i=a+o;return""===i&&(i="./"),i}function T(e,t){if(null===e)return t;q(e)&&(e=n.url.parse(e||""));var r="";if(""!==e.href?r+=(e.protocol||"")+"//"+e.authority:t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;for(var a=n.url.parse(t.substr(r.length)),o=e.normalizedPath.split("/"),i=a.normalizedPath.split("/"),l=a.hash||a.query?0:1;o.length>0&&i.length>l&&o[0]===i[0];)o.shift(),i.shift();var u="";if(o.length>0){o.pop();for(var s=0;s<o.length;++s)u+="../"}return u+=i.join("/"),a.query&&(u+="?"+a.query),a.hash&&(u+=a.hash),""===u&&(u="./"),u}function J(e){function t(){var e=this;if(e.inverse)return e.inverse;for(var t=e.inverse={},n=e["@language"]||"@none",a=e.mappings,o=Object.keys(a).sort(E),i=0;i<o.length;++i){var l=o[i],u=a[l];if(null!==u){var s=u["@container"]||"@none",c=u["@id"];V(c)||(c=[c]);for(var d=0;d<c.length;++d){var f=c[d],p=t[f];if(p||(t[f]=p={}),p[s]||(p[s]={"@language":{},"@type":{}}),p=p[s],u.reverse)r(u,l,p["@type"],"@reverse");else if("@type"in u)r(u,l,p["@type"],u["@type"]);else if("@language"in u){var v=u["@language"]||"@null";r(u,l,p["@language"],v)}else r(u,l,p["@language"],n),r(u,l,p["@type"],"@none"),r(u,l,p["@language"],"@none")}}}return t}function r(e,t,n,r){r in n||(n[r]=t)}function a(){var e={};return e["@base"]=this["@base"],e.mappings=W(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,"@language"in this&&(e["@language"]=this["@language"]),"@vocab"in this&&(e["@vocab"]=this["@vocab"]),e}var o=n.url.parse(e.base||"");return{"@base":o,mappings:{},inverse:null,getInverse:t,clone:a}}function A(e){if(!q(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function _(e){return"[object Object]"===Object.prototype.toString.call(e)}function P(e){return _(e)&&0===Object.keys(e).length}function V(e){return Array.isArray(e)}function F(e){if(!q(e)&&!P(e)){var t=!1;if(V(e)){t=!0;for(var n=0;n<e.length;++n)if(!q(e[n])){t=!1;break}}if(!t)throw new Ct('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}}function q(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function M(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function z(e){return M(e)&&-1!==String(e).indexOf(".")}function H(e){return!isNaN(parseFloat(e))&&isFinite(e)}function B(e){return"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e)}function X(e){return"undefined"==typeof e}function $(e){var t=!1;if(_(e)&&!("@value"in e||"@set"in e||"@list"in e)){var n=Object.keys(e).length;t=n>1||!("@id"in e)}return t}function G(e){return _(e)&&1===Object.keys(e).length&&"@id"in e}function Y(e){return _(e)&&"@value"in e}function Q(e){return _(e)&&"@list"in e}function Z(e){var t=!1;return _(e)&&(t="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),t}function K(e){return q(e)&&-1!==e.indexOf(":")}function W(e){if(e&&"object"==typeof e){var t;if(V(e)){t=[];for(var n=0;n<e.length;++n)t[n]=W(e[n])}else if(_(e)){t={};for(var r in e)t[r]=W(e[r])}else t=e.toString();return t}return e}function et(e,t,n,r){var a=Object.keys(t).length;if(V(e)){for(var o=0;o<e.length;++o)et(e[o],t,n,r);return a<Object.keys(t).length}if(_(e)){for(var i in e)if("@context"===i){var l=e[i];if(V(l))for(var u=l.length,o=0;u>o;++o){var s=l[o];q(s)&&(s=U(r,s),n?(s=t[s],V(s)?(Array.prototype.splice.apply(l,[o,1].concat(s)),o+=s.length-1,u=l.length):l[o]=s):s in t||(t[s]=!1))}else q(l)&&(l=U(r,l),n?e[i]=t[l]:l in t||(t[l]=!1))}else et(e[i],t,n,r);return a<Object.keys(t).length}return!1}function tt(e,t,n){var r=null,a=t.documentLoader,o=function(e,t,n,a,i){if(Object.keys(t).length>kt)return r=new Ct("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:kt}),i(r);var l={},u=function(){et(e,l,!0,a),i(null,e)};et(e,l,!1,a)||u();var s=[];for(var c in l)l[c]===!1&&s.push(c);for(var d=s.length,f=0;f<s.length;++f)!function(e){if(e in t)return r=new Ct("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:e}),i(r);var a=W(t);a[e]=!0;var s=function(t,s){if(!r){var c=s?s.document:null;if(!t&&q(c))try{c=JSON.parse(c)}catch(f){t=f}if(t?t=new Ct("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:e,cause:t}):_(c)||(t=new Ct("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:e,cause:t})),t)return r=t,i(r);c="@context"in c?{"@context":c["@context"]}:{"@context":{}},s.contextUrl&&(V(c["@context"])||(c["@context"]=[c["@context"]]),c["@context"].push(s.contextUrl)),o(c,a,n,e,function(t,n){return t?i(t):(l[e]=n["@context"],d-=1,void(0===d&&u()))})}},c=n(e,s);c&&"then"in c&&c.then(s.bind(null,null),s)}(s[f])};o(e,{},a,t.base,n)}function nt(e){for(var t="(?:<([^:]+:[^>]*)>)",n="(_:(?:[A-Za-z0-9]+))",r='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',a="(?:\\^\\^"+t+")",o="(?:@([a-z]+(?:-[a-z0-9]+)*))",i="(?:"+r+"(?:"+a+"|"+o+")?)",l="[ \\t]+",u="[ \\t]*",s=/(?:\r\n)|(?:\n)|(?:\r)/g,c=new RegExp("^"+u+"$"),f="(?:"+t+"|"+n+")"+l,p=t+l,v="(?:"+t+"|"+n+"|"+i+")"+u,h="(?:\\.|(?:(?:"+t+"|"+n+")"+u+"\\.))",g=new RegExp("^"+u+f+p+v+h+u+"$"),m={},y=e.split(s),x=0,b=0;b<y.length;++b){var w=y[b];if(x++,!c.test(w)){var j=w.match(g);if(null===j)throw new Ct("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:x});var O={};if(O.subject=X(j[1])?{type:"blank node",value:j[2]}:{type:"IRI",value:j[1]},O.predicate={type:"IRI",value:j[3]},X(j[4]))if(X(j[5])){O.object={type:"literal"},X(j[7])?X(j[8])?O.object.datatype=mt:(O.object.datatype=Et,O.object.language=j[8]):O.object.datatype=j[7];var I=j[6].replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");O.object.value=I}else O.object={type:"blank node",value:j[5]};else O.object={type:"IRI",value:j[4]};var L="@default";if(X(j[9])?X(j[10])||(L=j[10]):L=j[9],L in m){for(var S=!0,E=m[L],N=0;S&&N<E.length;++N)d(E[N],O)&&(S=!1);S&&E.push(O)}else m[L]=[O]}}return m}function rt(e){var t=[];for(var n in e)for(var r=e[n],a=0;a<r.length;++a){var o=r[a];"@default"===n&&(n=null),t.push(at(o,n))}return t.sort(),t.join("")}function at(e,t,n){var r=e.subject,a=e.predicate,o=e.object,i=t,l="";if(l+="IRI"===r.type?"<"+r.value+">":n?r.value===n?"_:a":"_:z":r.value,l+=" ",l+="IRI"===a.type?"<"+a.value+">":n?"_:p":a.value,l+=" ","IRI"===o.type)l+="<"+o.value+">";else if("blank node"===o.type)l+=n?o.value===n?"_:a":"_:z":o.value;else{var u=o.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');l+='"'+u+'"',o.datatype===Et?o.language&&(l+="@"+o.language):o.datatype!==mt&&(l+="^^<"+o.datatype+">")}return null!==i&&(l+=0!==i.indexOf("_:")?" <"+i+">":n?" _:g":" "+i),l+=" .\n"}function ot(e){var t={};t["@default"]=[];for(var n=e.getSubjects(),r=0;r<n.length;++r){var a=n[r];if(null!==a){var o=e.getSubjectTriples(a);if(null!==o){var i=o.predicates;for(var l in i)for(var u=i[l].objects,s=0;s<u.length;++s){var c=u[s],d={};d.subject=0===a.indexOf("_:")?{type:"blank node",value:a}:{type:"IRI",value:a},d.predicate=0===l.indexOf("_:")?{type:"blank node",value:l}:{type:"IRI",value:l};var f=c.value;if(c.type===Lt){ft||At();var p=new ft;f="";for(var v=0;v<c.value.length;v++)c.value[v].nodeType===pt.ELEMENT_NODE?f+=p.serializeToString(c.value[v]):c.value[v].nodeType===pt.TEXT_NODE&&(f+=c.value[v].nodeValue)}d.object={},c.type===St?d.object.type=0===c.value.indexOf("_:")?"blank node":"IRI":(d.object.type="literal",c.type===It?c.language?(d.object.datatype=Et,d.object.language=c.language):d.object.datatype=mt:d.object.datatype=c.type),d.object.value=f,t["@default"].push(d)}}}}return t}function it(e){this.prefix=e,this.counter=0,this.existing={}}function lt(e){if(-1!==e.href.indexOf(":")||0!==e.href.indexOf("//")||e.host)e.authority=e.host||"",e.auth&&(e.authority=e.auth+"@"+e.authority);else{e.pathname=e.pathname.substr(2);var t=e.pathname.indexOf("/");-1===t?(e.authority=e.pathname,e.pathname=""):(e.authority=e.pathname.substr(0,t),e.pathname=e.pathname.substr(t))}}function ut(e,t){var n="";0===e.indexOf("/")&&(n="/");for(var r=e.split("/"),a=[];r.length>0;)"."===r[0]||""===r[0]&&r.length>1?r.shift():".."!==r[0]?a.push(r.shift()):(r.shift(),t||a.length>0&&".."!==a[a.length-1]?a.pop():a.push(".."));return n+a.join("/")}n.compact=function(e,t,r,a){function o(e,n,r,o){if(e)return a(e);o.compactArrays&&!o.graph&&V(n)?1===n.length?n=n[0]:0===n.length&&(n={}):o.graph&&_(n)&&(n=[n]),_(t)&&"@context"in t&&(t=t["@context"]),t=W(t),V(t)||(t=[t]);var i=t;t=[];for(var l=0;l<i.length;++l)(!_(i[l])||Object.keys(i[l]).length>0)&&t.push(i[l]);var u=t.length>0;if(1===t.length&&(t=t[0]),V(n)){var s=k(r,"@graph"),c=n;n={},u&&(n["@context"]=t),n[s]=c}else if(_(n)&&u){var c=n;n={"@context":t};for(var d in c)n[d]=c[d]}a(null,n,r)}if(arguments.length<2)return n.nextTick(function(){a(new TypeError("Could not compact, too few arguments."))});if("function"==typeof r&&(a=r,r={}),r=r||{},null===t)return n.nextTick(function(){a(new Ct("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===e)return n.nextTick(function(){a(null,null)});"base"in r||(r.base="string"==typeof e?e:""),"compactArrays"in r||(r.compactArrays=!0),"graph"in r||(r.graph=!1),"skipExpansion"in r||(r.skipExpansion=!1),"documentLoader"in r||(r.documentLoader=n.loadDocument);var i=function(e,t,r){n.nextTick(function(){return t.skipExpansion?r(null,e):void n.expand(e,t,r)})};i(e,r,function(e,i){if(e)return a(new Ct("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var l=J(r);n.processContext(l,t,r,function(e,t){if(e)return a(new Ct("Could not process context before compaction.","jsonld.CompactError",{cause:e}));var n;try{n=(new Dt).compact(t,null,i,r)}catch(l){return a(l)}o(null,n,t,r)})})},n.expand=function(e,t,r){function a(e){"base"in t||(t.base=e.documentUrl||"");var n={document:W(e.document),remoteContext:{"@context":e.contextUrl}};if("expandContext"in t){var a=W(t.expandContext);n.expandContext="object"==typeof a&&"@context"in a?a:{"@context":a}}tt(n,t,function(e,n){if(e)return r(e);var a;try{var o=new Dt,i=J(t),l=n.document,u=n.remoteContext["@context"];n.expandContext&&(i=o.processContext(i,n.expandContext["@context"],t)),u&&(i=o.processContext(i,u,t)),a=o.expand(i,null,l,t,!1),_(a)&&"@graph"in a&&1===Object.keys(a).length?a=a["@graph"]:null===a&&(a=[]),V(a)||(a=[a])}catch(s){return r(s)}r(null,a)})}return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not expand, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"documentLoader"in t||(t.documentLoader=n.loadDocument),"keepFreeFloatingNodes"in t||(t.keepFreeFloatingNodes=!1),void n.nextTick(function(){if("string"==typeof e){var n=function(e,t){if(e)return r(e);try{if(!t.document)throw new Ct("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(n){return r(new Ct("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:n,remoteDoc:t}))}a(t)},o=t.documentLoader(e,n);return void(o&&"then"in o&&o.then(n.bind(null,null),n))}a({contextUrl:null,documentUrl:null,document:e})}))},n.flatten=function(e,t,r,a){return arguments.length<1?n.nextTick(function(){a(new TypeError("Could not flatten, too few arguments."))}):("function"==typeof r?(a=r,r={}):"function"==typeof t&&(a=t,t=null,r={}),r=r||{},"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=n.loadDocument),void n.expand(e,r,function(e,o){if(e)return a(new Ct("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));var i;try{i=(new Dt).flatten(o)}catch(l){return a(l)}return null===t?a(null,i):(r.graph=!0,r.skipExpansion=!0,void n.compact(i,t,r,function(e,t){return e?a(new Ct("Could not compact flattened output.","jsonld.FlattenError",{cause:e})):void a(null,t)}))}))},n.frame=function(e,t,r,a){function o(t){var o,i=t.document;i?(o=i["@context"],t.contextUrl?(o?V(o)?o.push(t.contextUrl):o=[o,t.contextUrl]:o=t.contextUrl,i["@context"]=o):o=o||{}):o={},n.expand(e,r,function(e,t){if(e)return a(new Ct("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var l=W(r);l.isFrame=!0,l.keepFreeFloatingNodes=!0,n.expand(i,l,function(e,r){if(e)return a(new Ct("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));var i;try{i=(new Dt).frame(t,r,l)}catch(u){return a(u)}l.graph=!0,l.skipExpansion=!0,n.compact(i,o,l,function(e,t,n){if(e)return a(new Ct("Could not compact framed output.","jsonld.FrameError",{cause:e}));var r=k(n,"@graph");t[r]=S(n,t[r],l),a(null,t)})})})}return arguments.length<2?n.nextTick(function(){a(new TypeError("Could not frame, too few arguments."))}):("function"==typeof r&&(a=r,r={}),r=r||{},"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=n.loadDocument),"embed"in r||(r.embed="once"),r.explicit=r.explicit||!1,"requireAll"in r||(r.requireAll=!0),r.omitDefault=r.omitDefault||!1,void n.nextTick(function(){if("string"==typeof t){var e=function(e,t){if(e)return a(e);try{if(!t.document)throw new Ct("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(n){return a(new Ct("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:n,remoteDoc:t}))}o(t)},n=r.documentLoader(t,e);return void(n&&"then"in n&&n.then(e.bind(null,null),e))}o({contextUrl:null,documentUrl:null,document:t})}))},n.objectify=function(e,t,r,a){"function"==typeof r&&(a=r,r={}),r=r||{},"base"in r||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=n.loadDocument),n.expand(e,r,function(e,o){if(e)return a(new Ct("Could not expand input before framing.","jsonld.FrameError",{cause:e}));
var i;try{i=(new Dt).flatten(o)}catch(l){return a(l)}r.graph=!0,r.skipExpansion=!0,n.compact(i,t,r,function(e,t,o){if(e)return a(new Ct("Could not compact flattened output.","jsonld.FrameError",{cause:e}));var i=k(o,"@graph");t[i]=S(o,t[i],r);var l=t[i][0],u=function(e){if(_(e)||V(e)){if(_(e)){if(u.visited[e["@id"]])return;u.visited[e["@id"]]=!0}for(var t in e){var r=e[t],a="@id"===n.getContextValue(o,t,"@type");if(V(r)||_(r)||a)if(q(r)&&a)e[t]=r=l[r],u(r);else if(V(r))for(var i=0;i<r.length;++i)q(r[i])&&a?r[i]=l[r[i]]:_(r[i])&&"@id"in r[i]&&(r[i]=l[r[i]["@id"]]),u(r[i]);else if(_(r)){var s=r["@id"];e[t]=r=l[s],u(r)}}}};u.visited={},u(l),t.of_type={};for(var s in l)if("@type"in l[s]){var c=l[s]["@type"];V(c)||(c=[c]);for(var d in c)c[d]in t.of_type||(t.of_type[c[d]]=[]),t.of_type[c[d]].push(l[s])}a(null,t)})})},n.normalize=function(e,t,r){if(arguments.length<1)return n.nextTick(function(){r(new TypeError("Could not normalize, too few arguments."))});"function"==typeof t&&(r=t,t={}),t=t||{},"base"in t||(t.base="string"==typeof e?e:""),"documentLoader"in t||(t.documentLoader=n.loadDocument);var a=W(t);delete a.format,a.produceGeneralizedRdf=!1,n.toRDF(e,a,function(e,n){return e?r(new Ct("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:e})):void(new Dt).normalize(n,t,r)})},n.fromRDF=function(e,t,r){return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not convert from RDF, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"useRdfType"in t||(t.useRdfType=!1),"useNativeTypes"in t||(t.useNativeTypes=!1),"format"in t||!q(e)||"format"in t||(t.format="application/nquads"),void n.nextTick(function(){function n(e,t,n){(new Dt).fromRDF(e,t,n)}var a;if(t.format){if(a=t.rdfParser||dt[t.format],!a)return r(new Ct("Unknown input format.","jsonld.UnknownFormat",{format:t.format}))}else a=function(){return e};if(e=a(e,function(e,a){return e?r(e):void n(a,t,r)})){if("then"in e)return e.then(function(e){n(e,t,r)},r);n(e,t,r)}}))},n.toRDF=function(e,t,r){return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not convert to RDF, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"base"in t||(t.base="string"==typeof e?e:""),"documentLoader"in t||(t.documentLoader=n.loadDocument),void n.expand(e,t,function(e,n){if(e)return r(new Ct("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:e}));var a;try{if(a=Dt.prototype.toRDF(n,t),t.format){if("application/nquads"===t.format)return r(null,rt(a));throw new Ct("Unknown output format.","jsonld.UnknownFormat",{format:t.format})}}catch(o){return r(o)}r(null,a)}))},n.createNodeMap=function(e,t,r){return arguments.length<1?n.nextTick(function(){r(new TypeError("Could not create node map, too few arguments."))}):("function"==typeof t&&(r=t,t={}),t=t||{},"base"in t||(t.base="string"==typeof e?e:""),"documentLoader"in t||(t.documentLoader=n.loadDocument),void n.expand(e,t,function(e,n){if(e)return r(new Ct("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:e}));var a;try{a=(new Dt).createNodeMap(n,t)}catch(o){return r(o)}r(null,a)}))},n.merge=function(e,t,r,a){function o(e,t){if(!u){if(e)return u=e,a(new Ct("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));l.push(t),0===--s&&i(l)}}function i(e){var o,i=r.namer||new it("_:b"),l={"@default":{}};try{for(var u=0;u<e.length;++u){var s=e[u];s=n.relabelBlankNodes(s,{namer:new it("_:b"+u+"-")}),h(s,l,"@default",i)}o=g(l)}catch(c){return a(c)}for(var d=[],f=Object.keys(o).sort(),p=0;p<f.length;++p){var v=o[f[p]];G(v)||d.push(v)}return null===t?a(null,d):(r.graph=!0,r.skipExpansion=!0,void n.compact(d,t,r,function(e,t){return e?a(new Ct("Could not compact merged output.","jsonld.MergeError",{cause:e})):void a(null,t)}))}if(arguments.length<1)return n.nextTick(function(){a(new TypeError("Could not merge, too few arguments."))});if(!V(e))return n.nextTick(function(){a(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof r?(a=r,r={}):"function"==typeof t&&(a=t,t=null,r={}),r=r||{};for(var l=[],u=null,s=e.length,c=0;c<e.length;++c){var d={};for(var f in r)d[f]=r[f];n.expand(e[c],d,o)}},n.relabelBlankNodes=function(e,t){t=t||{};var n=t.namer||new it("_:b");return o(n,e)},n.documentLoader=function(t,r){var a=new Ct("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return e?r(a,{contextUrl:null,documentUrl:t,document:null}):n.promisify(function(e){e(a)})},n.loadDocument=function(e,t){var r=n.documentLoader(e,t);r&&"then"in r&&r.then(t.bind(null,null),t)},n.promises=function(e){e=e||{};var t=Array.prototype.slice,r=n.promisify,a=e.api||{},o=e.version||"jsonld.js";"string"==typeof e.api&&(e.version||(o=e.api),a={}),a.expand=function(){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return r.apply(null,[n.expand].concat(t.call(arguments)))},a.compact=function(){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var e=function(e,t,r,a){n.compact(e,t,r,function(e,t){a(e,t)})};return r.apply(null,[e].concat(t.call(arguments)))},a.flatten=function(){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return r.apply(null,[n.flatten].concat(t.call(arguments)))},a.frame=function(){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return r.apply(null,[n.frame].concat(t.call(arguments)))},a.fromRDF=function(){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return r.apply(null,[n.fromRDF].concat(t.call(arguments)))},a.toRDF=function(){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return r.apply(null,[n.toRDF].concat(t.call(arguments)))},a.normalize=function(){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return r.apply(null,[n.normalize].concat(t.call(arguments)))},"jsonld.js"===o&&(a.objectify=function(){return r.apply(null,[n.objectify].concat(t.call(arguments)))},a.createNodeMap=function(){return r.apply(null,[n.createNodeMap].concat(t.call(arguments)))},a.merge=function(){return r.apply(null,[n.merge].concat(t.call(arguments)))});try{n.Promise=global.Promise||require("es6-promise").Promise}catch(i){var l=function(){throw new Error("Unable to find a Promise implementation.")};for(var u in a)a[u]=l}return a},n.promisify=function(e){if(!n.Promise)try{n.Promise=global.Promise||require("es6-promise").Promise}catch(t){throw new Error("Unable to find a Promise implementation.")}var r=Array.prototype.slice.call(arguments,1);return new n.Promise(function(t,n){e.apply(null,r.concat(function(e,r){e?n(e):t(r)}))})},n.promises({api:n.promises}),r.prototype=n.promises({version:"json-ld-1.0"}),r.prototype.toString=function(){return this instanceof r?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},n.JsonLdProcessor=r;var st=!!Object.defineProperty;if(st)try{Object.defineProperty({},"x",{})}catch(ct){st=!1}st&&(Object.defineProperty(r,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(r.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:r})),t&&"undefined"==typeof global.JsonLdProcessor&&(st?Object.defineProperty(global,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:r}):global.JsonLdProcessor=r),"undefined"!=typeof process&&process.nextTick?(n.nextTick=process.nextTick,n.setImmediate="function"==typeof setImmediate?setImmediate:n.nextTick):"function"==typeof setImmediate?n.setImmediate=n.nextTick=function(e){return setImmediate(e)}:(n.setImmediate=function(e){setTimeout(e,0)},n.nextTick=n.setImmediate),n.parseLinkHeader=function(e){for(var t={},n=e.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),r=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,a=0;a<n.length;++a){var o=n[a].match(r);if(o){for(var i={target:o[1]},l=o[2],u=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;o=u.exec(l);)i[o[1]]=void 0===o[2]?o[3]:o[2];var s=i.rel||"";V(t[s])?t[s].push(i):t[s]=s in t?[t[s],i]:i}}return t},n.DocumentCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=3e4},n.DocumentCache.prototype.get=function(e){if(e in this.cache){var t=this.cache[e];if(t.expires>=+new Date)return t.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},n.DocumentCache.prototype.set=function(e,t){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:t,expires:+new Date+this.expires}},n.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},n.ActiveContextCache.prototype.get=function(e,t){var n=JSON.stringify(e),r=JSON.stringify(t),a=this.cache[n];return a&&r in a?a[r]:null},n.ActiveContextCache.prototype.set=function(e,t,n){if(this.order.length===this.size){var r=this.order.shift();delete this.cache[r.activeCtx][r.localCtx]}var a=JSON.stringify(e),o=JSON.stringify(t);this.order.push({activeCtx:a,localCtx:o}),a in this.cache||(this.cache[a]={}),this.cache[a][o]=W(n)},n.cache={activeCtx:new n.ActiveContextCache},n.documentLoaders={},n.documentLoaders.jquery=function(e,t){t=t||{};var r=function(r,a){return 0!==r.indexOf("http:")&&0!==r.indexOf("https:")?a(new Ct('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null}):t.secure&&0!==r.indexOf("https")?a(new Ct('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null}):void e.ajax({url:r,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(e,t,o){var i={contextUrl:null,documentUrl:r,document:e},l=o.getResponseHeader("Content-Type"),u=o.getResponseHeader("Link");if(u&&"application/ld+json"!==l){if(u=n.parseLinkHeader(u)[Nt],V(u))return a(new Ct("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r}),i);u&&(i.contextUrl=u.target)}a(null,i)},error:function(e,t,n){a(new Ct("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r,cause:n}),{contextUrl:null,documentUrl:r,document:null})}})},a="undefined"!=typeof Promise;return"usePromise"in t&&(a=t.usePromise),a?function(e){return n.promisify(r,e)}:r},n.documentLoaders.node=function(e){function t(u,s,c){function d(e,r,o){if(f={contextUrl:null,documentUrl:u,document:o||null},e)return c(new Ct("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:u,cause:e}),f);var d=i.STATUS_CODES[r.statusCode];if(r.statusCode>=400)return c(new Ct("URL could not be dereferenced: "+d,"jsonld.InvalidUrl",{code:"loading document failed",url:u,httpStatusCode:r.statusCode}),f);if(r.headers.link&&"application/ld+json"!==r.headers["content-type"]){var p=n.parseLinkHeader(r.headers.link)[Nt];if(V(p))return c(new Ct("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:u}),f);p&&(f.contextUrl=p.target)}if(r.statusCode>=300&&r.statusCode<400&&r.headers.location)return s.length===a?c(new Ct("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:u,httpStatusCode:r.statusCode,redirects:s}),f):-1!==s.indexOf(u)?c(new Ct("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:u,httpStatusCode:r.statusCode,redirects:s}),f):(s.push(u),t(r.headers.location,s,c));s.push(u);for(var v=0;v<s.length;++v)l.set(s[v],{contextUrl:null,documentUrl:s[v],document:o});c(e,f)}if(0!==u.indexOf("http:")&&0!==u.indexOf("https:"))return c(new Ct('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:u}),{contextUrl:null,documentUrl:u,document:null});if(e.secure&&0!==u.indexOf("https"))return c(new Ct('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:u}),{contextUrl:null,documentUrl:u,document:null});var f=l.get(u);return null!==f?c(null,f):void o({url:u,headers:{Accept:"application/ld+json, application/json"},strictSSL:r,followRedirect:!1},d)}e=e||{};var r="strictSSL"in e?e.strictSSL:!0,a="maxRedirects"in e?e.maxRedirects:-1,o=require("request"),i=require("http"),l=new n.DocumentCache,u=function(e,n){t(e,[],n)};return e.usePromise?function(e){return n.promisify(u,e)}:u},n.documentLoaders.xhr=function(e){var t=/(^|(\r\n))link:/i;e=e||{};var r=function(r,a){if(0!==r.indexOf("http:")&&0!==r.indexOf("https:"))return a(new Ct('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});if(e.secure&&0!==r.indexOf("https"))return a(new Ct('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null});var o=e.xhr||XMLHttpRequest,i=new o;i.onload=function(){if(i.status>=400)return a(new Ct("URL could not be dereferenced: "+i.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:r,httpStatusCode:i.status}),{contextUrl:null,documentUrl:r,document:null});var e,o={contextUrl:null,documentUrl:r,document:i.response},l=i.getResponseHeader("Content-Type");if(t.test(i.getAllResponseHeaders())&&(e=i.getResponseHeader("Link")),e&&"application/ld+json"!==l){if(e=n.parseLinkHeader(e)[Nt],V(e))return a(new Ct("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:r}),o);e&&(o.contextUrl=e.target)}a(null,o)},i.onerror=function(){a(new Ct("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:r}),{contextUrl:null,documentUrl:r,document:null})},i.open("GET",r,!0),i.setRequestHeader("Accept","application/ld+json, application/json"),i.send()},a="undefined"!=typeof Promise;return"usePromise"in e&&(a=e.usePromise),a?function(e){return n.promisify(r,e)}:r},n.useDocumentLoader=function(e){if(!(e in n.documentLoaders))throw new Ct('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});n.documentLoader=n.documentLoaders[e].apply(n,Array.prototype.slice.call(arguments,1))},n.processContext=function(e,t){var r={},a=2;arguments.length>3&&(r=arguments[2]||{},a+=1);var o=arguments[a];return"base"in r||(r.base=""),"documentLoader"in r||(r.documentLoader=n.loadDocument),null===t?o(null,J(r)):(t=W(t),_(t)&&"@context"in t||(t={"@context":t}),void tt(t,r,function(t,n){if(t)return o(t);try{n=(new Dt).processContext(e,n,r)}catch(a){return o(a)}o(null,n)}))},n.hasProperty=function(e,t){var n=!1;if(t in e){var r=e[t];n=!V(r)||r.length>0}return n},n.hasValue=function(e,t,r){var a=!1;if(n.hasProperty(e,t)){var o=e[t],i=Q(o);if(V(o)||i){i&&(o=o["@list"]);for(var l=0;l<o.length;++l)if(n.compareValues(r,o[l])){a=!0;break}}else V(r)||(a=n.compareValues(r,o))}return a},n.addValue=function(e,t,r,a){if(a=a||{},"propertyIsArray"in a||(a.propertyIsArray=!1),"allowDuplicate"in a||(a.allowDuplicate=!0),V(r)){0!==r.length||!a.propertyIsArray||t in e||(e[t]=[]);for(var o=0;o<r.length;++o)n.addValue(e,t,r[o],a)}else if(t in e){var i=!a.allowDuplicate&&n.hasValue(e,t,r);V(e[t])||i&&!a.propertyIsArray||(e[t]=[e[t]]),i||e[t].push(r)}else e[t]=a.propertyIsArray?[r]:r},n.getValues=function(e,t){var n=e[t]||[];return V(n)||(n=[n]),n},n.removeProperty=function(e,t){delete e[t]},n.removeValue=function(e,t,r,a){a=a||{},"propertyIsArray"in a||(a.propertyIsArray=!1);var o=n.getValues(e,t).filter(function(e){return!n.compareValues(e,r)});0===o.length?n.removeProperty(e,t):e[t]=1!==o.length||a.propertyIsArray?o:o[0]},n.compareValues=function(e,t){return e===t?!0:Y(e)&&Y(t)&&e["@value"]===t["@value"]&&e["@type"]===t["@type"]&&e["@language"]===t["@language"]&&e["@index"]===t["@index"]?!0:_(e)&&"@id"in e&&_(t)&&"@id"in t?e["@id"]===t["@id"]:!1},n.getContextValue=function(e,t,n){var r=null;if(null===t)return r;if("@language"===n&&n in e&&(r=e[n]),e.mappings[t]){var a=e.mappings[t];X(n)?r=a:n in a&&(r=a[n])}return r};var dt={};if(n.registerRDFParser=function(e,t){dt[e]=t},n.unregisterRDFParser=function(e){delete dt[e]},e){if("undefined"==typeof ft)var ft=null;if("undefined"==typeof pt)var pt={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var vt="http://www.w3.org/2001/XMLSchema#boolean",ht="http://www.w3.org/2001/XMLSchema#double",gt="http://www.w3.org/2001/XMLSchema#integer",mt="http://www.w3.org/2001/XMLSchema#string",yt="http://www.w3.org/1999/02/22-rdf-syntax-ns#",xt=yt+"List",bt=yt+"first",wt=yt+"rest",jt=yt+"nil",Ot=yt+"type",It=yt+"PlainLiteral",Lt=yt+"XMLLiteral",St=yt+"object",Et=yt+"langString",Nt="http://www.w3.org/ns/json-ld#context",kt=10,Ct=function(t,n,r){e&&(Error.call(this),Error.captureStackTrace(this,this.constructor)),this.name=n||"jsonld.Error",this.message=t||"An unspecified JSON-LD error occurred.",this.details=r||{}};e&&require("util").inherits(Ct,Error);var Dt=function(){};Dt.prototype.compact=function(e,t,r,a){if(V(r)){for(var o=[],i=0;i<r.length;++i){var l=this.compact(e,t,r[i],a);null!==l&&o.push(l)}if(a.compactArrays&&1===o.length){var u=n.getContextValue(e,t,"@container");null===u&&(o=o[0])}return o}if(_(r)){if(Y(r)||G(r))return C(e,t,r);for(var s="@reverse"===t,c=Object.keys(r).sort(),o={},d=0;d<c.length;++d){var f=c[d],p=r[f];if("@id"!==f&&"@type"!==f)if("@reverse"!==f)if("@index"!==f)if("@graph"!==f&&"@list"!==f&&A(f)){var v=k(e,f);n.addValue(o,v,p)}else{if(0===p.length){var h=k(e,f,p,{vocab:!0},s);n.addValue(o,h,p,{propertyIsArray:!0})}for(var g=0;g<p.length;++g){var m=p[g],h=k(e,f,m,{vocab:!0},s),u=n.getContextValue(e,h,"@container"),y=Q(m),x=null;y&&(x=m["@list"]);var b=this.compact(e,h,y?x:m,a);if(y)if(V(b)||(b=[b]),"@list"!==u){var w={};w[k(e,"@list")]=b,b=w,"@index"in m&&(b[k(e,"@index")]=m["@index"])}else if(h in o)throw new Ct('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===u||"@index"===u){var j;h in o?j=o[h]:o[h]=j={},"@language"===u&&Y(b)&&(b=b["@value"]),n.addValue(j,m[u],b)}else{var O=!a.compactArrays||"@set"===u||"@list"===u||V(b)&&0===b.length||"@list"===f||"@graph"===f;n.addValue(o,h,b,{propertyIsArray:O})}}}else{var u=n.getContextValue(e,t,"@container");if("@index"===u)continue;var v=k(e,f);n.addValue(o,v,p)}else{var I=this.compact(e,"@reverse",p,a);for(var L in I)if(e.mappings[L]&&e.mappings[L].reverse){var S=I[L],u=n.getContextValue(e,L,"@container"),E="@set"===u||!a.compactArrays;n.addValue(o,L,S,{propertyIsArray:E}),delete I[L]}if(Object.keys(I).length>0){var v=k(e,f);n.addValue(o,v,I)}}else{var I;if(q(p))I=k(e,p,null,{vocab:"@type"===f});else{I=[];for(var g=0;g<p.length;++g)I.push(k(e,p[g],null,{vocab:!0}))}var v=k(e,f),O=V(I)&&0===p.length;n.addValue(o,v,I,{propertyIsArray:O})}}return o}return r},Dt.prototype.expand=function(e,t,r,o,l){var u=this;if(null===r||void 0===r)return null;if(!V(r)&&!_(r))return l||null!==t&&"@graph"!==R(e,t,{vocab:!0})?i(e,t,r):null;if(V(r)){var s=[],c=n.getContextValue(e,t,"@container");l=l||"@list"===c;for(var d=0;d<r.length;++d){var f=u.expand(e,t,r[d],o);if(l&&(V(f)||Q(f)))throw new Ct("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==f&&(V(f)?s=s.concat(f):s.push(f))}return s}"@context"in r&&(e=u.processContext(e,r["@context"],o));for(var p=R(e,t,{vocab:!0}),s={},v=Object.keys(r).sort(),h=0;h<v.length;++h){var g,m=v[h],y=r[m];if("@context"!==m){var x=R(e,m,{vocab:!0});if(null!==x&&(K(x)||A(x))){if(A(x)){if("@reverse"===p)throw new Ct("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:y});if(x in s)throw new Ct("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:x})}if("@id"===x&&!q(y)){if(!o.isFrame)throw new Ct('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:y});if(!_(y))throw new Ct('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:y})}if("@type"===x&&F(y),"@graph"===x&&!_(y)&&!V(y))throw new Ct('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:y});if("@value"===x&&(_(y)||V(y)))throw new Ct('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:y});if("@language"===x){if(!q(y))throw new Ct('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:y});y=y.toLowerCase()}if("@index"===x&&!q(y))throw new Ct('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:y});if("@reverse"!==x){var c=n.getContextValue(e,m,"@container");if("@language"===c&&_(y))g=a(y);else if("@index"===c&&_(y))g=function(t){for(var n=[],r=Object.keys(y).sort(),a=0;a<r.length;++a){var i=r[a],l=y[i];V(l)||(l=[l]),l=u.expand(e,t,l,o,!1);for(var s=0;s<l.length;++s){var c=l[s];"@index"in c||(c["@index"]=i),n.push(c)}}return n}(m);else{var b="@list"===x;if(b||"@set"===x){var w=t;if(b&&"@graph"===p&&(w=null),g=u.expand(e,w,y,o,b),b&&Q(g))throw new Ct("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else g=u.expand(e,m,y,o,!1)}if(null!==g||"@value"===x)if("@list"===x||Q(g)||"@list"!==c||(g=V(g)?g:[g],g={"@list":g}),e.mappings[m]&&e.mappings[m].reverse){var j=s["@reverse"]=s["@reverse"]||{};V(g)||(g=[g]);for(var O=0;O<g.length;++O){var I=g[O];if(Y(I)||Q(I))throw new Ct('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:g});n.addValue(j,x,I,{propertyIsArray:!0})}}else{var L=-1===["@index","@id","@type","@value","@language"].indexOf(x);n.addValue(s,x,g,{propertyIsArray:L})}}else{if(!_(y))throw new Ct('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:y});if(g=u.expand(e,"@reverse",y,o),"@reverse"in g)for(var S in g["@reverse"])n.addValue(s,S,g["@reverse"][S],{propertyIsArray:!0});var j=s["@reverse"]||null;for(var S in g)if("@reverse"!==S){null===j&&(j=s["@reverse"]={}),n.addValue(j,S,[],{propertyIsArray:!0});for(var E=g[S],O=0;O<E.length;++O){var I=E[O];if(Y(I)||Q(I))throw new Ct('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:g});n.addValue(j,S,I,{propertyIsArray:!0})}}}}}}v=Object.keys(s);var N=v.length;if("@value"in s){if("@type"in s&&"@language"in s)throw new Ct('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});var k=N-1;if("@type"in s&&(k-=1),"@index"in s&&(k-=1),"@language"in s&&(k-=1),0!==k)throw new Ct('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:s});if(null===s["@value"])s=null;else{if("@language"in s&&!q(s["@value"]))throw new Ct("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:s});if("@type"in s&&(!K(s["@type"])||0===s["@type"].indexOf("_:")))throw new Ct('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:s})}}else if("@type"in s&&!V(s["@type"]))s["@type"]=[s["@type"]];else if("@set"in s||"@list"in s){if(N>1&&!(2===N&&"@index"in s))throw new Ct('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:s});"@set"in s&&(s=s["@set"],v=Object.keys(s),N=v.length)}else 1===N&&"@language"in s&&(s=null);return!_(s)||o.keepFreeFloatingNodes||l||null!==t&&"@graph"!==p||(0===N||"@value"in s||"@list"in s||1===N&&"@id"in s)&&(s=null),s},Dt.prototype.createNodeMap=function(e,t){t=t||{};var n=t.namer||new it("_:b"),r={"@default":{}};return h(e,r,"@default",n),g(r)},Dt.prototype.flatten=function(e){for(var t=this.createNodeMap(e),n=[],r=Object.keys(t).sort(),a=0;a<r.length;++a){var o=t[r[a]];G(o)||n.push(o)}return n},Dt.prototype.frame=function(e,t,n){var r={options:n,graphs:{"@default":{},"@merged":{}},subjectStack:[]},a=new it("_:b");h(e,r.graphs,"@merged",a),r.subjects=r.graphs["@merged"];var o=[];return m(r,Object.keys(r.subjects).sort(),t,o,null),o},Dt.prototype.normalize=function(e,t,r){function a(e){function t(l){if(l===e.length)return o(i,a,r);var u=e[l],c=f(u,s);c in a?(a[c].push(u),r.push(u)):c in i?(a[c]=[i[c],u],r.push(i[c]),r.push(u),delete i[c]):i[c]=u,n.setImmediate(function(){t(l+1)})}var r=[],a={},i={};n.setImmediate(function(){t(0)})}function o(e,t,n){for(var r=!1,o=Object.keys(e).sort(),l=0;l<o.length;++l){var u=e[o[l]];b.getName(u),r=!0}r?a(n):i(t)}function i(e){function t(a){function o(e,n){if(n===e.length){u.sort(function(e,t){return e=e.hash,t=t.hash,t>e?-1:e>t?1:0});for(var i in u)for(var l in u[i].pathNamer.existing)b.getName(l);return t(a+1)}var c=e[n];if(b.isNamed(c))return o(e,n+1);var d=new it("_:b");d.getName(c),p(c,s,b,d,function(t,a){return t?r(t):(u.push(a),void o(e,n+1))})}if(a===n.length)return l();var i=e[n[a]],u=[];o(i,0)}var n=Object.keys(e).sort();t(0)}function l(){for(var e=[],n=0;n<u.length;++n){for(var a=u[n],o=["subject","object","name"],i=0;i<o.length;++i){var l=o[i];a[l]&&"blank node"===a[l].type&&0!==a[l].value.indexOf("_:c14n")&&(a[l].value=b.getName(a[l].value))}e.push(at(a,a.name?a.name.value:null))}return e.sort(),t.format?"application/nquads"===t.format?r(null,e.join("")):r(new Ct("Unknown output format.","jsonld.UnknownFormat",{format:t.format})):void r(null,nt(e.join("")))}var u=[],s={};for(var c in e){var d=e[c];"@default"===c&&(c=null);for(var v=0;v<d.length;++v){var h=d[v];null!==c&&(h.name=0===c.indexOf("_:")?{type:"blank node",value:c}:{type:"IRI",value:c}),u.push(h);for(var g=["subject","object","name"],m=0;m<g.length;++m){var y=g[m];if(h[y]&&"blank node"===h[y].type){var x=h[y].value;x in s?s[x].quads.push(h):s[x]={quads:[h]}}}}}var b=new it("_:c14n");return a(Object.keys(s))},Dt.prototype.fromRDF=function(e,t,r){var a={},o={"@default":a},i={};for(var l in e){var u=e[l];l in o||(o[l]={}),"@default"===l||l in a||(a[l]={"@id":l});for(var s=o[l],d=0;d<u.length;++d){var f=u[d],p=f.subject.value,v=f.predicate.value,h=f.object;p in s||(s[p]={"@id":p});var g=s[p],m="IRI"===h.type||"blank node"===h.type;if(!m||h.value in s||(s[h.value]={"@id":h.value}),v!==Ot||t.useRdfType||!m){var y=c(h,t.useNativeTypes);if(n.addValue(g,v,y,{propertyIsArray:!0}),m)if(h.value===jt){var x=s[h.value];"usages"in x||(x.usages=[]),x.usages.push({node:g,property:v,value:y})}else i[h.value]=h.value in i?!1:{node:g,property:v,value:y}}else n.addValue(g,"@type",h.value,{propertyIsArray:!0})}}for(var l in o){var b=o[l];if(jt in b){for(var w=b[jt],j=0;j<w.usages.length;++j){for(var O=w.usages[j],g=O.node,I=O.property,L=O.value,S=[],E=[],N=Object.keys(g).length;I===wt&&_(i[g["@id"]])&&V(g[bt])&&1===g[bt].length&&V(g[wt])&&1===g[wt].length&&(3===N||4===N&&V(g["@type"])&&1===g["@type"].length&&g["@type"][0]===xt)&&(S.push(g[bt][0]),E.push(g["@id"]),O=i[g["@id"]],g=O.node,I=O.property,L=O.value,N=Object.keys(g).length,0===g["@id"].indexOf("_:")););if(I===bt){if(g["@id"]===jt)continue;L=b[L["@id"]][wt][0],S.pop(),E.pop()}delete L["@id"],L["@list"]=S.reverse();for(var k=0;k<E.length;++k)delete b[E[k]]}delete w.usages}}for(var C=[],D=Object.keys(a).sort(),j=0;j<D.length;++j){var R=D[j],g=a[R];if(R in o)for(var u=g["@graph"]=[],b=o[R],U=Object.keys(b).sort(),T=0;T<U.length;++T){var J=b[U[T]];G(J)||u.push(J)}G(g)||C.push(g)}r(null,C)},Dt.prototype.toRDF=function(e,t){var n=new it("_:b"),r={"@default":{}};h(e,r,"@default",n);for(var a={},o=Object.keys(r).sort(),i=0;i<o.length;++i){var u=o[i];("@default"===u||K(u))&&(a[u]=l(r[u],n,t))}return a},Dt.prototype.processContext=function(e,t,r){_(t)&&"@context"in t&&V(t["@context"])&&(t=t["@context"]);var a=V(t)?t:[t];if(0===a.length)return e.clone();for(var o=e,i=0;i<a.length;++i){var l=a[i];if(null!==l){if(_(l)&&"@context"in l&&(l=l["@context"]),!_(l))throw new Ct("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:l});if(n.cache.activeCtx){var u=n.cache.activeCtx.get(e,l);if(u){o=e=u;continue}}e=o,o=o.clone();var s={};if("@base"in l){var c=l["@base"];if(null===c)c=null;else{if(!q(c))throw new Ct('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:l});if(""!==c&&!K(c))throw new Ct('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:l})}null!==c&&(c=n.url.parse(c||"")),o["@base"]=c,s["@base"]=!0}if("@vocab"in l){var d=l["@vocab"];if(null===d)delete o["@vocab"];else{if(!q(d))throw new Ct('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:l});if(!K(d))throw new Ct('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:l});o["@vocab"]=d}s["@vocab"]=!0}if("@language"in l){var d=l["@language"];if(null===d)delete o["@language"];else{if(!q(d))throw new Ct('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:l});o["@language"]=d.toLowerCase()}s["@language"]=!0}for(var f in l)D(o,l,f,s);n.cache.activeCtx&&n.cache.activeCtx.set(e,l,o)}else o=e=J(r)}return o},Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}),n.registerRDFParser("application/nquads",nt),n.registerRDFParser("rdfa-api",ot),n.UniqueNamer=it,it.prototype.clone=function(){var e=new it(this.prefix);return e.counter=this.counter,e.existing=W(this.existing),e},it.prototype.getName=function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t},it.prototype.isNamed=function(e){return e in this.existing};var Rt=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var t=0;t<e.length;++t)this.left[e[t]]=!0};Rt.prototype.hasNext=function(){return!this.done},Rt.prototype.next=function(){for(var e=this.list.slice(),t=null,n=0,r=this.list.length,a=0;r>a;++a){var o=this.list[a],i=this.left[o];
(null===t||o>t)&&(i&&a>0&&o>this.list[a-1]||!i&&r-1>a&&o>this.list[a+1])&&(t=o,n=a)}if(null===t)this.done=!0;else{var l=this.left[t]?n-1:n+1;this.list[n]=this.list[l],this.list[l]=t;for(var a=0;r>a;++a)this.list[a]>t&&(this.left[this.list[a]]=!this.left[this.list[a]])}return e};var Ut=n.sha1={};if(e){var Tt=require("crypto");Ut.create=function(){var e=Tt.createHash("sha1");return{update:function(t){e.update(t,"utf8")},digest:function(){return e.digest("hex")}}}}else Ut.create=function(){return new Ut.MessageDigest};if(Ut.hash=function(e){for(var t=Ut.create(),n=0;n<e.length;++n)t.update(e[n]);return t.digest()},!e){Ut.Buffer=function(){this.data="",this.read=0},Ut.Buffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},Ut.Buffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},Ut.Buffer.prototype.bytes=function(){return this.data.slice(this.read)},Ut.Buffer.prototype.length=function(){return this.data.length-this.read},Ut.Buffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},Ut.Buffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);16>n&&(e+="0"),e+=n.toString(16)}return e},Ut.MessageDigest=function(){Jt.initialized||Jt.init(),this.blockLength=64,this.digestLength=20,this.messageLength=0,this.input=new Ut.Buffer,this.words=new Array(80),this.state={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520}},Ut.MessageDigest.prototype.update=function(e){e=unescape(encodeURIComponent(e)),this.messageLength+=e.length,this.input.data+=e,Jt.update(this.state,this.words,this.input),(this.input.read>2048||0===this.input.length())&&this.input.compact()},Ut.MessageDigest.prototype.digest=function(){var e=this.messageLength,t=new Ut.Buffer;t.data+=this.input.bytes(),t.data+=Jt.padding.substr(0,64-(e+8)%64),t.putInt32(e>>>29&255),t.putInt32(e<<3&4294967295),Jt.update(this.state,this.words,t);var n=new Ut.Buffer;return n.putInt32(this.state.h0),n.putInt32(this.state.h1),n.putInt32(this.state.h2),n.putInt32(this.state.h3),n.putInt32(this.state.h4),n.toHex()};var Jt={padding:null,initialized:!1};Jt.init=function(){Jt.padding=String.fromCharCode(128);for(var e=String.fromCharCode(0),t=64;t>0;)1&t&&(Jt.padding+=e),t>>>=1,t>0&&(e+=e);Jt.initialized=!0},Jt.update=function(e,t,n){for(var r,a,o,i,l,u,s,c,d=n.length();d>=64;){for(a=e.h0,o=e.h1,i=e.h2,l=e.h3,u=e.h4,c=0;16>c;++c)r=n.getInt32(),t[c]=r,s=l^o&(i^l),r=(a<<5|a>>>27)+s+u+1518500249+r,u=l,l=i,i=o<<30|o>>>2,o=a,a=r;for(;20>c;++c)r=t[c-3]^t[c-8]^t[c-14]^t[c-16],r=r<<1|r>>>31,t[c]=r,s=l^o&(i^l),r=(a<<5|a>>>27)+s+u+1518500249+r,u=l,l=i,i=o<<30|o>>>2,o=a,a=r;for(;32>c;++c)r=t[c-3]^t[c-8]^t[c-14]^t[c-16],r=r<<1|r>>>31,t[c]=r,s=o^i^l,r=(a<<5|a>>>27)+s+u+1859775393+r,u=l,l=i,i=o<<30|o>>>2,o=a,a=r;for(;40>c;++c)r=t[c-6]^t[c-16]^t[c-28]^t[c-32],r=r<<2|r>>>30,t[c]=r,s=o^i^l,r=(a<<5|a>>>27)+s+u+1859775393+r,u=l,l=i,i=o<<30|o>>>2,o=a,a=r;for(;60>c;++c)r=t[c-6]^t[c-16]^t[c-28]^t[c-32],r=r<<2|r>>>30,t[c]=r,s=o&i|l&(o^i),r=(a<<5|a>>>27)+s+u+2400959708+r,u=l,l=i,i=o<<30|o>>>2,o=a,a=r;for(;80>c;++c)r=t[c-6]^t[c-16]^t[c-28]^t[c-32],r=r<<2|r>>>30,t[c]=r,s=o^i^l,r=(a<<5|a>>>27)+s+u+3395469782+r,u=l,l=i,i=o<<30|o>>>2,o=a,a=r;e.h0+=a,e.h1+=o,e.h2+=i,e.h3+=l,e.h4+=u,d-=64}}}if(!ft)var At=function(){ft=require("xmldom").XMLSerializer};if(n.url={},e){var _t=require("url").parse;n.url.parse=function(e){var t=_t(e);return t.pathname=t.pathname||"",lt(t),t.normalizedPath=ut(t.pathname,""!==t.authority),t}}else{var Pt={};Pt.options={key:["href","protocol","host","auth","user","password","hostname","port","relative","path","directory","file","query","hash"],parser:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/},n.url.parse=function(e){for(var t=Pt.options,n=t.parser.exec(e),r={},a=14;a--;)r[t.key[a]]=n[a]||"";return r.host&&""===r.path&&(r.path="/"),r.pathname=r.path||"",lt(r),r.normalizedPath=ut(r.pathname,""!==r.authority),r.query&&(r.path=r.path+"?"+r.query),r.protocol&&(r.protocol+=":"),r.hash&&(r.hash="#"+r.hash),r}}return e?n.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&n.useDocumentLoader("xhr"),e&&(n.use=function(e){switch(e){case"request":n.request=require("./request");break;default:throw new Ct("Unknown extension.","jsonld.UnknownExtension",{extension:e})}}),n},r=function(){return n(function(){return r()})};n(r),e?module.exports=r:"function"==typeof define&&define.amd?define([],function(){return r}):t&&("undefined"==typeof jsonld?jsonld=jsonldjs=r:jsonldjs=r)}();