!function(t,e){if("function"==typeof define&&define.amd)define("eventable",["underscore"],function(n){return t.Eventable=e(n)});else if("undefined"!=typeof exports){var n=require("underscore");module.exports=e(n)}else t.Eventable=e(t._)}(this,function(t){var e=[],n=e.slice,i={on:function(t,e,n){if(!s(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,i){if(!s(this,"once",e,[n,i])||!n)return this;var r=this,c=t.once(function(){r.off(e,c),n.apply(this,arguments)});return c._callback=n,this.on(e,c,i)},off:function(e,n,i){var r,c,l,a,f,o,h,u;if(!this._events||!s(this,"off",e,[n,i]))return this;if(!e&&!n&&!i)return this._events={},this;for(a=e?[e]:t.keys(this._events),f=0,o=a.length;o>f;f++)if(e=a[f],l=this._events[e]){if(this._events[e]=r=[],n||i)for(h=0,u=l.length;u>h;h++)c=l[h],(n&&n!==c.callback&&n!==c.callback._callback||i&&i!==c.context)&&r.push(c);r.length||delete this._events[e]}return this},trigger:function(t){if(!this._events)return this;var e=n.call(arguments,1);if(!s(this,"trigger",t,e))return this;var i=this._events[t],r=this._events.all;return i&&c(i,e),r&&c(r,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var s in i)i[s].off(e,n,this),r&&delete this._listeners[s];return this}},r=/\s+/,s=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var s in n)t[e].apply(t,[s,n[s]].concat(i));return!1}if(r.test(n)){for(var c=n.split(r),l=0,a=c.length;a>l;l++)t[e].apply(t,[c[l]].concat(i));return!1}return!0},c=function(t,e){var n,i=-1,r=t.length,s=e[0],c=e[1],l=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,c);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,c,l);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},l={listenTo:"on",listenToOnce:"once"};return t.each(l,function(e,n){i[n]=function(n,i,r){var s=this._listeners||(this._listeners={}),c=n._listenerId||(n._listenerId=t.uniqueId("l"));return s[c]=n,"object"==typeof i&&(r=this),n[e](i,r,this),this}}),i.bind=i.on,i.unbind=i.off,i});